BrightTag.site('RFE3R2G',function(s){
s.script('//s.btstatic.com/lib/a409846b61e9022757b8dfe0b02569b6aaa8ba6d.js?v\x3d2').script('//s.btstatic.com/lib/c2d7defe6586886591afab90df741590f3861673.js?v\x3d2').script('//s.btstatic.com/lib/747f6dd9bace0f0ad157fc623c279337d26393cd.js?v\x3d2').script('//s.btstatic.com/lib/bca738992c0740d6a4943de4aa1c82f4be113ea0.js?v\x3d2').script('//bat.bing.com/bat.js').wait(function(){
s.dbe('bt:entityid', '\x22c2YH9t34\x22',{pageId:65112});
s.dbe('bt:uidkey', '\x22userID\x22',{pageId:65112});
s.dbe('bt:uidvalue', 'bt_data(\x27global :: utils :: identity\x27)',{pageId:65112});
s.dbe('global :: email :: sha256 hashed email', '(function() {\r\n    function urlParam(name) {\r\n        var results \x3d new RegExp(\x27[\\?\x26]\x27 + name + \x27\x3d([^\x26#]*)\x27).exec(window.location.href);\r\n        if (results \x3d\x3d null) {\r\n            return null;\r\n        } else {\r\n            return results[1] || 0;\r\n        }\r\n    }\r\n    if (urlParam(\x22emailSHA256\x22) !\x3d null) {\r\n        return urlParam(\x22emailSHA256\x22);\r\n    } else if (typeof app.config.customerEmail !\x3d \x22undefined\x22 \x26\x26 app.config.customerEmail !\x3d null \x26\x26 app.config.customerEmail !\x3d \x22\x22) {\r\n        return CryptoJS.SHA256(app.config.customerEmail.toLowerCase()).toString();\r\n    } else {\r\n        return \x22\x22;\r\n    }\r\n})()',{pageId:65112});
s.dbe('omnassetid', '(function(){ if(typeof(omnAssetID) \x3d\x3d \x22undefined\x22) { return \x22\x22; } else { var a \x3d omnAssetID; if (a.length \x3e\x3d 2) { return a; } else { return \x22\x22; } } }())',{pageId:30140});
s.dbe('currency code', 'omnCurrency',{pageId:30140});
s.dbe('global :: live agent :: chat id', '\x225730z000000fxTw\x22',{pageId:65112});
s.dbe('global :: mediaiq :: smart pixel seg', '\x227901562\x22',{pageId:65112});
s.dbe('order confirmation number', '(function(){\r\nif(typeof(omnOrderNumber) \x3d\x3d \x22undefined\x22) {\r\nreturn \x22\x22;\r\n} else {\r\nvar a \x3d omnOrderNumber;\r\nif (a.length \x3e\x3d 2) {\r\nreturn a;\r\n} else {\r\nreturn \x22\x22;\r\n}\r\n}\r\n}())',{pageId:30140});
s.dbe('locale', '(function(){if(typeof app.config !\x3d \x27undefined\x27){return app.config.locale}else{return s.eVar8}})()',{pageId:30140});
s.dbe('impact radius :: confirmation actiontrackerid', '\x2214397\x22',{pageId:65112});
s.dbe('global :: amazon :: hargs', '\x22v%3D1.0%3Bc%3D2890174968542%3Bp%3D2154B460-163E-B0BF-F0FA-5A9A339651AD\x22',{pageId:65112});
s.dbe('global :: olapic :: soldout api di', '\x2296c82c082752c464393d1680231298da\x22',{pageId:65112});
s.dbe('global :: olapic :: misc api di', '\x22d020dbed9f4e35852725c7dc6f4bbf32\x22',{pageId:65112});
s.dbe('global :: olapic :: newsletter api di', '\x22e12b1ab5be338c5f671403334f8c89ec\x22',{pageId:65112});
s.dbe('donottrack', 'bt_cookie(\x27dw_dnt\x27)',{pageId:30140});
s.dbe('global :: olapic :: data api key', '\x22b96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x22',{pageId:65112});
s.dbe('referring url', 'document.referrer',{pageId:30140});
s.dbe('global :: olapic :: customer id', '216182',{pageId:65112});
s.dbe('customer no', 'typeof app.config.customerNo !\x3d \x22undefined\x22 ? app.config.customerNo : \x22\x22',{pageId:30140});
s.dbe('page type', 'pageData.pageType',{pageId:30140});
s.dbe('global :: utils :: identity', '\x275094392065358576233\x27');
s.dbe('timestamp', '\x272018-07-27T20:38:16.054Z\x27');
s.dbe('global :: adobe :: amo click key', 'bt_parameter(\x27s_kwcid\x27)',{pageId:65112});
s.dbe('global :: olapic :: content api di', '\x2214325f315922d6deffe771e3642f16ee\x22',{pageId:65112});
s.dbe('global :: google analytics :: property id', '\x22UA-228057-6\x22',{pageId:65112});
s.dbe('global :: amazon :: fargs', '\x22%3Fid%3D2154b460-163e-b0bf-f0fa-5a9a339651ad%26type%3D82%26m%3D1\x22',{pageId:65112});
s.dbe('isnewcustomer', '(bt_data(\x27first_trans_date\x27) \x3d\x3d \x22\x22)*1',{pageId:30140});
s.dbe('input', '\x22A\x22',{pageId:65112});
s.dbe('referring url domain', 'if(document.referrer !\x3d\x22\x22\x26\x26 document.referrer.indexOf(\x22www\x22)\x3e0){document.referrer.split(\x27//www.\x27)[1].split(\x27/\x27)[0]}else{\x22\x22}',{pageId:65112});
s.dbe('signal universal id', '\x27utYFgPQjUTTsT8+wq+wTcYvdcrdW3/qr6a3hYQHqn/s\\x3d\x27');
s.dbe('crocsautotester', '(function(){\r\n\tvar hasParam \x3d /crocsautotester/.test(window.location.search),\r\n\t\thasCookie \x3d /crocsautotester/.test(document.cookie);\r\n\tif(hasParam || hasCookie){\r\n\t\tif(!hasCookie){\r\n\t\t\tvar expireDate \x3d new Date();\r\n\t\t\texpireDate.setYear(3000);\r\n\t\t\tdocument.cookie \x3d \x22crocsautotester\x3dtrue; expires\x3d\x22+expireDate.toUTCString()+\x22; path\x3d/\x22;\r\n\t\t}\r\n\t\treturn \x22true\x22;\r\n\t}else{\r\n\t\treturn \x22false\x22;\r\n\t}\r\n})();',{pageId:30140});
s.dbe('ip address', '\x27167.58.219.117\x27');
s.dbe('impact radius :: jsfilename', '\x22A1211624-5817-49c4-a979-eb5071f5fead1\x22',{pageId:65112});
s.dbe('campaign', 'bt_parameter(\x22siteID\x22).substring(0,11) || bt_parameter(\x22adid\x22)\r\n',{pageId:30140});
s.dbe('global :: olapic :: account api di', '\x2299dc2dd4d83b366a461b7dfee89da472\x22',{pageId:65112});
s.dbe('page url', 'document.URL',{pageId:30140});
s.dbe('global :: amobee :: page type', '\x22at\x22',{pageId:65112});
s.dbe('user agent', '\x27Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36\x27');
s.dbe('global :: mobile/desktop', '(function(){\r\n    if((new RegExp(/ipad|android(?!.*mobile)|\\bSilk\\b/i)).test(navigator.userAgent)){\r\n        return \x22t\x22;   \r\n    } else if((new RegExp(/ip(hone|od)|android.*(mobile)/i)).test(navigator.userAgent)){\r\n        return \x22m\x22;\r\n    } else {\r\n        return \x22d\x22;\r\n    }\r\n})()',{pageId:30140});
s.events.bind('hashed email available',window,'DIRECT/hashedEmailAvailable',{pageId:30140}).dbe('global :: email :: sha256 hashed email','CryptoJS.SHA256(arguments[1][0].hashedEmail.toLowerCase())');
s.when('bt_data(\x27donottrack\x27) \x3d\x3d 0',function(){
s.events.on('hashed email available').fire(3609872).appendData('global :: utils :: identity').appendData('global :: email :: sha256 hashed email');
});
s.domready(function(){
s.tag('\x3cscript\x3e\n    //if(new RegExp(\x27[\\?\x26]cy\x3d([^\x26#]*)\x27).exec(window.location.href) \x3d\x3d null){\n        (function(i,s,o,g,r,a,m){i[\x27GoogleAnalyticsObject\x27]\x3dr;i[r]\x3di[r]||function(){\n        (i[r].q\x3di[r].q||[]).push(arguments)},i[r].l\x3d1*new Date();a\x3ds.createElement(o),\n        m\x3ds.getElementsByTagName(o)[0];a.async\x3d1;a.src\x3dg;m.parentNode.insertBefore(a,m)\n        })(window,document,\x27script\x27,\x27//www.google-analytics.com/analytics.js\x27,\x27ga\x27);\n        \n        ga(\x27create\x27, \x27'+s.data('global :: google analytics :: property id')+'\x27, \x27auto\x27);\n        if(\x22'+s.data('donottrack')+'\x22 \x3d\x3d\x3d \x220\x22){\n            console \x26\x26 console.log(\x22displayfeatures loaded\x22);\n            ga(\x27require\x27, \x27displayfeatures\x27);\n        }\n\n        (function(){\n            if(urlParam(\x22adid\x22) !\x3d null){\n                var adid \x3d urlParam(\x22adid\x22);\n                \n                if(adid.match(\x22^exacttarget_email_\x22)){\n            \t\tvar adidParts \x3d adid.split(\x22_\x22);\n            \t\t\n            \t\tif(adidParts.length \x3e\x3d 7 \x26\x26 adidParts[3].match(\x22[0-9]{6}\x22)){\n            \t\t\tvar source \x3d adidParts[2] + \x22_\x22 + adidParts[3] + \x22_\x22 + adidParts[4];\n            \t\t\tvar content \x3d adidParts[adidParts.length - 1];\n            \t\t\tvar campaign \x3d (adidParts[5] \x3d\x3d \x22t5\x22 ? \x22none\x22 : adidParts[5]);\n                        var medium \x3d \x22email\x22;\n            \t\t} else {\n            \t\t\tvar source \x3d adid.substring(\x22exacttarget_email_\x22.length);\n                \t\tvar content \x3d \x22\x22;\n            \t\t\tvar campaign \x3d \x22unknown\x22;\n                        var medium \x3d \x22email\x22;\n            \t\t}\n                    \n                    setCampaignVars(campaign, source, medium, content);\n            \t} else if(adid.match(\x22linkshare\x22) || urlParam(\x22siteid\x22) !\x3d null){\n            \t\tif(adid.match(\x22linkshare\x22)){\n            \t\t\tvar siteid \x3d adid.substring(\x22linkshare_\x22.length);\n            \t\t} else {\n            \t\t\tvar siteid \x3d urlParam(\x22siteid\x22);\n            \t\t}\n            \t\t\n            \t\tvar source \x3d \x22none\x22;\n                    \n                    $.ajax({\n                        dataType: \x22jsonp\x22,\n                        url: \x22http://s.btstatic.com/lib/b15088e4e4fa8be42f4e661e7f517737beafa8cd.js?v\x3d2\x22.replace(\x22http:\x22, \x22https:\x22),\n                        jsonp: false,\n                        jsonpCallback: \x22affiliateTableUA\x22,\n                        cache: true,\n                        success: function(data){\n                    \t\tif(typeof data[siteid] !\x3d\x3d \x22undefined\x22){\n                \t\t\t\tsource \x3d data[siteid];\n                    \t\t} else if(document.referrer !\x3d null \x26\x26 document.referrer !\x3d \x22\x22){\n                    \t\t\tvar matches \x3d document.referrer.match(/^https?\\:\\/\\/(?:www\\.)?([^\\/?#]+)(?:[\\/?#]|$)/i);\n                \t\t\t\tif(matches \x26\x26 typeof matches[1] !\x3d\x3d \x22undefined\x22){\n                \t\t\t\t\tsource \x3d matches[1];\n                \t\t\t\t}\n                    \t\t}\n        \n                            setCampaignVars(siteid, source, \x22affiliate\x22, \x22\x22);\n                            sendPageView();\n                        }\n                    });\n                    \n                    return;\n            \t}\n                \n            }\n            \n            sendPageView();\n            \n            function setCampaignVars(campaign, source, medium, content){\n                ga(\x27set\x27, \x27campaignName\x27, campaign);\n                ga(\x27set\x27, \x27campaignSource\x27, source);\n                ga(\x27set\x27, \x27campaignMedium\x27, medium);\n                ga(\x27set\x27, \x27campaignContent\x27, content);\n            }\n            \n            function sendPageView(){\n                ga(\x27require\x27, \x27ec\x27);\n                ga(\x27set\x27, \x27\x26cu\x27, \x27'+s.data('currency code')+'\x27);\n                \n                if(pageData.pageType \x3d\x3d \x22product\x22){\n                    ga(\x27ec:addProduct\x27, {\n                      \x27id\x27: pageData.productID,\n                      \x27name\x27: pageData.name,\n                      \x27category\x27: pageData.categoryID\n                    });\n                    ga(\x27ec:setAction\x27, \x27detail\x27);\n                }\n                else if(pageData.pageType \x3d\x3d \x22cart\x22){\n                    $.each(app.config.cart.cartItems, function(index, product){\n                        addProduct(product);\n                    });\n                    \n                    ga(\x27ec:setAction\x27,\x27checkout\x27, {\n                        \x27step\x27: 1\n                    });\n                }\n                else if(pageData.pageType \x3d\x3d \x22checkout\x22){\n                    $.each(app.config.cart.cartItems, function(index, product){\n                        addProduct(product);\n                    });\n                    \n                    ga(\x27ec:setAction\x27,\x27checkout\x27, {\n                        \x27step\x27: 2\n                    });\n                }\n                else if(pageData.pageType \x3d\x3d \x22confirm\x22){\n                    $.each(pageData.orderItems, function(index, product){\n                        addProduct(product);\n                    });\n                    \n                    ga(\x27ec:setAction\x27,\x27checkout\x27, {\n                        \x27step\x27: 3\n                    });\n                    \n                    ga(\x27ec:setAction\x27, \x27purchase\x27, {\n                      \x27id\x27: pageData.orderID,\n                      \x27revenue\x27: String(pageData.orderValue),\n                      \x27tax\x27: String(pageData.orderTax),\n                      \x27shipping\x27: String(pageData.orderShipping)\n                    });\n                }\n                \n                ga(\x27set\x27, \x27location\x27, \nwindow.location.href.replace(window.location.hash, \x22\x22).replace(/(\x3d|,)([^\x3d]+)(%40|@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/gi,\x22$1\x22));\n                \n                ga(\x27send\x27, \x27pageview\x27);\n            }\n            \n            function addProduct(product){\n                ga(\x27ec:addProduct\x27, {\n                  \x27id\x27: product.id,\n                  \x27name\x27: product.name,\n                  \x27category\x27: product.categoryID,\n                  \x27price\x27: String(product.unitPrice),\n                  \x27quantity\x27: product.qty\n                });\n            }\n            \n            function urlParam(name){\n                var results \x3d new RegExp(\x27[\\?\x26]\x27+name+\x27\x3d([^\x26#]*)\x27).exec(window.location.href);\n                if(results\x3d\x3dnull){\n                   return null;\n                } else{\n                   return results[1] || 0;\n                }\n            }\n        })();\n    //}\n\x3c/script\x3e',{tagId:2252957});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\ndocument.write(\n\x27\x3cimg style\x3d\x22display:none\x22 src\x3d\x22https://s.amazon-adsystem.com/iui3?d\x3dforester-did\x26ex-fargs\x3d'+s.data('global :: amazon :: fargs')+'\x26ex-fch\x3d416613\x26ex-src\x3dwww.crocs.com\x26ex-hargs\x3d'+s.data('global :: amazon :: hargs')+'\x22/\x3e\x27\n);\n\x3c/script\x3e',{tagId:3056407});
s.tag('\x3cscript\x3e\n    $(document).ready(function(){\n        var captureEmailRegex \x3d /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;\n        var captureTimeout \x3d 0;\n        \n        var captureEmailInputList \x3d [\n            \x22#dwfrm_newsletter_email\x22,\n            \x22#newsletterFooter input.email\x22,\n            \x22#newsletterLens input.email\x22,\n            \x22#nrlsk_email_address\x22,\n            \x22input[name\x3dEmail_Address]\x22,\n            \x22#dwfrm_root_singleshipping_shippingAddress_email_emailAddress\x22\n        ].join(\x22, \x22);\n        \n        $(captureEmailInputList).on(\x22input\x22, function(){\n            var $emailInput \x3d $(this);\n            \n            if(captureEmailRegex.test($emailInput.val())){\n                if(captureTimeout !\x3d 0){clearTimeout(captureTimeout)};\n                captureTimeout \x3d setTimeout(function(){\n                    $(window).trigger(\x22hashedEmailAvailable\x22, {\x22hashedEmail\x22: $emailInput.val()});\n                }, 200);\n            }\n        });\n    });\n\x3c/script\x3e',{tagId:3600803});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\n(function(){\n    myVal \x3d bt_cookie(\x27customer\x27);\n   \n    var date \x3d new Date();\n    date.setTime(date.getTime()+(180*86400000));\n    var expires \x3d date.toGMTString();\n    var path \x3d \x22;path\x3d/;expires\x3d\x22;\n    var cookiePayload \x3d {};\n    cookiePayload.firstPurchase \x3d \x22'+s.data('first_trans_date')+'\x22;\n    cookiePayload.lastPurchase \x3d \x22'+s.data('last_trans_date')+'\x22;\n    cookiePayload.probReturn \x3d \x22'+s.data('p_return')+'\x22;\n    cookiePayload.status \x3d \x22'+s.data('status_segment')+'\x22;\n    cookiePayload.departmentPersona \x3d \x22'+s.data('department_persona')+'\x22;\n    cookiePayload.categoryPersona \x3d \x22'+s.data('category_persona')+'\x22;\n    cookiePayload.subcategoryPersona \x3d \x22'+s.data('sub_category_persona')+'\x22;\n    cookiePayload.priceSensitive \x3d \x22'+s.data('price_sensitive')+'\x22;\n    cookiePayload.priceInsensitive \x3d \x22'+s.data('price_insensitive')+'\x22;\n    var cookieValue \x3d \x22customer\x3d\x22+encodeURIComponent(JSON.stringify(cookiePayload)) + path + expires;\n    \n    \n    if(myVal !\x3d cookieValue ){   \n        document.cookie \x3d cookieValue;   \n    };\n \n})();\n\x3c/script\x3e',{tagId:4409087});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\n\n$(function(){\n\n\t\n\t// START olapic_v2\n\tvar olapic_v3 \x3d (function(){\n\t\t\n\t\t// variables used across olapic methods\n\t\tvar debug \x3d false, // show/hide console.logs\n\t\t\tapiKey \x3d /\\[/.test(\x22'+s.data('global :: olapic :: data api key')+'\x22) ? \x27b96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x27 : \x22'+s.data('global :: olapic :: data api key')+'\x22, // US for testing, otherwise dynamic Signal data \n\t\t\tcustId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: customer id')+'\x22) ? \x27216182\x27 : \x22'+s.data('global :: olapic :: customer id')+'\x22, // US for testing, otherwise dynamic Signal data \n\t\t\tdomain \x3d \x27//photorankapi-a.akamaihd.net\x27,\n\t\t\tuploadUri \x3d \x22//www.photorank.me/uploader/\x22,\n\t\t\tmaxPagesToUse \x3d 5, // used in addMedia() to limit the number of paging API requests, see ** addMedia() note above. Takes an integer or null, null means we get ALL media.\n\t\t\tmediaLimit \x3d 50, // max amount for a single request, to get more we\x27d have to make subsequent requests via urls provided in response of original request...\n\t\t\tapiParams \x3d \x27?auth_token\x3d\x27 + apiKey + \x27\x26version\x3dv2.2\x27,\n\t\t\tapiParamsExt \x3d \x27\x26rights_given\x3d1\x27 + \x27\x26count\x3d\x27 + mediaLimit,\n\t\t\tanalyticUri \x3d \x27//data.photorank.me/track/widget/\x27,\n\t\t\tanalyticFormat \x3d \x27.json\x27, // .json or .gif\n\t\t\tanalyticParams \x3d \x27?auth_token\x3d\x27 + apiKey,\n\t\t\t// below, fake num for testing, otherwise dynamic Signal data used by analyticInstanceId logic\n\t\t\tmiscWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: misc api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: misc api di')+'\x22,\n\t\t\thomeWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: home api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: home api di')+'\x22,\n\t\t\tpdpWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: pdp api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: pdp api di')+'\x22,\n\t\t\tsoldoutWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: soldout api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: soldout api di')+'\x22,\n\t\t\tcatWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: cat api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: cat api di')+'\x22,\n\t\t\tsearchWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: search api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: search api di')+'\x22,\n\t\t\tcartWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: cart api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: cart api di')+'\x22,\n\t\t\tcheckoutWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: checkout api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: checkout api di')+'\x22,\n\t\t\taccountWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: account api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: account api di')+'\x22,\n\t\t\tcontentWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: content api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: content api di')+'\x22,\n\t\t\tfinderWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: finder api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: finder api di')+'\x22,\n\t\t\tconfirmWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: confirm api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: confirm api di')+'\x22,\n\t\t\tnewsletterWidgetId \x3d /\\[/.test(\x22'+s.data('global :: olapic :: newsletter api di')+'\x22) ? \x221234\x22 : \x22'+s.data('global :: olapic :: newsletter api di')+'\x22,\n\t\t\tanalytics_id \x3d \x27\x27, // Olapic ID hash used in cookie and analytic tracking, function setOlapicCookie() populates the value\n\t\t\tfacebookIconUrl \x3d \x27//images.crocs.com/is/image/Crocs/Crocs2014Template_Facebook?op_invert\x3dtrue\x26wid\x3d39\x26fmt\x3djpg\x27,\n\t\t\ttwitterIconUrl \x3d \x27//images.crocs.com/is/image/Crocs/Crocs2014Template_Twitter?op_invert\x3dtrue\x26wid\x3d39\x26fmt\x3djpg\x27,\n\t\t\tinstagramIconUrl \x3d \x27//images.crocs.com/is/image/Crocs/Crocs2014Template_Instagram?op_invert\x3dtrue\x26wid\x3d39\x26fmt\x3djpg\x27,\n\t\t\tpinterestIconUrl \x3d \x27//images.crocs.com/is/image/Crocs/Crocs2014Template_Pinterest?op_invert\x3dtrue\x26wid\x3d39\x26fmt\x3djpg\x27,\n\t\t\tgenericIconUrl \x3d \x27//images.crocs.com/is/image/Crocs/monitor?$mkt-png-alpha$\x27,\n\t\t\tolapicMsgs \x3d (app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.olapic) || null ,\n\t\t\tolapic \x3d {}; // prevent leaking into global space\n\n\t\t\n\t\tolapic \x3d {\n\n\t\t\t// olapic.init()\n\t\t\tinit : function(){\n\t\t\t\t\n\t\t\t\tapp.config.olapic \x3d app.config.olapic ? app.config.olapic : {};\n\t\t\t\t\n\t\t\t\t$.each($(\x27.js-olapic\x27),function(){\n\t\t\t\t\tvar $this \x3d $(this),\n\t\t\t\t\t\texperienceId \x3d \x27o\x27+ (new Date).getTime();\n\t\t\t\t\t\n\t\t\t\t\t// because CrocsClub is different from everything else...\n\t\t\t\t\tif($this.hasClass(\x27olapic-crocsclub\x27)){\n\t\t\t\t\t\tolapic.utils.prepareCrocsClub($this);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t$this.attr(\x27data-location\x27, experienceId);\n\t\t\t\t\tolapic.getMedia($this);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// olapic.utils\n\t\t\tutils : {\n\t\t\t\t\n\t\t\t\taddHeader : function($this){\n\t\t\t\t\t$this.find(\x27\x3e div\x27).wrapAll( \x22\x3cdiv class\x3d\x27olapic-header\x27 /\x3e\x22);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tprepareCrocsClub : function($this){\n\t\t\t\t\t// carousel or photowall\n\t\t\t\t\tif(window.innerWidth \x3e\x3d 960){\n\t\t\t\t\t\t$this.addClass(\x27olapic-photowall\x27);\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$this.addClass(\x27olapic-carousel\x27);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t},\n\t\t\t\n\t\t\t\tlog : function(){\n\t\t\t\t\tfor(var len \x3d arguments.length, i\x3d0; i\x3clen; i++){\n\t\t\t\t\t\tdebug \x26\x26 console.log \x26\x26 console.log(arguments[i]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tajaxReq : function(url,cb){\n\t\t\t\t\t/*\n\t\t\t\t\t\twhen using \x27wrap_responses\x3d1\x27 responses will always be valid,\n\t\t\t\t\t\tno GET (404) errors which would prevent the succession of API calls,\n\t\t\t\t\t\twe use the returned metadata.code to validate the response instead.\n\t\t\t\t\t*/\n\t\t\t\t\tvar url \x3d /\\?/.test(url) ? (url + \x27\x26wrap_responses\x3d1\x27) : (url + \x27?wrap_responses\x3d1\x27);\n\t\t\t\t\t\n\t\t\t\t\tvar jqxhr \x3d $.ajax({  \n\t\t\t\t\t\t\ttype: \x22GET\x22,\n\t\t\t\t\t\t\turl: url,\n\t\t\t\t\t\t\tdataType: \x22json\x22\n\t\t\t\t\t\t})\n\t\t\t\t    \t.done(function(data) {\n\t\t\t\t\t\t\t// success\n\t\t\t\t\t\t\tif(cb){\n\t\t\t\t\t\t\t\tcb(data)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t// error\n\t\t\t\t\t\t})\n\t\t\t\t\t    .always(function() {\n\t\t\t\t\t\t\t// no matter if success or error, this fires after each ajax request\n\t\t\t\t\t    });\n\t\t\t\n\t\t\t\t}, // end ajaxReq\n\t\t\t\t\n\t\t\t\tisValidData : function(data){\n\t\t\t\t\tif(data \x26\x26 data.metadata.code \x3d\x3d\x3d 200 \x26\x26 data.data \x26\x26 data.data._embedded \x26\x26 data.data._embedded.media \x26\x26 data.data._embedded.media.length){\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\taddMedia : function(){\n\t\t\t\t\tvar olapicElmObj \x3d arguments[0],\n\t\t\t\t\t\tdata \x3d arguments[1],\n\t\t\t\t\t\tpageRequests \x3d arguments.length \x3d\x3d\x3d 3 ? arguments[2] : 0,\n\t\t\t\t\t\tmediaArr \x3d data.data._embedded.media;\n\t\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27addMedia()\x27,data);\n\t\t\t\t\t\n\t\t\t\t\t$.each(mediaArr, function(){\n\t\t\t\t\t\tvar mediaId \x3d this.id;\n\t\t\t\t\t\tif(this.status \x3d \x22approved\x22 \x26\x26 this.type \x3d\x3d\x3d \x22IMAGE\x22 \x26\x26 !olapicElmObj.mediaObj[mediaId]){\n\t\t\t\t\t\t\tolapicElmObj.mediaIdArr.push(mediaId);\n\t\t\t\t\t\t\tolapicElmObj.mediaObj[mediaId] \x3d this;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// We continue to request the rest of the media via the paging API even though\n\t\t\t\t\t// the experience will be triggered before we\x27ve retreived it all.\n\t\t\t\t\tif(data \x26\x26 data.data._links \x26\x26 data.data._links.next \x26\x26 data.data._links.next.href \x26\x26 (pageRequests + 1) !\x3d\x3d maxPagesToUse){\n\t\t\t\t\t\tolapic.utils.log(\x27requesting media via paging API\x27);\n\t\t\t\t\t\tvar url \x3d data.data._links.next.href,\n\t\t\t\t\t\t\t// if maxPagesToUse null we\x27ll grab all pages, else we\x27ll get up to maxPagesToUse limit\n\t\t\t\t\t\t\taltPageRequests \x3d maxPagesToUse ? (pageRequests + 1) : 0;\n\t\t\t\t\t\tolapic.utils.ajaxReq(url,function(data){\n\t\t\t\t\t\t\tolapic.utils.addMedia(olapicElmObj,data, altPageRequests);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetCarouselListItems : function(olapicElmObj, $this, carouselDataIdArr, carouselDataObj, carouselElemId){\n\t\t\t\t\tvar listItems \x3d \x27\x27,\n\t\t\t\t\t\taltIndex \x3d $this.find(\x27.iscroll_item\x27).length ? (Number($this.find(\x27.iscroll_item\x27).last().attr(\x27data-oindex\x27)) + 1) : 0,\n\t\t\t\t\t\tcount \x3d 0;\n\t\t\t\t\t\n\t\t\t\t\t$.each(carouselDataIdArr, function(index, value){\n\t\t\t\t\t\t// several image formats available in this.images (sm to lg): thumbnail, square, mobile, normal, original\n\t\t\t\t\t\tvar mediaId \x3d carouselDataIdArr[altIndex],\n\t\t\t\t\t\t\tmediaObj \x3d carouselDataObj[mediaId],\n\t\t\t\t\t\t\timgUrl \x3d mediaObj.images \x26\x26 mediaObj.images.mobile ? mediaObj.images.mobile : \x27\x27,\n\t\t\t\t\t\t\t// below we prevent captions with double-quotes from breaking JS\n\t\t\t\t\t\t\timgCaption \x3d mediaObj.caption ? mediaObj.caption.replace(/\x22/g, \x22\x26quot;\x22) : \x27\x27;\n\t\t\t\t\t\t\tcount \x3d count + 1;\n\t\t\t\t\t\t\n\t\t\t\t\t\tolapic.utils.log(\x27Create Item: data-oid\x3d\x27+mediaId+\x27 data-oindex\x3d\x27+altIndex);\t\t\t\t\n\t\t\t\t\t\tlistItems \x3d listItems + (\x27\x3cli tabindex\x3d\x220\x22 class\x3d\x22swiper-slide iscroll_item-container\x22\x3e\x3cdiv role\x3d\x22link\x22 aria-label\x3d\x22\x27+imgCaption+\x27\x22 class\x3d\x22iscroll_item\x22 data-oid\x3d\x22\x27+mediaId+\x27\x22 data-oindex\x3d\x22\x27+altIndex+\x27\x22 title\x3d\x22\x27+imgCaption+\x27\x22 style\x3d\x22background-image:url(\x27+imgUrl+\x27)\x22\x3e\x3c/div\x3e\x3c/li\x3e\x27);\n\t\t\t\n\t\t\t\t\t\taltIndex \x3d altIndex + 1;\n\t\t\t\t\t\t// even though we may have more data we only want to use defined number or carousel items\n\t\t\t\t\t\tif(count \x3d\x3d\x3d mediaLimit){return false;}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tvar $listItems \x3d $(listItems);\n\t\t\t\t\t\n\t\t\t\t\t// on image click or enter keyup event, show image overlay\n\t\t\t\t\t$listItems.find(\x27.iscroll_item\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t// TODO: test if need to prevent focus if just a touchswipe/mouse drag?\n\t\t\t\t\t\t\t$(this).focus();\n\t\t\t\t\t\t\tvar photoIndex \x3d $(this).attr(\x27data-oindex\x27);\n\t\t\t\t\t\t\tolapic.utils.log(\x27photoIndex\x3d\x27+photoIndex);\n\t\t\t\t\t\t\t//olapic.photoModalOverlay.initPhotoModal(olapicElmObj, $this, carouselElemId, photoIndex, e);\n\t\t\t\t\t\t\tolapic.shopPhotoModalOverlay.initPhotoModal(olapicElmObj, $this, carouselElemId, photoIndex, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\treturn $listItems;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\trandomString : function(length, chars) {\n\t\t\t\t    var result \x3d \x27\x27;\n\t\t\t\t    for (var i \x3d length; i \x3e 0; --i) result +\x3d chars[Math.round(Math.random() * (chars.length - 1))];\n\t\t\t\t    return result;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetShareLinks : function(shareUrl,productImageUrl){\n\t\t\t\t\tvar html \x3d \x27\x27,\n\t\t\t\t\t\tfaceBookBaseUri \x3d \x27https://www.facebook.com/sharer/sharer.php?u\x3d\x27,\n\t\t\t\t\t\ttwitterBaseUri \x3d \x27https://twitter.com/intent/tweet/?url\x3d\x27;\n\t\t\t\t\tif(shareUrl){\n\t\t\t\t\t\thtml \x3d html + \x27\x3ca href\x3d\x22\x27+ faceBookBaseUri + encodeURI(productImageUrl) +\x27\x22 target\x3d\x22_blank\x22 \x3e\x3cimg src\x3d\x22\x27+facebookIconUrl+\x27\x26fmt\x3dpng-alpha\x22 alt\x3d\x22facebook\x22 width\x3d\x2232px\x22 height\x3d\x2232px\x22 /\x3e\x3c/a\x3e\x27;\n\t\t\t\t\t\thtml \x3d html + \x27\x3ca class\x3d\x22twitter-icon\x22 href\x3d\x22\x27+ twitterBaseUri + encodeURI(productImageUrl) +\x27\x22 target\x3d\x22_blank\x22 \x3e\x3cimg src\x3d\x22\x27+twitterIconUrl+\x27\x26fmt\x3dpng-alpha\x22 alt\x3d\x22twitter\x22 width\x3d\x2232px\x22 height\x3d\x2232px\x22 /\x3e\x3c/a\x3e\x27;\n\t\t\t\t\t\thtml \x3d html + \x27\x3ca href\x3d\x22http://pinterest.com/pin/create/button/?url\x3d\x27+ encodeURI(shareUrl) + \x27\x26media\x3d\x27 + encodeURI(productImageUrl)+\x27\x22 target\x3d\x22_blank\x22 \x3e\x3cimg src\x3d\x22\x27+pinterestIconUrl+\x27\x26fmt\x3dpng-alpha\x22 alt\x3d\x22pinterest\x22 width\x3d\x2232px\x22 height\x3d\x2232px\x22 /\x3e\x3c/a\x3e\x27;\n\t\t\t\t\t}\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetOlapicCookie : function(){\n\t\t\t\t\t// Olapic\x27s cookie is named: __olapicU\n\t\t\t\t\treturn document.cookie.replace(/(?:(?:^|.*;\\s*)__olapicU\\s*\\\x3d\\s*([^;]*).*$)|^.*$/, \x22$1\x22);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tsetOlapicCookie : function(){\n\t\t\t\t\tvar rString \x3d olapic.utils.randomString(32, \x270123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\x27),\n\t\t\t\t\t\td \x3d new Date();\n\t\t\t\t\td.setTime(d.getTime() + 60*60*24*28*1000); // add one month\n\t\t\t\t\t//document.__olapicU \x3d \x22__olapicU\x3d\x22+rString+\x22;expires\x3d\x22+d.toGMTString();\n\t\t\t\t\tdocument.cookie \x3d \x22__olapicU\x3d\x22+rString+\x22;expires\x3d\x22+d.toGMTString();\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tcloseUploadModal : function(){\n\t\t\t\t\t$(\x27.olapic-upload_modal-container\x27).remove();\n\t\t\t\t\t$(\x27.olapic-photo-modal.overlay-gray\x27).remove();\n\t\t\t\t\t$(\x27.olapic-upload-link\x27).focus();\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tinitUploadModal : function(olapicElmObj, $this){\n\t\t\t\t\tvar url \x3d \x27\x27,\n\t\t\t\t\t\t$uploadModal \x3d \x27\x27,\n\t\t\t\t\t\tcloseText \x3d olapicMsgs \x26\x26 olapicMsgs.close ? olapicMsgs.close : \x27close\x27,\n\t\t\t\t\t\tuploadModalText \x3d olapicMsgs \x26\x26 olapicMsgs.uploadModalText ? olapicMsgs.uploadModalText : \x27File upload \u2013 choose a source\x27,\n\t\t\t\t\t\turl \x3d uploadUri + olapic.utils.getOlapicUploadLocale();\n\n\t\t\t\t\t$uploadModal \x3d $(\x27\x3cdiv class\x3d\x22olapicCarousel olapic-upload_modal-container\x22\x3e\x3cdiv class\x3d\x22olapic-upload_modal\x22\x3e\x3cdiv role\x3d\x22link\x22 class\x3d\x22olapic-upload_modal-close\x22 tabindex\x3d\x220\x22\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+closeText+\x27\x3c/span\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26#215;\x3c/span\x3e\x3c/div\x3e\x3ciframe role\x3d\x22dialog\x22 aria-label\x3d\x22\x27+uploadModalText+\x27\x22 title\x3d\x22\x27+uploadModalText+\x27\x22 name\x3d\x22\x27+uploadModalText+\x27\x22 src\x3d\x22\x27+url+\x27\x22 style\x3d\x22zoom:1\x22 width\x3d\x22100%\x22 height\x3d\x22500\x22 frameborder\x3d\x220\x22\x3e\x3c/iframe\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d\x22olapicCarousel olapic-photo-modal overlay-gray\x22\x3e\x3c/div\x3e\x27);\n\t\t\t\t\t$(\x27body\x27).append($uploadModal);\n\t\t\n\t\t\t\t\t$(\x27.olapic-upload_modal iframe\x27).focus();\n\t\t\t\t\t$(\x27body\x27).scrollTop(0);\n\n\t\t\t\t\tolapic.analytics.uploadAnalyticApi(olapicElmObj, $this);\n\t\n\t\t\t\t\t$(\x27.olapic-upload_modal-container, olapic-upload_modal-close\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\tolapic.utils.closeUploadModal();\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t\t$(\x27body\x27).on(\x27keyup\x27, function(e){\n\t\t\t\t\t\tif(e.keyCode \x3d\x3d\x3d 27){\n\t\t\t\t\t\t\tolapic.utils.closeUploadModal();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetOlapicUploadLocale : function(){\n\t\t\t\t\tswitch (app.config.locale) {\n\t\t\t\t\t\tcase \x27default\x27:\n\t\t\t\t\t    \treturn \x27crocs?lang\x3den_US\x27;\n\t\t\t\t\t\tcase \x27fr_CA\x27:\n\t\t\t\t\t    \treturn \x27crocscanada?lang\x3dfr_CA\x27;\t\n\t\t\t\t\t\tcase \x27en_CA\x27:\n\t\t\t\t\t    \treturn \x27crocscanada?lang\x3den_CA\x27;\n\t\t\t\t\t\tcase \x27en_GB\x27:\n\t\t\t\t\t    \treturn \x27crocsuk?lang\x3den_UK\x27;\n\t\t\t\t\t\tcase \x27fr_FR\x27:\n\t\t\t\t\t    \treturn \x27crocsfrance?lang\x3dfr_FR\x27;\n\t\t\t\t\t\tcase \x27nl_NL\x27:\n\t\t\t\t\t    \treturn \x27crocsnl?lang\x3dnl_NL\x27;\n\t\t\t\t\t\tcase \x27de_DE\x27:\n\t\t\t\t\t    \treturn \x27crocsgermany?lang\x3dde_DE\x27;\n\t\t\t\t\t\tcase \x27ko_KR\x27:\n\t\t\t\t\t    \treturn \x27crocskorea?lang\x3dko_KR\x27;\n\t\t\t\t\t\tcase \x27en_AU\x27:\n\t\t\t\t\t    \treturn \x27crocsaustralia?lang\x3den_AU\x27;\n\t\t\t\t\t\tcase \x27en_SG\x27:\n\t\t\t\t\t    \treturn \x27crocssingapore?lang\x3den_SG\x27;\t\n\t\t\t\t\t\tcase \x27ja_JP\x27:\n\t\t\t\t\t    \treturn \x27crocsjapan?lang\x3dja_JP\x27;\t\t\t\n\t\t\t\t   \t \tdefault:\n\t\t\t\t      \t\treturn \x27crocseurope\x27;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\n\t\t\t \tgetCarouselHtml : function(id){\n\t\t\t \t\tvar html \x3d \x27\x27,\n\t\t\t \t\t\tadaPreviousItemText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel.previousitem || \x27previous\x27,\n\t\t\t \t\t\tadaNextItemText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel.nextitem || \x27next\x27;\n\n\t\t\t \t\thtml +\x3d \x27\x3cdiv style\x3d\x22clear:both;\x22\x3e\x3c/div\x3e\x27;\n\t\t\t \t\thtml +\x3d \x27\x3cdiv class\x3d\x22swiperCarouselWrapper olapicCarousel\x22\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\x27\x3cdiv id\x3d\x22\x27+ id +\x27\x22 class\x3d\x22swiperCarousel adaCarousel outsideNavigation\x22\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\t\x27\x3cdiv class\x3d\x22sidePrev\x22\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\t\t\x27\x3cbutton tabindex\x3d\x22-1\x22 type\x3d\x22button\x22\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+adaPreviousItemText+\x27\x3c/span\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26lsaquo;\x3c/span\x3e\x3c/button\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\t// carousel items will go here\n\t\t\t \t\thtml +\x3d \t\t\x27\x3cdiv class\x3d\x22sideNext\x22\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\t\t\x27\x3cbutton tabindex\x3d\x22-1\x22 type\x3d\x22button\x22\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+adaNextItemText+\x27\x3c/span\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26rsaquo;\x3c/span\x3e\x3c/button\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\t\x27\x3c/div\x3e\x27;\n\t\t\t \t\thtml +\x3d \t\x27\x3c/div\x3e\x27;\n\t\t\t \t\thtml +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t \t\thtml +\x3d \x27\x3cdiv style\x3d\x22clear:both;\x22\x3e\x3c/div\x3e\x27;\n\t\n\t\t\t \t\tvar $html \x3d $(html);\n\t\n\t\t\t \t\treturn $html;\n\t\t\t \t},\n\t\t\t\t\n\t\t\t\tisValidProductStream : function(currentObj){\n\t\t\t\t\t// checking availability is the only way to distinguish it\x27s a product stream (instead of hashtag, etc.)\n\t\t\t\t\t// oddly, not always will there be an image\n\t\t\t\t\tif(currentObj.product_info \x26\x26 currentObj.product_info.availability \x26\x26 (currentObj.product_info.stock \x26\x26 Number(currentObj.product_info.stock) \x3e 0) \x26\x26 currentObj._embedded.base_image \x26\x26 currentObj._embedded.base_image.images.mobile \x26\x26 currentObj.name \x26\x26 currentObj.product_url){\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetAnalyticWidgetId : function(){\n\t\t\t\t\t/*\n\t\t\t\t\t\t\n\t\t\t\t\t\tanalyticWidgetId - the analytic URL requests have to be tied to an Olapic widget,\n\t\t\t\t\t\t\tand the widgets ID must be included in the request URLs.  I\x27ve created widgets\n\t\t\t\t\t\t\tin Olapic that correspond with the following pageData.pageType, and added\n\t\t\t\t\t\t\ttheir ID\x27s into Signal for each region:\n\n\t\t\t\t\t\t\thome\n\t\t\t\t\t\t\tproduct\n\t\t\t\t\t\t\tproduct-soldout\n\t\t\t\t\t\t\tcategory\n\t\t\t\t\t\t\tsearch\n\t\t\t\t\t\t\tcart\n\t\t\t\t\t\t\tcheckout\n\t\t\t\t\t\t\tconfirm*\n\t\t\t\t\t\t\tnewsletter*\n\t\t\t\t\t\t\taccount\n\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t\tfinder\n\t\t\t\t\t\t\t(misc)\n\n\t\t\t\t\t*/\n\t\t\t\t\t\n\t\t\t\t\tvar analyticWidgetId \x3d miscWidgetId,\n\t\t\t\t\t\tpageType \x3d pageData.pageType;\n\n\t\t\t\t\tif(pageType \x3d\x3d\x3d \x27home\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d homeWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27product\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d pdpWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27product-soldout\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d soldoutWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27category\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d catWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27search\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d searchWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27cart\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d cartWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27checkout\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d checkoutWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27account\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d accountWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27content\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d contentWidgetId;\n\t\t\t\t\t}else if(pageType \x3d\x3d\x3d \x27finder\x27){\n\t\t\t\t\t\tanalyticWidgetId \x3d finderWidgetId;\n\t\t\t\t\t}else if(pageType.test(/confirm/)){\n\t\t\t\t\t\tanalyticWidgetId \x3d confirmWidgetId;\n\t\t\t\t\t}else if(pageType.test(/newsletter/)){\n\t\t\t\t\t\tanalyticWidgetId \x3d newsletterWidgetId;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn analyticWidgetId;\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\n\t\t\t},\n\t\t\t\n\t\t\t// olapic.getMedia()\n\t\t\tgetMedia : function($this){\n\t\t\t\tvar useProductStream \x3d $this.attr(\x22data-useproduct\x22) \x26\x26 $this.attr(\x22data-useproduct\x22) \x3d\x3d\x3d \x22true\x22 \x26\x26 pageData \x26\x26 pageData.productID \x26\x26 pageData.pageType \x3d\x3d\x3d \x22product\x22 ? true : false,\n\t\t\t\t\tuseProductCategoryStream \x3d useProductStream \x26\x26 $this.attr(\x22data-useproduct\x22) \x26\x26 $this.attr(\x22data-useproduct\x22) \x3d\x3d\x3d \x22true\x22 \x26\x26 pageData \x26\x26 pageData.productID \x26\x26 pageData.pageType \x3d\x3d\x3d \x22product\x22 ? true : false,\n\t\t\t\t\telmLocation \x3d $this.attr(\x22data-location\x22),\n\t\t\t\t\twidgetsNameArr \x3d [],\n\t\t\t\t\twidgetsIdArr \x3d [],\n\t\t\t\t\tproductStreamId \x3d \x27\x27,\n\t\t\t\t\tolapicElmObj \x3d app.config.olapic[elmLocation] \x3d {\n\t\t\t\t\t\tmediaObj : {},\n\t\t\t\t\t\tmediaIdArr : [],\n\t\t\t\t\t\tanalyticWidgetType : \x27\x27\n\t\t\t\t\t};\n\n\t\t\t\tgetAllMedia();\n\t\t\n\t\t\t\tfunction getProductStreamById(){\n\t\t\t\t\tvar id \x3d arguments.length \x3e 1 ? arguments[0] : pageData.productID,\n\t\t\t\t\t\tcb \x3d arguments.length \x3e 1 ? arguments[1] : arguments[0],\n\t\t\t\t\t\turl \x3d domain+\x22/customers/\x22+custId+\x22/streams/bytag/\x22+id+apiParams;\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\t\t\t\t\n\n\t\t\t\tfunction getMediaById(sort,id,cb){\n\t\t\t\t\tvar url \x3d domain+\x22/media/\x22+id+\x22/\x22+sort+apiParams+apiParamsExt;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\n\t\t\t\tfunction getMediaOfCustomer(sort,cb){\n\t\t\t\t\t\n\t\t\t\t\tif(!olapicElmObj.analyticWidgetType){\n\t\t\t\t\t\tolapicElmObj.analyticWidgetType \x3d \x22best\x22;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar url \x3d domain+\x22/customers/\x22+custId+\x22/media/\x22+sort+apiParams+apiParamsExt;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\tfunction getMediaOfStream(sort,data,cb){\n\t\t\t\t\tvar id,\n\t\t\t\t\t\tsort \x3d sort ? sort : \x22recent\x22;\n\t\t\t\n\t\t\t\t\tif(typeof data \x3d\x3d\x3d \x22string\x22){\n\t\t\t\t\t\t// just the id was passed in\n\t\t\t\t\t\tid \x3d data;\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// this was passed an object, from which we need to get the stream id\n\t\t\t\t\t\tid \x3d productStreamId \x3d data.data.id;\n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\tif(!olapicElmObj.analyticWidgetType){\n\t\t\t\t\t\tolapicElmObj.analyticWidgetType \x3d \x22stream/\x22+id;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar url \x3d domain+\x22/streams/\x22+id+\x22/media/\x22+sort+apiParams+apiParamsExt;\n\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\t\t\n\t\t\n\t\t\t\tfunction getCategoriesOfStream(cb){\n\t\t\t\t\tvar id \x3d productStreamId,\n\t\t\t\t\t\turl \x3d domain+\x22/streams/\x22+productStreamId+\x22/categories\x22+apiParams;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\n\t\t\t\tfunction getMediaOfCategory(sort,id,cb){\n\t\t\t\t\t\n\t\t\t\t\tif(!olapicElmObj.analyticWidgetType){\n\t\t\t\t\t\tolapicElmObj.analyticWidgetType \x3d \x22category/\x22+id;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar sort \x3d sort || \x27recent\x27,\t\t\t\t\t\n\t\t\t\t\turl \x3d domain+\x22/categories/\x22+id+\x22/media/\x22+sort+apiParams+apiParamsExt;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\tfunction getWidgetsNameArr(){\n\t\t\t\t\tif($this.attr(\x27data-widgets\x27)){\n\t\t\t\t\t\tvar widgetsAttr \x3d $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\twidgetsArr \x3d [];\n\t\t\t\t\t\tif(/\\|/.test(widgetsAttr)){\n\t\t\t\t\t\t\tvar arr \x3d widgetsAttr.split(\x27|\x27);\n\t\t\t\t\t\t\t$.each(arr,function(){\n\t\t\t\t\t\t\t\twidgetsArr.push(this.trim());\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}else if(widgetsAttr){\n\t\t\t\t\t\t\twidgetsArr.push(widgetsAttr.trim());\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn widgetsArr\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn []\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction getWidgets(cb){\n\t\t\t\t\tvar url \x3d domain+\x22/customers/\x22+custId+\x22/widgets\x22+apiParams+\x22\x26count\x3d\x22+mediaLimit;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction setWidgetsIds(data){\n\t\t\t\t\tif(data){\n\n\t\t\t\t\t\tolapic.utils.log(\x27Available Widgets\x27, data,\x27widgetsNameArr\x27, widgetsNameArr, \x27widgetsIdArr\x27, widgetsIdArr);\n\t\t\t\t\t\n\t\t\t\t\t\t$.each(data.data._embedded.widgetinstance, function(){\n\t\t\t\t\t\t\tvar widgetName \x3d this.name.trim();\n\t\t\t\t\t\t\tif(widgetsNameArr.indexOf(widgetName) \x3e -1 \x26\x26 widgetsIdArr.indexOf(this.id) \x3d\x3d\x3d -1){\n\t\t\t\t\t\t\t\twidgetsIdArr.push(this.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\tfunction getMoreWidgets(data, cb){\n\t\t\t\t\tsetWidgetsIds(data);\n\t\t\t\t\tif(data \x26\x26 data.data._links \x26\x26 data.data._links.next \x26\x26 data.data._links.next.href){\n\t\t\t\t\t\tvar url \x3d data.data._links.next.href;\n\t\t\t\t\t\tolapic.utils.ajaxReq(url,function(data){\n\t\t\t\t\t\t\t\tgetMoreWidgets(data, cb);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tcb();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction getWidgetInfo(id,cb){\n\t\t\t\t\tvar url \x3d domain+\x22/widgets/\x22+id+apiParams;\n\t\t\t\t\tolapic.utils.ajaxReq(url,cb);\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction handleWidgetInfo(data,cb){\n\t\t\t\t\tif(data){\n\n\t\t\t\t\t\tolapic.utils.log(\x27widget info\x27,data);\n\n\t\t\t\t\t\tvar sort \x3d data.data.settings.sorting,\n\t\t\t\t\t\t\ttype \x3d data.data.type;\n\t\t\t\t\t\n\t\t\t\t\t\tif(type \x3d\x3d\x3d \x22best_photos\x22){\n\t\t\t\t\t\t\t// widget source \x3d\x3d All photos\n\t\t\t\t\t\t\tgetMediaOfCustomer(sort,cb);\n\t\t\t\t\t\t}else if(type \x3d\x3d\x3d \x22by_gallery\x22){\n\t\t\t\t\t\t\t// widget source \x3d\x3d Stream (e.g. master product, variant, hashtag...)\n\t\t\t\t\t\t\tvar id \x3d data.data._embedded.stream.id.toString();\n\t\t\t\t\t\t\tgetMediaOfStream(sort, id, cb);\n\t\t\t\t\t\t}else if(type \x3d\x3d\x3d \x22by_category\x22){\n\t\t\t\t\t\t\t// widget source \x3d\x3d Category\n\t\t\t\t\t\t\tvar id \x3d data.data._embedded.category.id.toString();\n\t\t\t\t\t\t\tgetMediaOfCategory(sort, id, cb);\n\t\t\t\t\t\t}\t\t\t\t\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction getAllWidgetMedia(){\n\t\t\t\t\t/*\n\t\t\t\t\t\tthis function gets all media of widgets listed in the div data-widgets attribute\n\t\t\t\t\t*/\n\t\t\t\t\twidgetsNameArr \x3d getWidgetsNameArr();\n\t\t\t\t\tif(widgetsNameArr.length){\n\t\t\t\t\t\tgetWidgets(function(data){\n\t\t\t\t\t\t\tgetMoreWidgets(data,function(){\n\t\t\t\t\t\t\t\tif(widgetsIdArr.length){\n\t\t\t\t\t\t\t\t\tvar len \x3d widgetsIdArr.length;\n\t\t\t\t\t\t\t\t\t$.each(widgetsIdArr, function(index){\n\t\t\t\t\t\t\t\t\t\tgetWidgetInfo(this,function(data){\n\t\t\t\t\t\t\t\t\t\t\thandleWidgetInfo(data,function(data){\n\t\t\t\t\t\t\t\t\t\t\t\tif(data){\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tolapic.utils.log(\x27Widget Media\x27,data);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(olapic.utils.isValidData(data)){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tolapic.utils.addMedia(olapicElmObj,data)\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\tif((index+1) \x3d\x3d\x3d len){\n\t\t\t\t\t\t\t\t\t\t\t\t\tolapic.initExperience(olapicElmObj,$this);\n\t\t\t\t\t\t\t\t\t\t\t\t\t// if last widget, make carousel, else it would be called with each widget\n\t\t\t\t\t\t\t\t\t\t\t\t\t// make sure other if statements don\x27t negate this from happening\n\t\t\t\t\t\t\t\t\t\t\t\t\t// will all info actually be done, or requests still being made?\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tolapic.initExperience(olapicElmObj,$this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tolapic.initExperience(olapicElmObj,$this);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\n\t\t\t\tfunction getAllMedia(){\n\t\t\t\t\t/*\n\t\t\t\t\t\tThis function retrieves product and product category media if appropriate, then calls getAllWidgetMedia()\n\t\t\t\t\t*/\n\t\t\t\t\t\n\t\t\t\t\tif ($this.hasClass(\x27olapic-crocsclub\x27)){\n\t\t\t\t\t\t// get product id array\n\t\t\t\t\t\tolapic.utils.ajaxReq(app.config.urls.olapicGetProductsOrdered,function(data){\n\t\t\t\t\t\t\t// get stream and media of products\n\t\t\t\t\t\t\tvar prodIdArr \x3d data.products;\n\t\t\t\t\t\t\tvar prodIdArrLen \x3d prodIdArr.length;\n\t\t\t\t\t\t\tif(prodIdArrLen){\n\t\t\t\t\t\t\t\t$.each(prodIdArr, function(index){\n\t\t\t\t\t\t\t\t\tgetProductStreamById(prodIdArr[index],function(data){\n\t\t\t\t\t\t\t\t\t\tgetMediaOfStream(\x27photorank\x27,data, function(data){\n\t\t\t\t\t\t\t\t\t\t\tif(data){\n\t\t\t\t\t\t\t\t\t\t\t\tolapic.utils.log(\x27Product Media\x27,data);\n\t\t\t\t\t\t\t\t\t\t\t\tif(olapic.utils.isValidData(data)){olapic.utils.addMedia(olapicElmObj,data)}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif( (index + 1) \x3d\x3d\x3d prodIdArrLen){\n\t\t\t\t\t\t\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t} else if (!(useProductStream \x26\x26 useProductCategoryStream)){\n\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgetProductStreamById(function(data){\n\t\t\t\t\t\t\tgetMediaOfStream(null,data, function(data){\n\t\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t\t\tEven if useProductStream is false we still need to call getMediaOfStream\n\t\t\t\t\t\t\t\t\tas it will provide the stream ID necessary for getCategoriesOfStream\n\t\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\t\tif(data \x26\x26 useProductStream){\n\n\t\t\t\t\t\t\t\t\tolapic.utils.log(\x27Product Media\x27,data);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif(olapic.utils.isValidData(data)){olapic.utils.addMedia(olapicElmObj,data)}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(useProductCategoryStream \x26\x26 productStreamId){\n\t\t\t\t\t\t\t\t\tgetCategoriesOfStream(function(data){\n\t\t\t\t\t\t\t\t\t\tif(data \x26\x26 data.data \x26\x26 data.data._embedded \x26\x26 data.data._embedded.category){\n\t\t\t\t\t\t\t\t\t\t\tvar catArr \x3d data.data._embedded.category,\n\t\t\t\t\t\t\t\t\t\t\t\tlen \x3d catArr.length;\n\t\t\t\t\t\t\t\t\t\t\t$.each(catArr, function(index){\n\t\t\t\t\t\t\t\t\t\t\t\tgetMediaOfCategory(\x27\x27,this.id,function(data){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(data){\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tolapic.utils.log(\x27Category Media\x27,data);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(olapic.utils.isValidData(data)){olapic.utils.addMedia(olapicElmObj,data)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tif((index+1) \x3d\x3d\x3d len){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// if last category, get widget media (else this would call get widget each time)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// will all info actually be done, or requests still being made?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tgetAllWidgetMedia();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\t\t\t},\n\t\t\t\n\t\t\t// olapic.initExperience()\n\t\t\tinitExperience : function(olapicElmObj,$this){\n\t\t\t\t// abort if no data\n\t\t\t\tif(!olapicElmObj.mediaIdArr.length){return;}\n\t\t\t\t\n\t\t\t\tif( $this.hasClass(\x27olapic-carousel\x27) ) {\n\t\t\t\t\tolapic.initCarousel(olapicElmObj,$this);\n\t\t\t\t}else if( $this.hasClass(\x27olapic-photowall\x27) ){\n\t\t\t\t\tolapic.initPhotoWall(olapicElmObj,$this);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// olapic.initPhotoWall()\n\t\t\tinitPhotoWall : function(olapicElmObj,$this){\n\t\t\t\tvar mediaIdArr \x3d olapicElmObj.mediaIdArr,\n\t\t\t\t\tmediaObj \x3d olapicElmObj.mediaObj,\n\t\t\t\t\tmaxMediaPage \x3d $this.attr(\x27data-numberperpage\x27)? Number($this.attr(\x27data-numberperpage\x27)) : 40,\n\t\t\t\t\tanalyticsInitialized \x3d false;\n\t\t\t\t\n\t\t\t\tolapic.utils.addHeader($this);\n\t\t\n\t\t\t\tif(mediaIdArr \x26\x26 mediaIdArr.length){\n\t\t\t\t\taddPhotowallItems();\n\t\t\t\t\t$(window).trigger(\x27olapic-gallery-loaded\x27,{\n\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\ttotalItems : $this.find(\x27.photowall-item\x27).length\n\t\t\t\t\t});\n\t\t\t\t\tolapic.utils.log(\x27MAKE GALLERY\x27);\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction addPhotowallItems(){\n\t\t\t\t\tvar $photoWall \x3d $this,\n\t\t\t\t\t\t$photoWallContent \x3d $photoWall.find(\x27.photowall-item\x27),\n\t\t\t\t\t\tcurrentIndex \x3d $photoWallContent.length ? $photoWallContent.last().attr(\x27data-oindex\x27) : 0,\n\t\t\t\t\t\titerIndex \x3d 0,\n\t\t\t\t\t\tphotowallItems \x3d \x27\x27,\n\t\t\t\t\t\tdata;\n\t\t\t\n\t\t\t\t\t// abort, already shown all media\n\t\t\t\t\tif( $photoWallContent \x26\x26 ($photoWallContent.length \x3d\x3d\x3d mediaIdArr.length) ){return}\n\n\t\t\t\t\tolapic.utils.log(\x27Adding Gallery content...\x27);\n\n\t\t\t\t\tif($photoWall \x26\x26 !$photoWallContent.length){\n\t\t\t\t\t\t// no existing photoWallContent\n\t\t\t\t\t\t// iter until no more content or maxMediaPage reached\n\t\t\t\t\t\twhile(\n\t\t\t\t\t\t\tmediaIdArr.length \x3e iterIndex \x26\x26 \n\t\t\t\t\t\t\titerIndex \x3c maxMediaPage\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tdata \x3d mediaObj[mediaIdArr[iterIndex]];\n\t\t\t\t\t\t\tphotowallItems \x3d photowallItems + getPhotoWallItemHtml(data,iterIndex);\n\t\t\t\t\t\t\titerIndex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-header\x27).after($(\x27\x3cdiv class\x3d\x22photowall-items\x22\x3e\x27+photowallItems+\x27\x3c/div\x3e\x27));\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// existing photoWallContent\n\t\t\t\t\t\t//start from current index, iter until no more content or maxMediaPage reached\n\t\t\t\t\t\twhile(\n\t\t\t\t\t\t\tmediaIdArr.length \x3e (Number(currentIndex) + iterIndex + 1) \x26\x26 \n\t\t\t\t\t\t\titerIndex \x3c maxMediaPage\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tdata \x3d mediaObj[ mediaIdArr[ (Number(currentIndex) + Number(iterIndex) + 1) ] ];\n\t\t\t\t\t\t\tphotowallItems \x3d photowallItems + getPhotoWallItemHtml( data, (Number(currentIndex) + Number(iterIndex) + 1) );\n\t\t\t\t\t\t\titerIndex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$photoWallContent.last().after($(photowallItems));\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t\t// add or edit button\n\t\t\t\t\tinitPhotoWallHeaderFooterBtns($photoWall, olapicElmObj, mediaIdArr);\n\t\t\t\n\t\t\t\t\t// hover focus events\n\t\t\t\t\tinitPhotoWallItemHoverFocus($photoWall);\n\t\t\t\t\t\n\t\t\t\t\t// on image click or enter keyup event, show image overlay\n\t\t\t\t\t$this.find(\x27.photowall-item\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t// TODO: test if need to prevent focus if just a touchswipe/mouse drag?\n\t\t\t\t\t\t\t$(this).focus(); // TODO: necessary?\n\t\t\t\t\t\t\tvar photoIndex \x3d $(this).attr(\x27data-oindex\x27);\n\t\t\t\t\t\t\t// olapic.photoModalOverlay.initPhotoModal(olapicElmObj, $this, $this.attr(\x22data-location\x22).trim(), photoIndex, e);\n\t\t\t\t\t\t\tolapic.shopPhotoModalOverlay.initPhotoModal(olapicElmObj, $this, $this.attr(\x22data-location\x22).trim(), photoIndex, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t\t\t// show photowall\n\t\t\t\t\t$photoWall.show();\n\t\t\t\t\t\n\t\t\t\t\t// Event\n\t\t\t\t\t$(window).trigger(\x27olapic-gallery-moreLoaded\x27,{\n\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\ttotalItems : $photoWallContent.length\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// init Olapic Widget Analytics\n\t\t\t\t\tif(!analyticsInitialized){\n\t\t\t\t\t\tanalyticsInitialized \x3d true;\n\t\t\t\t\t\tolapic.analytics.initOlapicWidgetAnalytics(olapicElmObj,$this);\n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t} // addPhotowallItems()\n\t\t\n\t\t\t\tfunction getPhotoWallItemHtml(data, num){\n\t\t\t\t\tvar html \x3d \x27\x27,\n\t\t\t\t\t\t// prevent double-quotes breaking JS\n\t\t\t\t\t\ttitle \x3d data.caption ? data.caption.replace(/\x22/g, \x22\x26quot;\x22) : \x27\x27,\n\t\t\t\t\t\tdataOid \x3d data.id ? data.id : \x27\x27,\n\t\t\t\t\t\tdataOindex \x3d num,\n\t\t\t\t\t\tproductImageUrl \x3d data.images \x26\x26 data.images.normal ? data.images.normal : \x27\x27,\n\t\t\t\t\t\tselfie \x3d data._embedded \x26\x26 data._embedded.uploader \x26\x26 data._embedded.uploader.avatar_url ? data._embedded.uploader.avatar_url : genericIconUrl,\n\t\t\t\t\t\tprofileName \x3d data._embedded \x26\x26 data._embedded.uploader \x26\x26 data._embedded.uploader.name ? data._embedded.uploader.name : \x27\x27,\n\t\t\t\t\t\tsource \x3d data.source ? (\x27- \x27 + data.source) : \x27\x27,\n\t\t\t\t\t\tshareUrl \x3d data.share_url;\n\t\t\t\t\t\n\t\t\t\t\thtml \x3d html +\t\x27\x3cdiv tabindex\x3d\x220\x22 aria-role\x3d\x22link\x22 class\x3d\x22photowall-item\x22 aria-label\x3d\x22\x27+title+\x27\x22 title\x3d\x22\x27+title+\x27\x22 data-oid\x3d\x22\x27+dataOid+\x27\x22 data-oindex\x3d\x22\x27+dataOindex+\x27\x22 style\x3d\x22background-image:url(\x27+productImageUrl+\x27)\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\x27\x3cdiv class\x3d\x22photowall-item-inner\x22\x3e\x27\n\t\t\t\t\thtml \x3d html +\t\t\t\x27\x3cdiv class\x3d\x22photowall-item-content displayFlex\x22 style\x3d\x22opacity: 0;\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\t\x27\x3cdiv class\x3d\x22photowall-item-content-footer displayFlex\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\t\t\x27\x3cdiv class\x3d\x22photowall-item-content-selfie displayFlex\x22 style\x3d\x22background-image:url(\x27+selfie+\x27)\x22\x3e\x3c/div\x3e\x27\n\t\t\t\t\thtml \x3d html +\t\t\t\t\t\x27\x3cdiv\x3e\x3cspan class\x3d\x22photowall-item-content-name\x22\x3e\x27+profileName+\x27\x3c/span\x3e\x3cbr\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\t\t\x27\x3cspan class\x3d\x22photowall-item-content-source\x22\x3e\x27+source+\x27\x3c/span\x3e\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\x27\x3c/div\x3e\x27\n\t\t\t\t\thtml \x3d html +\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\treturn html;\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction initPhotoWallHeaderFooterBtns($photoWall, olapicElmObj, mediaIdArr){\n\t\t\t\t\tvar headerBtnTxt \x3d olapicMsgs.uploadLinkTextPhotowall ? olapicMsgs.uploadLinkTextPhotowall : \x27upload photo\x27,\n\t\t\t\t\t\tfooterBtnTxt \x3d olapicMsgs.loadMoreTextPhotowall ? olapicMsgs.loadMoreTextPhotowall : \x27load more\x27,\n\t\t\t\t\t\theaderBtnHtml \x3d \x27\x3cbutton aria-disabled\x3d\x22false\x22 class\x3d\x22olapic-upload-link cx-button cx-button-cta\x22 type\x3d\x22button\x22\x3e\x27+headerBtnTxt+\x27\x3c/button\x3e\x27,\n\t\t\t\t\t\tfooterHtml \x3d \x27\x3cdiv class\x3d\x22olapic-photowall-footer\x22\x3e\x3ca style\x3d\x22font-family: mono-spaced; font-size: 14px; color: #A9A8A8; text-decoration: none; position: absolute; right: 0;\x22 class\x3d\x22olapic-direct-link\x22 target\x3d\x22_blank\x22 href\x3d\x22http://www.olapic.com/?utm_source\x3dreferral\x26amp;utm_medium\x3dpowered-by-olapic\x26amp;utm_campaign\x3dcrocs\x22\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e[i]\x3c/span\x3e\x3cspan class\x3d\x22sr-only\x22\x3epowered by Olapic\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x27;\n\t\t\t\t\tif(!$photoWall.find(\x27.olapic-header button\x27).length){\n\t\t\t\t\t\t$this.find(\x27.olapic-header\x27).append($(headerBtnHtml));\n\t\t\t\t\t\t\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-upload-link\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t\t// Event\n\t\t\t\t\t\t\t\t$(window).trigger(\x27olapic-upload-photo\x27,{\n\t\t\t\t\t\t\t\t\twidgets : $photoWall.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\t\ttotalItems : $photoWall.find(\x27.photowall-item\x27).length\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tolapic.utils.initUploadModal(olapicElmObj, $photoWall);\n\t\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif(!$photoWall.find(\x27.olapic-photowall-footer\x27).length){\n\t\t\t\t\t\t$photoWall.append($(footerHtml));\n\t\t\t\t\t}\n\t\t\t\t\tif( !$photoWall.find(\x27.olapic-photowall-footer button\x27).length \x26\x26 mediaIdArr.length \x3e !$photoWall.find(\x27.photowall-item\x27).length ){\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-photowall-footer\x27).append(getFooterBtn(true,footerBtnTxt));\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-photowall-footer button\x27).on(\x27click keyup\x27, function(e){\n\t\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t\taddPhotowallItems();\n\t\t\t\t\t\t\t\tolapic.analytics.olapicScrollEventAnalytics(olapicElmObj, $photoWall);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif( $photoWall.find(\x27.olapic-photowall-footer button\x27).length \x26\x26 mediaIdArr.length \x3d\x3d\x3d $photoWall.find(\x27.photowall-item\x27).length ){\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-photowall-footer button\x27).remove();\n\t\t\t\t\t\t$photoWall.find(\x27.olapic-photowall-footer\x27).append(getFooterBtn(false,footerBtnTxt));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfunction getFooterBtn(isActive,footerBtnTxt){\n\t\t\t\t\tvar isDisabled \x3d isActive ? \x27false\x27 : \x27true\x27;\n\t\t\t\t\tvar cssClass \x3d isActive ? \x27\x27 : \x27disabled\x27;\n\t\t\t\t\treturn $(\x27\x3cbutton aria-disabled\x3d\x22\x27+isDisabled+\x27\x22 class\x3d\x22cx-button cx-button-compact \x27+cssClass+\x27\x22 type\x3d\x22button\x22 name\x3d\x22\x22 value\x3d\x22true\x22\x3e\x27+footerBtnTxt+\x27\x3c/button\x3e\x27);\n\t\t\t\t}\n\t\t\n\t\t\t\tfunction initPhotoWallItemHoverFocus($photoWall){\n\t\t\t\t\tvar $photoWallContent \x3d $photoWall.find(\x27.photowall-item\x27);\n\t\t\t\t\t// remove $photoWallContent event listeners\n\t\t\t\t\t$photoWallContent.off();\n\t\t\t\t\t// add $photoWallContent event listeners\n\t\t\t\t\t$photoWallContent.on(\x27mouseenter focusin\x27, function(){\n\t\t\t\t\t\t$(this).find(\x27.photowall-item-content\x27).css(\x27opacity\x27,\x271\x27);\n\t\t\t\t\t});\n\t\t\t\t\t$photoWallContent.on(\x27mouseleave focusout\x27, function(){\n\t\t\t\t\t\t$(this).find(\x27.photowall-item-content\x27).css(\x27opacity\x27,\x270\x27);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, // end olapic.initPhotoWall()\n\t\t\t\n\t\t\t// olapic.initCarousel()\n\t\t\tinitCarousel : function(olapicElmObj,$this){\n\n\t\t\t\tolapic.utils.log(\x27MAKE CAROUSEL\x27);\n\t\t\t\t\n\t\t\t\tvar carouselElemId \x3d $this.attr(\x22data-location\x22).trim();\n\t\t\t\t\n\t\t\t\tolapic.utils.addHeader($this);\n\t\t\t\t\n\t\t\t\tcreateCarousel();\n\n\t\t\t\t// create carousel HTML and init\n\t\t\t\tfunction createCarousel(){\n\t\t\t\t\tvar $ul \x3d $(\x27\x3cul class\x3d\x22swiper-wrapper\x22 aria-live\x3d\x22polite\x22\x3e\x3c/ul\x3e\x27),\n\t\t\t\t\t\tid \x3d carouselElemId+\x27_widget\x27,\n\t\t\t\t\t\t$carouselContainer \x3d \x27\x27,\n\t\t\t\t\t\t$taskLinks \x3d \x27\x27,\n\t\t\t\t\t\tgalleryUrl \x3d app.config.urls.olapicGallery || \x27#\x27,\n\t\t\t\t\t\tgalleryLinkText \x3d olapicMsgs \x26\x26 olapicMsgs.galleryLinkText ? olapicMsgs.galleryLinkText : \x27see all photos\x27,\n\t\t\t\t\t\tuploadLinkText \x3d olapicMsgs \x26\x26 olapicMsgs.uploadLinkText ? olapicMsgs.uploadLinkText : \x27upload photo\x27,\n\t\t\t\t\t\tcarouselDataObj \x3d olapicElmObj.mediaObj,\n\t\t\t\t\t\tcarouselDataIdArr \x3d olapicElmObj.mediaIdArr;\n\t\t\t\n\t\t\t\t\tif(!carouselDataIdArr.length){return} // quit, no data\n\t\t\t\t\t\n\t\t\t\t\t$ul.append( olapic.utils.getCarouselListItems(olapicElmObj, $this, carouselDataIdArr, carouselDataObj, carouselElemId) );\n\t\t\t\t\t$carouselContainer \x3d olapic.utils.getCarouselHtml(id);\n\t\t\t\t\t$carouselContainer.find(\x27.sidePrev\x27).after($ul);\n\n\t\t\t\t\t// show carousel\n\t\t\t\t\t$this.show();\n\t\t\n\t\t\t\t\t// put carousel HTML into DOM\n\t\t\t\t\t$this.append($carouselContainer);\n\n\t\t\t\t\t// put carousel links into DOM\n\t\t\t\t\t$footerLinks \x3d $(\x27\x3cdiv class\x3d\x22olapic-carousel-links\x22\x3e\x3ca class\x3d\x22olapic-gallery-link cx-button cx-button-compact\x22 href\x3d\x22\x27+galleryUrl+\x27\x22\x3e\x27+galleryLinkText+\x27\x3c/a\x3e\x3ca style\x3d\x22font-family: mono-spaced; font-size: 14px; color: #A9A8A8; text-decoration: none; display: block; float: right;\x22 class\x3d\x22olapic-direct-link\x22 target\x3d\x22_blank\x22 href\x3d\x22http://www.olapic.com/?utm_source\x3dreferral\x26amp;utm_medium\x3dpowered-by-olapic\x26amp;utm_campaign\x3dcrocs\x22\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e[i]\x3c/span\x3e\x3cspan class\x3d\x22sr-only\x22\x3epowered by Olapic\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x27);\t\t\t\t\t\n\t\t\t\t\t$this.append($footerLinks);\n\t\t\t\t\t$headerLink \x3d $(\x27\x3cbutton aria-disabled\x3d\x22false\x22 type\x3d\x22button\x22 class\x3d\x22olapic-upload-link cx-button cx-button-cta\x22\x3e\x27+uploadLinkText+\x27\x3c/button\x3e\x27);\n\t\t\t\t\t$this.find(\x27.olapic-header\x27).append($headerLink);\n\t\t\t\t\t\n\t\t\t\t\t// init, create carousel\n\t\t\t\t\tvar thisSwiper \x3d app.carousel.carousels[id] \x3d new Swiper (\x27#\x27 + id, {\n\t\t\t\t\t\ta11y: true, // keep, built in ADA\n\t\t\t\t\t\tnextButton: \x27.sideNext\x27, // keep\n\t\t\t\t\t\tprevButton: \x27.sidePrev\x27, // keep\n\t\t\t\t\t\troundLengths: true, // keep\n\t\t\t            freeMode: true,\n\t\t\t            slidesPerView: \x27auto\x27, // li needs set width\n\t\t\t            spaceBetween: 10, // adjust as needed\n\t\t\t\t\t\twatchSlidesVisibility: true, // required for olapic logic\n\t\t\t\t\t\trunCallbacksOnInit: false, // required for olapic logic\n\t\t\t\t\t\tonSlideChangeEnd: function(){\n\t\t\t\t\t\t\tolapic.analytics.olapicScrollEventAnalytics(olapicElmObj, $this);\n\t\t\t\t\t\t}, // required for olapic logic\n\t\t\t\t\t\tonInit: function () {\n\t\t\t\t\t\t\t$(window).trigger(\x27olapic-carousel-loaded\x27,{\n\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\tprogress : 0,\n\t\t\t\t\t\t\t\ttotalItems : $this.find(\x27.iscroll_item\x27).length,\n\t\t\t\t\t\t\t\tcurrentRange : olapic.analytics.getCurrentItemIndices($this)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t// init ADA\n\t\t\t\t\tapp.carousel.init( $(\x22#\x22 + id) );\n\t\t\n\t\t\t\t\t// init Olapic Widget Analytics\n\t\t\t\t\tolapic.analytics.initOlapicWidgetAnalytics(olapicElmObj,$this);\n\t\t\t\t\tolapic.analytics.initOlapicGalleryLinkAnalytics(olapicElmObj,$this);\n\t\t\n\t\t\t\t\t// on click of next \x22\x3e\x22 button, add more media if more than halfway through carousel\n\t\t\t\t\t$this.find(\x27.sideNext\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t// Event\n\t\t\t\t\t\t\t$(window).trigger(\x27olapic-carousel-next\x27,{\n\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\tprogress : thisSwiper.progress,\n\t\t\t\t\t\t\t\ttotalItems : thisSwiper.slides.length,\n\t\t\t\t\t\t\t\tcurrentRange : olapic.analytics.getCurrentItemIndices($this)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// Load More\n\t\t\t\t\t\t\tif(thisSwiper.progress \x3e 0.65){\n\t\t\t\t\t\t\t\t$this.find(\x27ul.swiper-wrapper\x27).append( olapic.utils.getCarouselListItems(olapicElmObj, $this, carouselDataIdArr, carouselDataObj, carouselElemId) );\n\t\t\t\t\t\t\t\tthisSwiper.update();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t\t// on click of previous \x22\x3c\x22 button\n\t\t\t\t\t$this.find(\x27.sidePrev\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t// Event\n\t\t\t\t\t\t\t$(window).trigger(\x27olapic-carousel-prev\x27,{\n\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\tprogress : thisSwiper.progress,\n\t\t\t\t\t\t\t\ttotalItems : thisSwiper.slides.length,\n\t\t\t\t\t\t\t\tcurrentRange : olapic.analytics.getCurrentItemIndices($this)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t\t// on click of upload link event\n\t\t\t\t\t$this.find(\x27.olapic-upload-link\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t// Event\n\t\t\t\t\t\t\t$(window).trigger(\x27olapic-upload-photo\x27,{\n\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\tprogress : thisSwiper.progress,\n\t\t\t\t\t\t\t\ttotalItems : thisSwiper.slides.length,\n\t\t\t\t\t\t\t\tcurrentRange : olapic.analytics.getCurrentItemIndices($this)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tolapic.utils.initUploadModal(olapicElmObj, $this);\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\n\t\t\t\t }\n\t\t\t\t\n\t\t\t}, // end initCarousel\n\t\t\t\n\t\t\tshopPhotoModalOverlay : {\n\t\t\t\t\n\t\t\t\tinitPhotoModal : function(olapicElmObj, $this, carouselElemId, index, ev){\n\t\t\t\t\tapp.modal._stopEvents(ev);\n\t\t\t\t\tapp.config.olapic.modal \x3d {};\n\t\t\t\t\t// prevent both click \x26 keypress event triggering\n\t\t\t\t\tif (ev.type \x3d\x3d \x27keypress\x27 \x26\x26 $target.is(\x27a, button, input\x27)){return};\n\t\t\t\t\tvar $item \x3d $this.find(\x27.iscroll_item\x27).length ? $( $this.find(\x27.iscroll_item\x27)[index] ) : $( $this.find(\x27.photowall-item\x27)[index] );\n\t\t\t\t\tvar oid \x3d $item.attr(\x27data-oid\x27);\n\t\t\t\t\tvar itemMedia \x3d app.config.olapic.modal.itemMedia \x3d olapicElmObj.mediaObj[oid];\n\t\t\t\t\tvar ugc \x3d olapic.shopPhotoModalOverlay.getUGC(itemMedia);\n\t\t\t\t\tvar hasProducts \x3d ugc.modalProducts.shopProducts.length;\n\t\t\t\t\tvar pidMaster \x3d \x27\x27;\n\t\t\t\t\tvar cid \x3d \x27\x27;\n\t\t\t\t\tvar modalOpen \x3d !!( $(\x27.js-modal\x27).length \x26\x26 $(\x27.js-modal\x27).attr(\x27data-olapic\x27) );\n\t\t\t\t\tvar ugcTemplate \x3d \x27\x27+\n\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22quickview-page cs_container-fluid\x22\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22cs-row\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22js-olapic-ugc olapic-ugc col-xs-12 col-md-6 padding-0\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\tugc.html+\n\t\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cdiv aria-live\x3d\x22polite\x22 class\x3d\x22js-olapic-pdp olapic-pdp col-xs-12 col-md-6 padding-0\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\tolapic.shopPhotoModalOverlay.getLoadingHTML()+\n\t\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\t\n\t\t\t\t\tif(hasProducts \x26\x26 /_/.test(ugc.modalProducts.shopProducts[0].tag_based_key)){\n\t\t\t\t\t\tvar pidArr \x3d ugc.modalProducts.shopProducts[0].tag_based_key.split(\x27_\x27);\n\t\t\t\t\t\tpidMaster \x3d pidArr[0].toString();\n\t\t\t\t\t\tcid \x3d pidArr[1].toString();\n\t\t\t\t\t}else if(hasProducts){\n\t\t\t\t\t\tpidMaster \x3d ugc.modalProducts.shopProducts[0].tag_based_key;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvar options \x3d {\n\t\t\t\t\t\t\tisCartEdit : false,\n\t\t\t\t\t\t\tisQuickView : true,\n\t\t\t\t\t\t\tev : ev,\n\t\t\t\t\t\t\tpageUniqueID : \x27qv\x27, \n\t\t\t\t\t\t\tpid : pidMaster,\n\t\t\t\t\t\t\tpidMaster : pidMaster,\n\t\t\t\t\t\t\tcid : cid,\n\t\t\t\t\t\t\tdestinationClass : \x27js-olapic-pdp\x27,\n\t\t\t\t\t\t\taddClass: \x22quick-view-modal\x22,\n\t\t\t\t\t\t\ttemplate: \x22olapic\x22,\n\t\t\t\t\t\t\tinitialOpen: true\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\tapp.config.olapic.modal.options \x3d options;\n\t\t\t\t\t\n\t\t\t\t\tif(!modalOpen){\n\t\t\t\t\t\t// Event\n\t\t\t\t\t\tvar eventData \x3d {\n\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\tmedia : itemMedia,\n\t\t\t\t\t\t\tproducts : ugc.modalProducts.shopProducts\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif($this.hasClass(\x27olapic-carousel\x27)){\n\t\t\t\t\t\t\tvar swiper \x3d app.carousel.carousels[$this.find(\x27.swiperCarousel\x27).attr(\x27id\x27)];\n\t\t\t\t\t\t\teventData.progress \x3d swiper.progress;\n\t\t\t\t\t\t\teventData.totalItems \x3d swiper.slides.length;\n\t\t\t\t\t\t\teventData.currentRange \x3d olapic.analytics.getCurrentItemIndices($this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(window).trigger(\x27olapic-modal-triggered\x27,eventData);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// modal init\n\t\t\t\t\t\tapp.modal.init({\n\t\t\t\t\t\t\tsource : \x27olapic\x27,\n\t\t\t\t\t\t\topenNow : true,\n\t\t\t\t\t\t\t$trigger : $(ev.target).hasClass(\x27iscroll_item\x27) ? $(ev.target) : $(ev.target).closest(\x27.photowall-item\x27),\n\t\t\t\t\t\t\taddClass: options.addClass,\n\t\t\t\t\t\t\tadaTitle: app.config.msgs.olapic.shopThisLook,\n\t\t\t\t\t\t\tonOpen : function(){\n\t\t\t\t\t\t\t\t$(\x27.js-modal\x27).addClass(\x27olapic-ugc-modal\x27);\n\t\t\t\t\t\t\t\tif(!$(\x27.js-olapic-modal-styles\x27).length){\n\t\t\t\t\t\t\t\t\tolapic.shopPhotoModalOverlay.setStyles();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t$(\x27.js-modal-content\x27).html(ugcTemplate);\n\t\t\t\t\t\t\t\tolapic.shopPhotoModalOverlay.initUGC(olapicElmObj, $this, carouselElemId, index);\n\t\t\t\t\t\t\t\t// TODO remove listeners on modal close?\n\t\t\t\t\t\t\t\t// TODO how to handle for non-Olapic?\n\t\t\t\t\t\t\t\t// ATC Event\n\t\t\t\t\t\t\t\t$(window).on(\x27justAddedToYourCart-opened\x27,function(ev,data){\n\t\t\t\t\t\t\t\t\tif(data.modalData.source \x3d\x3d\x3d \x27olapic\x27){\n\t\t\t\t\t\t\t\t\t\tvar mediaId \x3d olapicElmObj.mediaIdArr[index],\n\t\t\t\t\t\t\t\t\t\t\teventData \x3d {\n\t\t\t\t\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\t\t\t\t\tmedia : olapicElmObj.mediaObj[mediaId]\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tif($this.hasClass(\x27olapic-carousel\x27)){\n\t\t\t\t\t\t\t\t\t\t\tvar swiper \x3d app.carousel.carousels[$this.find(\x27.swiperCarousel\x27).attr(\x27id\x27)];\n\t\t\t\t\t\t\t\t\t\t\teventData.progress \x3d swiper.progress;\n\t\t\t\t\t\t\t\t\t\t\teventData.progress \x3d swiper.slides.length;\n\t\t\t\t\t\t\t\t\t\t\teventData.progress \x3d olapic.analytics.getCurrentItemIndices($this);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t$(window).trigger(\x27olapic-modal-ATC\x27,eventData);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// PWR Events\n\t\t\t\t\t\t\t\t$(window).on(\x27modal-picker-ready\x27,function(){\n\t\t\t\t\t\t\t\t\tvar $modalPWRlink \x3d $(\x27.js-modal .product-review-header a\x27),\n\t\t\t\t\t\t\t\t\t\t$modalPWRbtn \x3d $(\x27.js-modal .product-review-header form button\x27);\n\t\t\t\t\t\t\t\t\t$modalPWRlink.on(\x27click\x27,function(){\n\t\t\t\t\t\t\t\t\t\t$(window).trigger(\x27pwr-modal-read-reviews-click\x27);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t$modalPWRbtn.on(\x27click\x27,function(){\n\t\t\t\t\t\t\t\t\t\t$(window).trigger(\x27pwr-modal-write-review-click\x27);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClosed : function(){\n\t\t\t\t\t\t\t\tolapic.analytics.closePhotoModalAnalyticApi(olapicElmObj, index);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(hasProducts){\n\t\t\t\t\t\tolapic.shopPhotoModalOverlay.populateProductModal(options, ugc.modalProducts.productName);\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(\x27.js-olapic-pdp\x27).html( olapic.shopPhotoModalOverlay.getNoProductHTML(ugc.modalProducts.productName) );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tsetStyles : function(){\n\t\t\t  \t\tvar styleEl \x3d document.createElement(\x27style\x27),\n\t\t\t\t\t\tstyles \x3d \x27\x27,\n\t\t\t    \t\tsheet;\n\t\t\t\t\tstyleEl.classList.add(\x27js-olapic-modal-styles\x27);\n\t\t\t    \tdocument.head.appendChild(styleEl);\n\t\t\t   \t\tsheet \x3d styleEl.sheet;\n\t\t\t\t\tstyles \x3d \x27\x27+\n\t\t\t\t\t\t\x22@media all { \x22+\n\t\t\t\t\t\t\t\x22.olapic-pdp .swiper-slide \x3e a { text-align : center; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-pdp .product-hero .swiper-slide img { width : 70% } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .quick-view-modal { height : 100%; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-pdp .swiper-container-horizontal \x3e .swiper-pagination-bullets { bottom: 0px; } \x22+\n\t\t\t\t\t\t\t\x27.olapic-ugc-modal div[role\x3d\x22document\x22] { margin-bottom: 40px; } \x27+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .olapic-ugc { margin-bottom : 30px; padding-right : \x22+ (window.innerWidth \x3c 768 ? \x270px\x27 : \x2715px\x27)+\x22; } \x22+\n\t\t\t\t\t\t\t// media queries don\x27t seem to be working with insertRule\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .cx-modal-loading { margin-top : \x22+ (window.innerWidth \x3c 768 ? \x2720px\x27 : \x2745%\x27)+\x22; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .pic-container { \x22+\n\t\t\t\t\t\t\t\t\x22height : 435px; \x22+\n\t\t\t\t    \t\t\t\x22background-size : contain; \x22+\n\t\t\t\t    \t\t\t\x22background-repeat : no-repeat; \x22+\n\t\t\t\t    \t\t\t\x22background-position-y : top; \x22+\n\t\t\t\t\t\t\t\t\x22background-position-x : center; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .profile-names { color : #444; font-family: Arial, sans-serif; margin-top : 8px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .olapic-ugc-info { background-color : #ebebeb; padding: 15px; border-radius: 5px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-profile { padding-top : 15px; display : block; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-profile img, .olapic-ugc-modal .ugc-profile div { float : left; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-profile img { margin-right : 15px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .profile-name_real { font-size : 16px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .profile-name_handle { font-size : 14px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .profile-icon-sm { margin-top : 5px; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-description { clear : both; padding-top : 15px; font-size : 14px; font-family: Arial, sans-serif; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .pic-flag { \x22+\n\t\t\t\t\t\t\t\t\x22position : absolute; \x22+\n\t\t\t\t\t\t\t    \x22top : 395px; \x22+\n\t\t\t\t\t\t\t    \x22right : 45px; \x22+\n\t\t\t\t\t\t\t    \x22width : 25px; \x22+\n\t\t\t\t\t\t\t    \x22height : 25px; \x22+\n\t\t\t\t\t\t\t    \x22cursor : pointer; \x22+\n\t\t\t\t\t\t\t    \x22-webkit-appearance : none; \x22+\n\t\t\t\t\t\t\t    \x22-moz-appearance : none; \x22+\n\t\t\t\t\t\t\t    \x22appearance : none; \x22+\n\t\t\t\t    \t\t\t\x22border: 1px solid #000; \x22+\n\t\t\t\t    \t\t\t\x22border-radius: 5px; \x22+\n\t\t\t\t    \t\t\t\x22background-size: cover; \x22+\n\t\t\t\t\t\t\t\t\x22background-image : url(//images.crocs.com/is/image/Crocs/olapic-flag?fmt\x3djpg); \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-product-name { font-size : 14px; color : #444; } \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .olapic-product { \x22+\n\t\t\t\t\t\t\t\t\x22display : block; \x22+\n\t\t\t\t\t\t\t\t\x22width : 50%; \x22+\n\t\t\t\t\t\t\t\t\x22padding : 15px; \x22+\n\t\t\t\t\t\t\t\t\x22margin : 0; \x22+\n\t\t\t\t\t\t\t\t\x22float : left; \x22+\n\t\t\t\t\t\t\t\t\x22text-align : center; \x22+\n\t\t\t\t\t\t\t\t\x22height : 159px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .olapic-product.active { \x22+\n\t\t\t\t\t\t\t\t\x22outline: 3px solid #2d78b2; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .olapic-shopthislook { \x22+\n\t\t\t\t\t\t\t\t\x22font-size: 16px; \x22+\n\t\t\t\t\t\t\t\t\x22color: #444; \x22+\n\t\t\t\t\t\t\t\t\x22margin : 15px 0 \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .ugc-productdetaillink { display : block; padding: 15px; clear: both; text-align : center; }\x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-container { \x22+\n\t\t\t\t\t\t\t\t\x22background-color: #FFF; \x22+\n\t\t\t\t\t\t\t    \x22background-color: rgba(255, 255, 255, 0.9); \x22+\n\t\t\t\t\t\t\t    \x22padding: 20px; \x22+\n\t\t\t\t\t\t\t    \x22position: absolute; \x22+\n\t\t\t\t\t\t\t    \x22top: 0; \x22+\n\t\t\t\t\t\t\t    \x22right: 0; \x22+\n\t\t\t\t\t\t\t    \x22left: 0; \x22+\n\t\t\t\t\t\t\t    \x22bottom: 0; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-close { \x22+\n\t\t\t\t\t\t\t    \x22float: right; \x22+\n\t\t\t\t\t\t\t    \x22font-size: 25px; \x22+\n\t\t\t\t\t\t\t    \x22margin: -8px 0; \x22+\n\t\t\t\t\t\t\t    \x22padding: 0 5px; \x22+\n\t\t\t\t\t\t\t    \x22border-top: 1px solid #000; \x22+\n\t\t\t\t\t\t\t    \x22border-right: 1px solid #000; \x22+\n\t\t\t\t\t\t\t    \x22cursor: pointer; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-title { \x22+\n\t\t\t\t\t\t\t\t\x22font-size: 18px; \x22+\n\t\t\t\t\t\t\t    \x22text-align: center; \x22+\n\t\t\t\t\t\t\t    \x22padding-top: 20px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-message { \x22+\n\t\t\t\t\t\t\t\t\x22font-size: 14px; \x22+\n\t\t\t\t\t\t\t    \x22padding-top: 20px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-email, .olapic-ugc-modal .flag-form-reason { \x22+\n\t\t\t\t\t\t\t    \x22margin-top: 20px; \x22+\n\t\t\t\t\t\t\t    \x22padding-right: 14px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form label { \x22+\n\t\t\t\t\t\t\t\t\x22font-size: 16px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form input, .olapic-ugc-modal .flag-form textarea { \x22+\n\t\t\t\t\t\t\t\t\x22font-size: 14px; \x22+\n\t\t\t\t\t\t\t    \x22display: block; \x22+\n\t\t\t\t\t\t\t    \x22width: 100%; \x22+\n\t\t\t\t\t\t\t    \x22margin-top: 5px; \x22+\n\t\t\t\t\t\t\t    \x22padding: 4px 6px; \x22+\n\t\t\t\t\t\t\t    \x22background: #FFF; \x22+\n\t\t\t\t\t\t\t    \x22border: 1px solid #000; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form textarea { \x22+\n\t\t\t\t\t\t\t\t\x22height: 80px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-actions { \x22+\n\t\t\t\t\t\t\t\t\x22margin-top: 30px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-actions button { \x22+\n\t\t\t\t\t\t\t\t\x22float: right; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-cancel.medButton span, .overlay-close-button span { \x22+\n\t\t\t\t\t\t\t\t\x22color: #000; \x22+\n\t\t\t\t\t\t\t    \x22background-color: initial; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .overlay-close-button { \x22+\n\t\t\t\t\t\t\t\t\x22display: block; \x22+\n\t\t\t\t\t\t\t\t\x22position: absolute; \x22+\n\t\t\t\t\t\t\t    \x22right: 0; \x22+\n\t\t\t\t\t\t\t\t\x22background-color: #FFF; \x22+\n\t\t\t\t\t\t\t\t\x22border: 1px solid #000; \x22+\n\t\t\t\t\t\t\t\t\x22border-top: 0; \x22+\n\t\t\t\t\t\t\t    \x22border-right: 0; \x22+\n\t\t\t\t\t\t\t\t\x22-webkit-appearance: none; \x22+\n\t\t\t\t\t\t\t\t\x22-moz-appearance: none; \x22+\n\t\t\t\t\t\t\t\t\x22appearance: none; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-submit { \x22+\n\t\t\t\t\t\t\t\t\x22margin: 0 0 0 35px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .flag-form-cancel span { \x22+\n\t\t\t\t\t\t\t\t\x22padding-bottom: 4px; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .swiperCarouselWrapper.product-thumbs { \x22+\n\t\t\t\t\t\t\t\t\x22display : none; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .product-hero .swiper-pagination { \x22+\n\t\t\t\t\t\t\t\t\x22display : block; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .product-hero .sideNext button, .olapic-ugc-modal .product-hero .sidePrev button{ \x22+\n\t\t\t\t\t\t\t\t\x22visibility : visible; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x27.olapic-ugc-modal .outsideNavigation .sidePrev span[aria-hidden\x3d\x22true\x22], .olapic-ugc-modal .outsideNavigation .sideNext span[aria-hidden\x3d\x22true\x22] { \x27+\n\t\t\t\t\t\t\t\t\x22display : block !important; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\t\x22.olapic-ugc-modal .outsideNavigation .sidePrev, .olapic-ugc-modal .outsideNavigation .sideNext { \x22+\n\t\t\t\t\t\t\t\t\x22pointer-events: auto !important; \x22+\n\t\t\t\t\t\t\t\x22} \x22+\n\t\t\t\t\t\t\x22} \x22;\n\t\t\t\t\tsheet.insertRule(styles,0);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetNoProductHTML : function(nameOrId){\n\t\t\t\t\tvar lookingForSomethingSimilarText \x3d olapicMsgs \x26\x26 olapicMsgs.lookingForSomethingSimilar ? olapicMsgs.lookingForSomethingSimilar : \x27Looking for something similar?\x27;\n\t\t\t\t\tvar trySearchingForText \x3d olapicMsgs \x26\x26 olapicMsgs.trySearchingFor ? olapicMsgs.trySearchingFor : \x27Try Searching for\x27;\n\t\t\t\t\tvar orText \x3d olapicMsgs \x26\x26 olapicMsgs.or ? olapicMsgs.or : \x27or\x27;\n\t\t\t\t\tvar shopAllText \x3d olapicMsgs \x26\x26 olapicMsgs.shopAll ? olapicMsgs.shopAll : \x27Shop All\x27;\n\t\t\t\t\t// JP needs wording reversed\n\t\t\t\t\tvar localeTrySearchingFor \x3d nameOrId ? (/jp/i.test(app.config.locale) ? \x27\x22\x27+nameOrId+\x27\x22 \x27+trySearchingForText : trySearchingForText+\x27 \x22\x27+nameOrId+\x27\x22\x27 ) : \x27\x27;\n\t\t\t\t\treturn \x27\x27+\n\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22text-center cx-brand-font\x22\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22no-product-lookingforsimilar cx-copy largest\x22\x3e\x27+lookingForSomethingSimilarText+\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t(nameOrId ? (\x27\x3ca class\x3d\x22no-product-searchlink no-product-bot-30\x22 target\x3d\x22_blank\x22 href\x3d\x22\x27+app.config.urls.searchShow+\x27?q\x3d\x27+nameOrId+\x27\x22\x3e\x27+localeTrySearchingFor+\x27\x3c/a\x3e\x27) : \x27\x27)+\n\t\t\t\t\t\t\t(nameOrId ? (\x27\x3cdiv class\x3d\x22 cx-copy largest no-product-bot-30\x22\x3e\x27+orText+\x27\x3c/div\x3e\x27) : \x27\x27)+\n\t\t\t\t\t\t\t\x27\x3ca class\x3d\x22no-product-shopall cx-button cx-button-cta\x22 href\x3d\x22\x27+app.config.urls.shoeFinder+\x27\x22\x3e\x27+shopAllText+\x27\x3c/a\x3e\x27+\n\t\t\t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetLoadingHTML : function(){\n\t\t\t\t\treturn \x27\x27+\n\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22cx-modal-loading\x22\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cspan aria-hidden\x3d\x22true\x22 class\x3d\x22cx-spinner\x22\x3e\x3c/span\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cspan class\x3d\x22cx-brand-font bold text-gray-dark\x22\x3e\x27+app.config.msgs.modal.loading+\x27\x3c/span\x3e\x27+\n\t\t\t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tinitUGC : function(olapicElmObj, $this, carouselElemId, index){\n\t\t\t\t\t// show full caption\n\t\t\t\t\t$captionElem \x3d $(\x27.js-olapic-caption\x27);\n\t\t\t\t\tif($captionElem.length){\n\t\t\t\t\t\t$(\x27.js-olapic-caption\x27).on(\x27click\x27,function(){\n\t\t\t\t\t\t\t$captionElem.html($captionElem.attr(\x27data-caption\x27));\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// show outline on first product\n\t\t\t\t\t$($(\x27.js-olapic-product\x27)[0]).addClass(\x27active\x27);\n\t\t\t\t\t// product actions\n\t\t\t\t\t$(\x27.js-olapic-product\x27).on(\x27click\x27,function(ev){\n\t\t\t\t\t\t$(\x27.js-olapic-product\x27).removeClass(\x27active\x27);\n\t\t\t\t\t\t$(this).addClass(\x27active\x27);\n\t\t\t\t\t\tapp.modal._stopEvents(ev);\n\t\t\t\t\t\t// prevent both click \x26 keypress event triggering\n\t\t\t\t\t\tif (ev.type \x3d\x3d \x27keypress\x27 \x26\x26 $target.is(\x27a, button, input\x27)){return};\n\t\t\t\t\t\tvar pidMaster \x3d \x27\x27;\n\t\t\t\t\t\tvar cid \x3d \x27\x27;\n\t\t\t\t\t\tvar origPid \x3d $(ev.target).is(\x27button\x27) ? $(ev.target).attr(\x27data-pid\x27) : $(ev.target).closest(\x27button\x27).attr(\x27data-pid\x27);\n\t\t\t\t\t\tif( /_/.test( origPid ) ){\n\t\t\t\t\t\t\tvar pidArr \x3d origPid.split(\x27_\x27);\n\t\t\t\t\t\t\tpidMaster \x3d pidArr[0];\n\t\t\t\t\t\t\tcid \x3d pidArr[1];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tpidMaster \x3d origPid;\n\t\t\t\t\t\t\tcid \x3d null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar options \x3d {\n\t\t\t\t\t\t\t\tisCartEdit : false,\n\t\t\t\t\t\t\t\tisQuickView : true,\n\t\t\t\t\t\t\t\tev : ev,\n\t\t\t\t\t\t\t\tpageUniqueID : \x27qv\x27, \n\t\t\t\t\t\t\t\tpid : pidMaster,\n\t\t\t\t\t\t\t\tpidMaster : pidMaster,\n\t\t\t\t\t\t\t\tcid : cid,\n\t\t\t\t\t\t\t\tdestinationClass : \x27js-olapic-pdp\x27,\n\t\t\t\t\t\t\t\taddClass: \x22quick-view-modal\x22,\n\t\t\t\t\t\t\t\ttemplate: \x22olapic\x22\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tapp.config.olapic.modal.options \x3d options;\n\t\t\t\t\t\t\n\t\t\t\t\t\t$(\x27.js-olapic-pdp\x27).html(olapic.shopPhotoModalOverlay.getLoadingHTML());\n\t\t\t\t\t\tif(window.innerWidth \x3e 768){\n\t\t\t\t\t\t\t$(\x27.js-modal\x3ediv\x27).scrollTop(0);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Event\n\t\t\t\t\t\tvar $item \x3d $this.find(\x27.iscroll_item\x27).length ? $( $this.find(\x27.iscroll_item\x27)[index] ) : $( $this.find(\x27.photowall-item\x27)[index] );\n\t\t\t\t\t\tvar oid \x3d $item.attr(\x27data-oid\x27);\n\t\t\t\t\t\tvar itemMedia \x3d app.config.olapic.modal.itemMedia \x3d olapicElmObj.mediaObj[oid];\n\t\t\t\t\t\tvar eventData \x3d {\n\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\tmedia : itemMedia,\n\t\t\t\t\t\t\tpidMaster : pidMaster,\n\t\t\t\t\t\t\tcid : cid\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif($this.hasClass(\x27olapic-carousel\x27)){\n\t\t\t\t\t\t\tvar swiper \x3d app.carousel.carousels[$this.find(\x27.swiperCarousel\x27).attr(\x27id\x27)];\n\t\t\t\t\t\t\teventData.progress \x3d swiper.progress;\n\t\t\t\t\t\t\teventData.totalItems \x3d swiper.slides.length;\n\t\t\t\t\t\t\teventData.currentRange \x3d olapic.analytics.getCurrentItemIndices($this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(window).trigger(\x27olapic-modal-productClick\x27,eventData);\n\t\t\t\t\t\t\n\t\t\t\t\t\tolapic.shopPhotoModalOverlay.populateProductModal(options,$(this).find(\x27.ugc-product-name\x27).html());\n\t\t\t\t\t});\n\t\t\t\t\t// init analytics\n\t\t\t\t\tolapic.analytics.initPhotoModalAnalytics(olapicElmObj, $this, index);\n\t\t\t\t\t// flag\n\t\t\t\t\tolapic.photoModalOverlay.initPhotoModalFlag(olapicElmObj, $this, carouselElemId, index);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetModalProducts : function(itemMedia){\n\t\t\t\t\tvar htmlArr \x3d [],\n\t\t\t\t\t\tproducts \x3d [],\n\t\t\t\t\t\tphotoMedia \x3d app.config.olapic.modal.itemMedia \x3d itemMedia,\n\t\t\t\t\t\thasVariants \x3d false,\n\t\t\t\t\t\tvariantMasters \x3d [],\n\t\t\t\t\t\tmodalProductsIdArr \x3d [],\n\t\t\t\t\t\tmodalProductsObj \x3d {},\n\t\t\t\t\t\tshopProducts \x3d [],\n\t\t\t\t\t\tproductName \x3d \x27\x27;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t// Put all valid product streams into public obj.\n\t\t\t\t\t$.each(photoMedia._embedded[\x27streams:all\x27]._embedded.stream, function(itrIndex){\n\t\t\t\t\t\tvar currentObj \x3d this;\n\t\t\t\t\t\t// skip if not a product or no stock...etc.\n\t\t\t\t\t\tif (olapic.utils.isValidProductStream(currentObj)){\n\t\t\t\t\t\t\tvar pidAndCid \x3d currentObj.tag_based_key;\n\t\t\t\t\t\t\tif(!modalProductsObj[currentObj.id.toString()]){\n\t\t\t\t\t\t\t\tmodalProductsIdArr.push(currentObj.id.toString());\n\t\t\t\t\t\t\t\tmodalProductsObj[currentObj.id.toString()] \x3d currentObj;\n\t\t\t\t\t\t\t\tif(/_/.test(pidAndCid)){\n\t\t\t\t\t\t\t\t\tvariantMasters.push(pidAndCid.split(\x27_\x27)[0].toString());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// in case of no products we\x27ll provide a name to search by for more products\n\t\t\t\t\t\tif(currentObj.shop_button_url){\n\t\t\t\t\t\t\tproductName \x3d currentObj.name;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\t// iterate again to remove variant masters\n\t\t\t\t\tfor(var i\x3d0,len\x3dmodalProductsIdArr.length;i\x3clen;i++){\n\t\t\t\t\t\tvar currentObj \x3d modalProductsObj[modalProductsIdArr[i]];\n\t\t\t\t\t\tif( variantMasters.indexOf(currentObj.tag_based_key.toString()) \x3d\x3d\x3d -1 ){\n\t\t\t\t\t\t\tshopProducts.push(currentObj);\n\t\t\t\t\t\t\thtmlArr.push(getLi(currentObj));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tapp.config.olapic.modal.modalProductsObj \x3d modalProductsObj;\n\t\t\t\t\tapp.config.olapic.modal.shopProducts \x3d shopProducts;\n\t\t\t\t\t\n\t\t\t\t\tfunction getLi(currentObj){\n\t\t\t\t\t\tvar pName \x3d currentObj.name,\n\t\t\t\t\t\t\tpImg \x3d currentObj._embedded.base_image.images.mobile,\n\t\t\t\t\t\t\tpid \x3d currentObj.tag_based_key;\n\t\t\t\t\t\treturn \x27\x3cli\x3e\x3cbutton role\x3d\x22link\x22 class\x3d\x22js-olapic-product olapic-product\x22 href\x3d\x22#\x22 data-pid\x3d\x22\x27+pid+\x27\x22\x3e\x3cimg src\x3d\x22\x27+pImg+\x27\x22 width\x3d\x22140\x22 height\x3d\x2287\x22 alt\x3d\x22\x22 /\x3e\x3cdiv class\x3d\x22ugc-product-name\x22\x3e\x27+pName+\x27\x3c/div\x3e\x3c/button\x3e\x3c/li\x3e\x27;\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\treturn {\n\t\t\t\t\t\thtml: shopProducts.length ? \x27\x3cul\x3e\x27+htmlArr.join(\x27\x27)+\x27\x3c/ul\x3e\x27 : \x27\x27,\n\t\t\t\t\t\tshopProducts : shopProducts,\n\t\t\t\t\t\tproductName : productName\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetShortCaption : function(caption){\n\t\t\t\t\tvar textArr \x3d caption.split(\x27 \x27);\n\t\t\t\t\t\n\t\t\t\t\tif(textArr.length \x3e 7){\n\t\t\t\t\t\treturn \x27\x3cdiv data-caption\x3d\x22\x27+caption+\x27\x22 class\x3d\x22js-olapic-caption\x22\x3e\x27+textArr.slice(0,7).join(\x27 \x27) + \x27 \x3cbutton\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e(\u2026)\x3cspan\x3e\x3cspan class\x3d\x22sr-only\x22\x3eGet full text.\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e\x27;\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn caption;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetUGC : function(itemMedia){\n\t\t\t\t\tvar modalProducts \x3d olapic.shopPhotoModalOverlay.getModalProducts(itemMedia),\n\t\t\t\t\t\tcurrentPhotoData \x3d itemMedia,\n\t\t\t\t\t\tproductImageUrl \x3d currentPhotoData.images \x26\x26 currentPhotoData.images.normal ? currentPhotoData.images.normal : \x27\x27,\n\t\t\t\t\t\tsourceUrl \x3d currentPhotoData.original_source ? currentPhotoData.original_source : \x27\x27,\n\t\t\t\t\t\tprofileImageUrl \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.avatar_url ? currentPhotoData._embedded.uploader.avatar_url : \x27\x27,\n\t\t\t\t\t\tprofileName \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.name ? currentPhotoData._embedded.uploader.name : \x27\x27,\n\t\t\t\t\t\tprofileHandle \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.username ? currentPhotoData._embedded.uploader.username : \x27\x27,\n\t\t\t\t\t\tcaption \x3d currentPhotoData.caption ? currentPhotoData.caption : \x27\x27,\n\t\t\t\t\t\tshortCaption \x3d caption ? olapic.shopPhotoModalOverlay.getShortCaption(caption) : \x27\x27,\n\t\t\t\t\t\tshareUrl \x3d currentPhotoData.share_url ? currentPhotoData.share_url : \x27\x27,\n\t\t\t\t\t\tprofileIconUrl \x3d \x27\x27,\n\t\t\t\t\t\tprofileIconText \x3d \x27\x27,\n\t\t\t\t\t\tphotoDetailsModalText \x3d olapicMsgs \x26\x26 olapicMsgs.photoDetailsModal ? olapicMsgs.photoDetailsModal : \x27photo details modal\x27,\n\t\t\t\t\t\tcloseText \x3d olapicMsgs \x26\x26 olapicMsgs.close ? olapicMsgs.close : \x27close\x27,\n\t\t\t\t\t\tnextText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel \x26\x26 app.config.msgs.carousel.nextitem ? app.config.msgs.carousel.nextitem : \x27next item\x27,\n\t\t\t\t\t\tprevText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel \x26\x26 app.config.msgs.carousel.previousitem ? app.config.msgs.carousel.previousitem : \x27previous item\x27,\n\t\t\t\t\t\tprofileImageText \x3d olapicMsgs \x26\x26 olapicMsgs.profileImage ? olapicMsgs.profileImage : \x27profile image\x27,\n\t\t\t\t\t\tflagFormTitleText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormTitle ? olapicMsgs.flagPhotoFormTitle : \x27Report Photo\x27;\n\t\t\t\t\t\tshopThisLookText \x3d olapicMsgs \x26\x26 olapicMsgs.shopThisLook ? olapicMsgs.shopThisLook : \x27Shop This Look\x27;\n\t\t\n\t\t\t\t\tswitch (currentPhotoData.source) {\n\t\t\t\t\t  case \x27instagram\x27:\n\t\t\t\t\t\tprofileIconUrl \x3d instagramIconUrl;\n\t\t\t\t\t\tprofileIconText \x3d \x27instagram\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27twitter\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d twitterIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27twitter\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27facebook\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d facebookIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27facebook\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27pinterest\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d pinterestIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27pinterest\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  default:\n\t\t  \t\t\t\tprofileIconUrl \x3d genericIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27crocs\x27; \n\t\t\t\t\t}\n\t\t\n\t\t\t\t\tvar html \x3d\t\x27\x27+\n\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22olapic-ugc-info\x22\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22pic-container\x22 style\x3d\x22background-image:url(\x27+productImageUrl+\x27);\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cbutton role\x3d\x22link\x22 type\x3d\x22button\x22 class\x3d\x22pic-flag\x22 title\x3d\x22\x27+flagFormTitleText+\x27\x22\x3e\x3c/button\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t(profileIconText \x3d\x3d\x3d \x27crocs\x27 ? \x27\x3cdiv class\x3d\x22ugc-profile\x22\x3e\x27 : \x27\x3ca rel\x3d\x22noopener noreferrer\x22 target\x3d\x22_blank\x22 class\x3d\x22ugc-profile\x22 href\x3d\x22\x27+ sourceUrl +\x27\x22\x3e\x27)+\n\t\t\t\t\t\t\t\t\x27\x3cimg src\x3d\x22\x27+ profileImageUrl +\x27\x22 class\x3d\x22profile-img\x22 alt\x3d\x22\x27+profileImageText+\x27\x22 width\x3d\x2250px\x22 height\x3d\x2250px\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cimg src\x3d\x22\x27+profileIconUrl+\x27\x22 class\x3d\x22profile-icon-sm\x22 alt\x3d\x22\x27+profileIconText+\x27\x22 width\x3d\x2239px\x22 height\x3d\x2239px\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22profile-names\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\t\x27\x3cspan class\x3d\x22profile-name_real cx-brand-font\x22\x3e\x27+profileName+\x27\x3c/span\x3e\x27+\n\t\t\t\t\t\t\t\t\t\x27\x3cbr\x3e\x27+\n\t\t\t\t\t\t\t\t\t\x27\x3cspan class\x3d\x22profile-name_handle cx-brand-font\x22\x3e\x27+profileHandle+\x27\x3c/span\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t(profileIconText \x3d\x3d\x3d \x27crocs\x27 ? \x27\x3c/div\x3e\x27 : \x27\x3c/a\x3e\x27)+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22ugc-description cx-brand-font\x22\x3e\x27+shortCaption+\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22clear\x22\x3e\x3c/div\x3e\x27+\n\t\t\t\t\t\t(modalProducts.shopProducts.length ? \x27\x3cdiv class\x3d\x22olapic-shopthislook cx-brand-font bold\x22\x3e\x27+shopThisLookText+\x27\x3c/div\x3e\x27+modalProducts.html : \x27\x27);\n\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: html,\n\t\t\t\t\t\t\tmodalProducts: modalProducts\n\t\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tpopulateProductModal : function(options, nameOrId){\n\t\t\t\t\t// it\x27s possible a modal may take so long to populate with content\n\t\t\t\t\t// the user may close this then open another, due to content\n\t\t\t\t\t// population being async the user may get original data in the new modal\n\t\t\t\t\t// we use an id based on pid to test before populating\n\t\t\t\t\t$(\x27.js-modal\x27).attr(\x27data-modalpid\x27,options.pid);\n\t\t\t\t\t$(\x27.js-modal\x27).attr(\x27data-olapic\x27,\x27true\x27);\n\t\t\t\t\t// this is mostly for Adobe Target tracking\n\t\t\t\t\t$(\x27.js-modal\x27).attr(\x27data-modalpidmaster\x27,options.pidMaster);\n\t\t\t\t\toptions.cid \x3d options.cid || $(options.ev.target).attr(\x27color-id\x27) ? options.cid || $(options.ev.target).attr(\x27color-id\x27) : \x27\x27;\n\t\t\t\t\toptions.shoppable \x3d true;\n\t\t\t\t\toptions.templateExists \x3d !!(app.templates \x26\x26 app.templates[options.template]);\n\t\t\t\t\toptions.staticExists \x3d !!(app.product.staticProductData);\n\t\n\t\t\t\t\tgetPDPComponents(options, nameOrId);\n\n\t\t\t\t\tfunction getTemplate(){\n\t\t\t\t\t\treturn \x27\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22col-xs-12\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27{{ getSnipe }}\x27+\n\t\t\t\t\t\t\t\t\x27{{ getName }}\x27+\n\t\t\t\t\t\t\t\t\x27{{ getLocalizedName }}\x27+\n\t\t\t\t\t\t\t\t\x27{{ getReviewStars }}\x27+\n\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22col-xs-12\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27{{ getHeroCarousel }}\x27+\n\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22col-xs-12\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22clearfix\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\t\x27{{ getSaleSnipe }}\x27+\n\t\t\t\t\t\t\t\t\t\x27{{ getPrice }}\x27+\n\t\t\t\t\t\t\t\t\t\x27{{ getPromos }}\x27+\n\t\t\t\t\t\t\t\t\t\x27\x3cdiv class\x3d\x22product-variations oos-container\x22\x3e\x27+\n\t\t\t\t\t\t\t\t\t\t\x27{{ getOosOverlay }}\x27+\n\t\t\t\t\t\t\t\t\t\t\x27\x3col\x3e\x27+\n\t\t\t\t\t\t\t\t\t\t\t\x27{{ getColorSwatches }}\x27+\n\t\t\t\t\t\t\t\t\t\t\t\x27{{ getSizeSwatches }}\x27+\n\t\t\t\t\t\t\t\t\t\t\x27\x3c/ol\x3e\x27+\n\t\t\t\t\t\t\t\t\t\t\x27{{ getAltMessage }}\x27+\n\t\t\t\t\t\t\t\t\t\t\x27{{ atc  }}\x27+\n\t\t\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27+\n\t\t\t\t\t\t\t\x27\x3c/div\x3e\x27 +\n\t\t\t\t\t\t\x27{{ getPdpDetailLink }}\x27;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction getSelectParams(){\n\t\t\t\t\t\tvar selectParamsArr \x3d [];\n\t\t\t\t\t\tvar paramsArr \x3d window.location.search.replace(\x27?\x27,\x27\x27).split(\x27\x26\x27);\n\t\t\t\t\t\tfor(var i\x3d0,len\x3dparamsArr.length;i\x3clen;i++){\n\t\t\t\t\t\t\t// We purposefully do not pass cgid,\n\t\t\t\t\t\t\t// sizes are tied to a product\x27s category,\n\t\t\t\t\t\t\t// if we pass an unrelated category to the product\n\t\t\t\t\t\t\t// we will not get sizes returned\n\t\t\t\t\t\t\tif(/cid\x3d|sid\x3d|vs\x3d/.test(paramsArr[i]) ){\n\t\t\t\t\t\t\t\tselectParamsArr.push(paramsArr[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(selectParamsArr.length){\n\t\t\t\t\t\t\treturn \x27\x26\x27 + selectParamsArr.join(\x27\x26\x27);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn \x27\x27;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction getPDPComponents(options, nameOrId){\n\t\t\t\t\t\tif(!$(\x27.js-pdpComponents\x27).length){\n\t\t\t\t\t\t\tvar head \x3d document.getElementsByTagName(\x27head\x27)[0];\n\t\t\t\t\t\t\tvar script \x3d document.createElement(\x27script\x27);\n\t\t\t\t\t\t\tscript.type \x3d \x27text/javascript\x27;\n\t\t\t\t\t\t\tscript.classList.add(\x27js-pdpComponents\x27);\n\t\t\t\t\t\t\tscript.onload \x3d function(){\n\t\t\t\t\t\t\t\tgetProductAPIData(options, nameOrId);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tscript.src \x3d app.config.urls.pdpComponents;\n\t\t\t\t\t\t\thead.appendChild(script);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgetProductAPIData(options, nameOrId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfunction getProductAPIData(options, nameOrId){\n\t\t\t\t\t\tvar isProductDataCached \x3d app.config.products \x26\x26 app.config.products[options.pidMaster] \x26\x26 app.config.products[options.pidMaster].pidData;\n\t\t\t\t\t\tif(isProductDataCached){\n\t\t\t\t\t\t\tinitProductModal(options, nameOrId, null);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tvar request \x3d {  \n\t\t\t\t\t\t\t\t\t\ttype: \x22GET\x22,\n\t\t\t\t\t\t\t\t\t\turl: app.config.urls.productAPI + \x27?pid\x3d\x27+ options.pidMaster + (!options.staticExists ? \x27\x26static\x3dtrue\x27: \x27\x27) + (options.cid ? \x27\x26cid\x3d\x27 + options.cid : \x27\x27) + getSelectParams()\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tapp.config.olapic.modal.requestUrl \x3d request.url;\n\t\t\t\t\t\t\t$.ajax(request)\n\t\t\t\t\t\t    \t.done(function(productData) {\n\t\t\t\t\t\t\t\t\tif(productData){\n\t\t\t\t\t\t\t\t\t\tinitProductModal(options, nameOrId, JSON.parse(productData.replace(/\x3c!-- dwMarker[\\s\\S]*?--\x3e/g, \x22\x22)));\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t//app.modal._error();\n\t\t\t\t\t\t\t\t\t\t$(\x27.js-olapic-pdp\x27).html( olapic.shopPhotoModalOverlay.getNoProductHTML(options.pidMaster) );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.fail(function() {\n\t\t\t\t\t\t\t\t\t//app.modal._error();\n\t\t\t\t\t\t\t\t\t$(\x27.js-olapic-pdp\x27).html( olapic.shopPhotoModalOverlay.getNoProductHTML(options.pidMaster) );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction initProductModal(options, nameOrId, productData){\n\t\t\t\t\t\t// organize cached and received data\n\t\t\t\t\t\tvar isProductDataCached \x3d productData ? false : true,\n\t\t\t\t\t\t\tcomponents \x3d app.exports.pdpComponents,\n\t\t\t\t\t\t\tallProductData \x3d {\n\t\t\t\t\t\t\t\tdata :  (isProductDataCached ? app.config.products[options.pidMaster].pidData : productData.data),\n\t\t\t\t\t\t\t\tavailability : (isProductDataCached ? app.config.products[options.pidMaster].availability : productData.availability),\n\t\t\t\t\t\t\t\tmasterSKU : (isProductDataCached ? app.config.products[options.pidMaster].masterSKU : productData.masterSKU),\n\t\t\t\t\t\t\t\ttemplate : (options.template \x26\x26 options.templateExists ? app.templates[options.template] : getTemplate()),\n\t\t\t\t\t\t\t\tstatics : (options.staticExists ? app.product.staticProductData : productData.statics)\n\t\t\t\t\t\t\t};\n\t\n\t\t\t\t\t\t// cache static data\n\t\t\t\t\t\tif(!app.templates){\n\t\t\t\t\t\t\tapp.templates \x3d {};\n\t\t\t\t\t\t\tapp.templates[options.template] \x3d allProductData.template;\n\t\t\t\t\t\t}else if(!app.templates[options.template]){\n\t\t\t\t\t\t\tapp.templates[options.template] \x3d allProductData.template;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!app.product.staticProductData){\n\t\t\t\t\t\t\tapp.product.staticProductData \x3d allProductData.statics;\n\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t// put relevant data in app.config, used by initPdpViewer()\n\t\t\t\t\t\tif(!app.config.products){\n\t\t\t\t\t\t\tapp.config.products \x3d {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar acObj \x3d {\n\t\t\t\t\t\t\tsitePrefs : allProductData.statics.sitePrefs,\n\t\t\t\t\t\t\turls : allProductData.statics.urls,\n\t\t\t\t\t\t\tmsgs : allProductData.statics.msgs,\n\t\t\t\t\t\t\tproducts : {}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tacObj.products[options.pidMaster] \x3d {\n\t\t\t\t\t\t\t\tmSKU : allProductData.masterSKU,\n\t\t\t\t\t\t\t\tmasterData : allProductData.availability,\n\t\t\t\t\t\t\t\tpidData : allProductData.data,\n\t\t\t\t\t\t\t\tmsgs : {\n\t\t\t\t\t\t\t\t\ttooltipLowATS01 : allProductData.statics.msgs.tooltipLowATS01,\n\t\t\t\t\t\t\t\t\ttooltipLowATS02 : allProductData.statics.msgs.tooltipLowATS02,\n\t\t\t\t\t\t\t\t\ttooltipLowATS03 : allProductData.data.msgs.tooltipLowATS03\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tapp.setConfig(acObj);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// abort if Product doesn\x27t exit or offline\n\t\t\t\t\t\tif( (productData \x26\x26 !productData.data.online) || (isProductDataCached \x26\x26 !app.config.products[options.pidMaster].pidData.online) ){\n\t\t\t\t\t\t\tvar nameOrId \x3d productData ? productData.data.name : app.config.products \x26\x26 app.config.products[options.pidMaster] \x26\x26 app.config.products[options.pidMaster].pidData.name ? app.config.products[options.pidMaster].pidData.name : options.pidMaster;\n\t\t\t\t\t\t\t$(\x27.js-olapic-pdp\x27).html( olapic.shopPhotoModalOverlay.getNoProductHTML(nameOrId) );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tfunction getPdpLink(){\n\t\t\t\t\t\t\tvar link \x3d allProductData.data.urls.pdp.split(\x27?\x27)[0];\n\t\t\t\t\t\t\tvar params \x3d getSelectParams();\n\t\t\t\t\t\t\tvar $color \x3d $(\x27.js-modal-content .color-refine-template li.sel img\x27);\n\t\t\t\t\t\t\tvar cid \x3d $color.length ? $color.attr(\x27color-id\x27) : null;\n\t\t\t\t\t\t\tif(cid || options.cid || params){\n\t\t\t\t\t\t\t\tlink \x3d link + \x22?\x22;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(cid){\n\t\t\t\t\t\t\t\tlink \x3d link + \x22\x26cid\x3d\x22+cid;\n\t\t\t\t\t\t\t}else if(options.cid){\n\t\t\t\t\t\t\t\tlink \x3d link + \x22\x26cid\x3d\x22+options.cid;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(params){\n\t\t\t\t\t\t\t\tlink \x3d link + params;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn \x27\x3ca class\x3d\x22ugc-productdetaillink\x22 href\x3d\x22\x27+ link +\x27\x22\x3e\x27+ allProductData.statics.msgs.viewDetails +\x27\x3c/a\x3e\x27;\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t// Note: some msgs and urls are split between data and statics\n\t\t\t\t\t\tvar contentObj \x3d {\n\t\t\t\t\t\t\tgetSnipe : components.getSnipe(allProductData.data),\n\t\t\t\t\t\t\tgetName : components.getName(allProductData.data),\n\t\t\t\t\t\t\tgetLocalizedName : components.getLocalizedName(allProductData.data),\n\t\t\t\t\t\t\tgetReviewStars : components.getReviewStars(allProductData.data, allProductData.statics, options),\n\t\t\t\t\t\t\tgetHeroCarousel : components.getHeroCarousel(allProductData.data, allProductData.statics, options),\n\t\t\t\t\t\t\tgetSaleSnipe : components.getSaleSnipe(allProductData.statics),\n\t\t\t\t\t\t\tgetPrice : components.getPrice(allProductData.data, allProductData.statics),\n\t\t\t\t\t\t\tgetPromos : components.getPromos(allProductData.data, allProductData.statics, options),\n\t\t\t\t\t\t\tgetOosOverlay : components.getOosOverlay(allProductData.statics),\n\t\t\t\t\t\t\tgetColorSwatches : components.getColorSwatches(allProductData.data, allProductData.statics, options),\n\t\t\t\t\t\t\tgetSizeSwatches : components.getSizeSwatches(allProductData.data, allProductData.statics, options),\n\t\t\t\t\t\t\tgetAltMessage : components.getAltMessage(allProductData.data),\n\t\t\t\t\t\t\tatc : (/cn/i.test(allProductData.data.locale) ? components.getCNMarketplace(allProductData.data, allProductData.statics) :\n\t\t\t\t\t\t\t\t\tcomponents.getSizeInfo(allProductData.data, allProductData.statics, options) +\n\t\t\t\t\t\t\t\t\tcomponents.getProductMessaging(allProductData.data, allProductData.statics) +\n\t\t\t\t\t\t\t\t\tcomponents.getAddToWishList(allProductData.statics) +\n\t\t\t\t\t\t\t\t\tcomponents.getATCForm(allProductData.data, allProductData.statics, options) +\n\t\t\t\t\t\t\t\t\tcomponents.getMobileSizePlaceholder() +\n\t\t\t\t\t\t\t\t\tcomponents.getAtcActions(allProductData.data, allProductData.statics, options)),\n\t\t\t\t\t\t\tgetPdpDetailLink : getPdpLink()\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar modalContentHtml \x3d app.exports.pdpComponents.getFilledTplStr(allProductData.template, contentObj);\n\t\n\t\t\t\t\t\tif($(\x27.js-modal\x27).attr(\x27data-modalpid\x27) !\x3d options.pid || !$(\x27.js-modal\x27).attr(\x27data-olapic\x27)){\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar $destination \x3d $((\x27.\x27+options.destinationClass));\n\t\t\t\t\t\t$destination.html($(modalContentHtml));\n\t\t\t\t\t\t\n\t\t\t\t\t\t// ADA if not initial modal open, on product button click\n\t\t\t\t\t\tif(!options.initialOpen){\n\t\t\t\t\t\t\tvar $productH1 \x3d $destination.find(\x27h1\x27);\n\t\t\t\t\t\t\t$productH1.attr(\x27tabindex\x27,0);\n\t\t\t\t\t\t\t$productH1.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tapp.quickView.picker \x3d new app.pdp({\n\n\t\t\t\t\t\t\tuniqueID: options.pageUniqueID,\n\t\t\t\t\t\t\toptions: options,\n\t\t\t\t\t\t\tproductID: options.pidMaster,\n\t\t\t\t\t\t\tisEdit: options.isCartEdit,\n\t\t\t\t\t\t\tisPopup: true,\n\t\t\t\t\t\t\tdisplayToolips: false,\n\t\t\t\t\t\t\tproductName: allProductData.data.name,\n\t\t\t\t\t\t\tdefaultColor: options.cid ? options.cid : allProductData.data.defaultColor ? allProductData.data.defaultColor : null,\n\t\t\t\t\t\t\tsizeID: allProductData.data.sizeID ? allProductData.data.sizeID : null,\n\t\t\t\t\t\t\tmasterData: app.config.products[options.pidMaster].masterData,\n\t\t\t\t\t\t\tmsgs: app.config.products[options.pidMaster].msgs,\n\t\t\t\t\t\t\tmSKU: app.config.products[options.pidMaster].mSKU,\n\t\t\t\t\t\t\tisMaster: allProductData.data.isMaster,\n\t\t\t\t\t\t\t$price: $(\x27.\x27+options.addClass + \x22 .js-product-price\x22),\n\t\t\t\t\t\t\t$colors: $(\x27.\x27+options.addClass + \x22 .js-color-refine-colors\x22),\n\t\t\t\t\t\t\t$colorDisplay: $(\x27.\x27+options.addClass + \x22 .js-color-refine-label\x22),\n\t\t\t\t\t\t\t$sizes: $(\x27.\x27+options.addClass + \x22 .js-size-refine-sizes:visible\x22),\n\t\t\t\t\t\t\t$sizeDisplay: $(\x27.\x27+options.addClass + \x22 .js-size-refine-text-value\x22),\n\t\t\t\t\t\t\t$sizeToggle: $(\x27.\x27+options.addClass + \x22 .js-size-refine-show-us\x22),\n\t\t\t\t\t\t\t$messages: $(\x27.\x27+options.addClass + \x22 .js-product-messaging\x22),\n\t\t\t\t\t\t\t$addToCart: $(\x27.\x27+options.addClass + \x22 .js-product-add-to-cart\x22),\n\t\t\t\t\t\t\t$qty: $(\x27.\x27+options.addClass + \x22 .js-product-qty select\x22),\n\t\t\t\t\t\t\tvariantChangeCallback: function(picker){\n\t\t\t\t\t\t\t\tapp.product.pdpViewer.updateProductThumbnailScroll(app.quickView.picker, options.pageUniqueID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(window).trigger(\x27modal-picker-ready\x27);\n\t\t\t\t\t\tapp.product.pdpViewer.initPdpViewer(options.pageUniqueID);\n\t\t\t\t\t\tinitPdpLinkCid();\n\t\t\t\t\t\tif(options.initialOpen){ app.modal._evLoadedEvent(); }\n\t\t\t\t\t\t\n\t\t\t\t\t\tfunction initPdpLinkCid(){\n\t\t\t\t\t\t\tvar $initialSelCidElm \x3d $(\x27.js-modal .js-color-refine-colors li.sel input\x27);\n\t\t\t\t\t\t\tif($(\x27.olapic-ugc-modal\x27).length \x26\x26 $initialSelCidElm.length \x26\x26 document.querySelector(\x27.quick-view-modal\x27)){\n\t\t\t\t\t\t\t\tvar initialCid \x3d $initialSelCidElm.attr(\x27value\x27);\n\t\t\t\t\t\t\t\tsetPdpLinkCid(initialCid);\n\t\t\t\t\t\t\t\t$(\x27.js-modal .js-color-refine-colors input\x27).on(\x27click\x27,function(e){\n\t\t\t\t\t\t\t\t\tvar cid \x3d $(e.target).attr(\x27value\x27);\n\t\t\t\t\t\t\t\t\tsetPdpLinkCid(cid)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction setPdpLinkCid(cid){\n\t\t\t\t\t\t\tvar $pdpLinkElem \x3d $(\x27.ugc-productdetaillink\x27);\n\t\t\t\t\t\t\tvar pdpLinkHref \x3d $pdpLinkElem.attr(\x27href\x27);\n\t\t\t\t\t\t\tif(pdpLinkHref.indexOf(\x27cid\x27) \x3e -1){\n\t\t\t\t\t\t\t\tvar hrefUpdated \x3d pdpLinkHref.replace(/cid\x3d(...)/, \x27cid\x3d\x27+cid);\n\t\t\t\t\t\t\t\t$pdpLinkElem.attr(\x27href\x27,hrefUpdated);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tif(pdpLinkHref.indexOf(\x27?\x27) \x3e -1){\n\t\t\t\t\t\t\t\t\t$pdpLinkElem.attr(\x27href\x27,pdpLinkHref + \x27\x26cid\x3d\x27 + cid);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t$pdpLinkElem.attr(\x27href\x27,pdpLinkHref + \x27?cid\x3d\x27 + cid);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, // end shopPhotoModalOverlay \n\t\t\t\n\t\t\tphotoModalOverlay : {\n\t\t\t\t\n\t\t\t\tinitPhotoModal : function(olapicElmObj, $this, carouselElemId, index, ev){\n\t\t\t\t\tvar photoModalCarouselId \x3d carouselElemId + \x27_modal\x27,\n\t\t\t\t\t\t$html \x3d $(olapic.photoModalOverlay.getPhotoModalHtml(olapicElmObj, $this, carouselElemId, index));\n\t\t\t\n\t\t\t\t\t// remove shop similar text if no products\t\n\t\t\t\t\tif(!$html.find(\x27.iscroll_item\x27).length){\n\t\t\t\t\t\t$html.find(\x27.overlay-shop-text\x27).remove()\n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t$(\x27body\x27).append($html);\n\t\t\t\n\t\t\t\t\t// if photo modal product carousel, init events\n\t\t\t\t\tif($(\x27#\x27+ photoModalCarouselId).length){\n\t\t\t\t\n\t\t\t\t\t\t// remove existing (old) public reference\n\t\t\t\t\t\tdelete app.carousel.carousels[photoModalCarouselId];\n\t\t\t\t\n\t\t\t\t\t\t// init, create carousel\n\t\t\t\t\t\tvar thisModalSwiper \x3d app.carousel.carousels[photoModalCarouselId] \x3d new Swiper (\x27#\x27 + photoModalCarouselId, {\n\t\t\t\t\t\t\t\t\ta11y: true, // keep, built in ADA\n\t\t\t\t\t\t\t\t\tnextButton: \x27.sideNext\x27, // keep\n\t\t\t\t\t\t\t\t\tprevButton: \x27.sidePrev\x27, // keep\n\t\t\t\t\t\t\t\t\troundLengths: true, // keep\n\t\t\t\t\t\t            freeMode: true,\n\t\t\t\t\t\t            slidesPerView: \x27auto\x27, // li needs set width\n\t\t\t\t\t\t            spaceBetween: 10, // adjust as needed\n\t\t\t\t\t\t\t\t\twatchSlidesVisibility: true, // required for olapic logic\n\t\t\t\t\t\t\t\t\trunCallbacksOnInit: false, // required for olapic logic\n\t\t\t\t\t\t\t\t\tonSlideChangeEnd: function(){olapic.analytics.olapicScrollEventAnalytics(olapicElmObj, $this);} // required for olapic logic\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t// init ADA\n\t\t\t\t\t\tapp.carousel.init( $(\x22#\x22 + photoModalCarouselId) );\n\t\t\t\t\t}\n\t\t\t\t\tolapic.analytics.initPhotoModalAnalytics(olapicElmObj, $this, index);\n\t\t\t\t\t\n\t\t\t\t\tolapic.photoModalOverlay.initPhotoModalFlag(olapicElmObj, $this, carouselElemId, index);\n\t\t\t\n\n\t\t\t\t\t$(\x27.olapic-photo-modal .overlay-container\x27).focus();\n\t\t\t\n\t\t\t\t\t// if mobile/tablet scroll to top to see overlay\n\t\t\t\t\t// this is due to CSS positioning differences between\n\t\t\t\t\t/// desktop and mobile \n\t\t\t\t\tif(window.innerWidth \x3c\x3d 960){\n\t\t\t\t\t\t$(\x27body\x27).scrollTop(0);\n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t// prev/next events\n\t\t\t\t\t$(\x27.overlay-arrow div\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\tvar switchNum \x3d 0;\n\t\t\t\t\t\t\tif($(this).parent().hasClass(\x27overlay-prev\x27)){\n\t\t\t\t\t\t\t\tolapic.photoModalOverlay.switchPhotoModal(olapicElmObj, $this, carouselElemId, -1);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tolapic.photoModalOverlay.switchPhotoModal(olapicElmObj, $this, carouselElemId, 1);\n\t\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\n\t\t\t\t\t// close model events\n\t\t\t\t\t$(\x27.olapic-photo-modal.overlay, .olapic-photo-modal.overlay-gray, .olapic-photo-modal .overlay-close-button, .olapic-photo-modal .overlay-close-button span, .olapic-photo-modal .overlay-close, .olapic-photo-modal .overlay-close span\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\t// we use e.target to prevent bubble up event on wrong element so \x3c\x3c \x3e\x3e work properly\n\t\t\t\t\t\tif($(e.target).is(\x27.olapic-photo-modal.overlay, .olapic-photo-modal.overlay-gray, .olapic-photo-modal .overlay-close-button, .olapic-photo-modal .overlay-close-button span, .olapic-photo-modal .overlay-close, .olapic-photo-modal .overlay-close span\x27) \x26\x26 (e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32))){\n\t\t\t\t\t\t\tolapic.photoModalOverlay.closePhotoModal(olapicElmObj, $this);\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t\t$(\x27body\x27).on(\x27keyup\x27, function(e){\n\t\t\t\t\t\tif(e.keyCode \x3d\x3d\x3d 27){\n\t\t\t\t\t\t\tolapic.photoModalOverlay.closePhotoModal(olapicElmObj, $this);\n\t\t\t\t\t\t}\t\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t},\n\t\t\n\t\t\t\tgetPhotoModalHtml : function(olapicElmObj, $this, carouselElemId, index){\n\t\t\t\t\tvar html \x3d \x27\x27,\n\t\t\t\t\t\tmediaId \x3d olapicElmObj.mediaIdArr[index],\n\t\t\t\t\t\tcurrentPhotoData \x3d olapicElmObj.mediaObj[mediaId],\n\t\t\t\t\t\tproductImageUrl \x3d currentPhotoData.images \x26\x26 currentPhotoData.images.normal ? currentPhotoData.images.normal : \x27\x27,\n\t\t\t\t\t\tsourceUrl \x3d currentPhotoData.original_source ? currentPhotoData.original_source : \x27\x27,\n\t\t\t\t\t\tprofileImageUrl \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.avatar_url ? currentPhotoData._embedded.uploader.avatar_url : \x27\x27,\n\t\t\t\t\t\tprofileName \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.name ? currentPhotoData._embedded.uploader.name : \x27\x27,\n\t\t\t\t\t\tprofileHandle \x3d currentPhotoData._embedded \x26\x26 currentPhotoData._embedded.uploader \x26\x26 currentPhotoData._embedded.uploader.username ? currentPhotoData._embedded.uploader.username : \x27\x27,\n\t\t\t\t\t\tcaption \x3d currentPhotoData.caption ? currentPhotoData.caption : \x27\x27,\n\t\t\t\t\t\tshareUrl \x3d currentPhotoData.share_url ? currentPhotoData.share_url : \x27\x27,\n\t\t\t\t\t\tprofileIconUrl \x3d \x27\x27,\n\t\t\t\t\t\tprofileIconText \x3d \x27\x27,\n\t\t\t\t\t\tphotoDetailsModalText \x3d olapicMsgs \x26\x26 olapicMsgs.photoDetailsModal ? olapicMsgs.photoDetailsModal : \x27photo details modal\x27,\n\t\t\t\t\t\tcloseText \x3d olapicMsgs \x26\x26 olapicMsgs.close ? olapicMsgs.close : \x27close\x27;\n\t\t\t\t\t\tnextText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel \x26\x26 app.config.msgs.carousel.nextitem ? app.config.msgs.carousel.nextitem : \x27next item\x27,\n\t\t\t\t\t\tprevText \x3d app \x26\x26 app.config \x26\x26 app.config.msgs \x26\x26 app.config.msgs.carousel \x26\x26 app.config.msgs.carousel.previousitem ? app.config.msgs.carousel.previousitem : \x27previous item\x27,\n\t\t\t\t\t\tprofileImageText \x3d olapicMsgs \x26\x26 olapicMsgs.profileImage ? olapicMsgs.profileImage : \x27profile image\x27,\n\t\t\t\t\t\tflagFormTitleText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormTitle ? olapicMsgs.flagPhotoFormTitle : \x27Report Photo\x27;\n\t\t\t\n\t\t\t\t\tswitch (currentPhotoData.source) {\n\t\t\t\t\t  case \x27instagram\x27:\n\t\t\t\t\t\tprofileIconUrl \x3d instagramIconUrl;\n\t\t\t\t\t\tprofileIconText \x3d \x27instagram\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27twitter\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d twitterIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27twitter\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27facebook\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d facebookIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27facebook\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  case \x27pinterest\x27:\n\t\t  \t\t\t\tprofileIconUrl \x3d pinterestIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27pinterest\x27; \n\t\t\t\t\t    break;\n\t\t\t\t\t  default:\n\t\t  \t\t\t\tprofileIconUrl \x3d genericIconUrl;\n\t\t  \t\t\t\tprofileIconText \x3d \x27crocs\x27; \n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\thtml \x3d html + \x27\x3cdiv class\x3d\x22olapicCarousel olapic-photo-modal overlay\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\x27\x3cdiv role\x3d\x22dialog\x22 tabindex\x3d\x220\x22 aria-label\x3d\x22\x27+photoDetailsModalText+\x27\x22 class\x3d\x22overlay-container\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3cdiv class\x3d\x22overlay-arrow overlay-prev\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cdiv tabindex\x3d\x220\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cspan class\x3d\x22sr-only\x22\x3e\x27+prevText+\x27\x3c/span\x3e\x27; //  \x3c!-- aria --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26lsaquo;\x3c/span\x3e\x27; //  \x3c!-- aria --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3cdiv class\x3d\x22overlay-content\x22 data-index\x3d\x22\x27+index+\x27\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cbutton type\x3d\x22button\x22 class\x3d\x22overlay-close-button  medButton\x22\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x27+closeText+\x27  \x26#215;\x3c/span\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+closeText+\x27\x3c/span\x3e\x3c/button\x3e\x27;\t\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cdiv class\x3d\x22pic-container\x22 style\x3d\x22background-image:url(\x27+productImageUrl+\x27);\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cbutton role\x3d\x22link\x22 type\x3d\x22button\x22 class\x3d\x22pic-flag\x22 title\x3d\x22\x27+flagFormTitleText+\x27\x22\x3e\x3c/button\x3e\x27; // \x3c!-- aria, text--\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cdiv class\x3d\x22overlay-details\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cdiv class\x3d\x22overlay-close\x22 role\x3d\x22button\x22 tabindex\x3d\x220\x22\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26#215;\x3c/span\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+closeText+\x27\x3c/span\x3e\x3c/div\x3e\x27; // \x3c!-- aria --\x3e\n\t\t\t\t\tif(profileIconText \x3d\x3d\x3d \x27crocs\x27){\n\t\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cdiv class\x3d\x22overlay-profile\x22\x3e\x27;\n\t\t\t\t\t}else{\n\t\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3ca target\x3d\x22_blank\x22 class\x3d\x22overlay-profile\x22 href\x3d\x22\x27+ sourceUrl +\x27\x22\x3e\x27;\n\t\t\t\t\t}\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\x27\x3cimg src\x3d\x22\x27+ profileImageUrl +\x27\x22 class\x3d\x22profile-img\x22 alt\x3d\x22\x27+profileImageText+\x27\x22 width\x3d\x2290px\x22 height\x3d\x2290px\x22\x3e\x27; // \x3c!-- aria, alt --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\x27\x3cimg src\x3d\x22\x27+profileIconUrl+\x27\x22 class\x3d\x22profile-icon--sm\x22 alt\x3d\x22\x27+profileIconText+\x27\x22 width\x3d\x2230px\x22 height\x3d\x2230px\x22\x3e\x27; // \x3c!-- aria, alt --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\x27\x3cdiv class\x3d\x22profile-names\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\t\x27\x3cspan class\x3d\x22profile-name_real\x22\x3e\x27+profileName+\x27\x3c/span\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\t\x27\x3cbr\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\t\x27\x3cspan class\x3d\x22profile-name_handle\x22\x3e\x27+profileHandle+\x27\x3c/span\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\tif(profileIconText \x3d\x3d\x3d \x27crocs\x27){\n\t\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\t}else{\n\t\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/a\x3e\x27;\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cdiv class\x3d\x22overlay-description\x22\x3e\x27+caption+\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cdiv class\x3d\x22overlay-description-fadeout\x22\x3e\x3c/div\x3e\x27;\t\t\t\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cdiv class\x3d\x22overlay-social-icons\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\t\x27\x3cdiv class\x3d\x22overlay-share-text\x22\x3e\x27+olapicMsgs.share+\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html +\t\t\t\t\t\tolapic.utils.getShareLinks(shareUrl,productImageUrl);\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cdiv class\x3d\x22clear\x22\x3e\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\tolapic.photoModalOverlay.getPhotoModalCarousel(olapicElmObj, $this, carouselElemId, index);\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3cdiv class\x3d\x22overlay-arrow overlay-next\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3cdiv tabindex\x3d\x220\x22\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cspan class\x3d\x22sr-only\x22\x3e\x27+nextText+\x27\x3c/span\x3e\x27; //  \x3c!-- aria --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\t\x27\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26rsaquo;\x3c/span\x3e\x27; //  \x3c!-- aria --\x3e\n\t\t\t\t\thtml \x3d html + \t\t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \t\x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \x27\x3c/div\x3e\x27;\n\t\t\t\t\thtml \x3d html + \x27\x3cdiv class\x3d\x22olapicCarousel olapic-photo-modal overlay-gray\x22\x3e\x27;\n\t\t\t\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\n\t\t\t\taddProductToPhotoModalCarouselUl : function(currentObj, $ul){\n\t\t\t\t\t// separate pid and cid (e.g. 10001 or 10001_57H)\n\t\t\t\t\t// provided URL already has info we need, commenting out\n\t\t\t\t\t/*\n\t\t\t\t\tvar pidAndCid \x3d currentObj.tag_based_key,\n\t\t\t\t\t\tpid,\n\t\t\t\t\t\tcid;\n\t\t\t\t\tif(pidAndCid){\n\t\t\t\t\t\tif(/_/.test(pidAndCid)){\n\t\t\t\t\t\t\tvar pidCidArr \x3d pidAndCid.split(\x27_\x27);\n\t\t\t\t\t\t\tpid \x3d pidCidArr[0];\n\t\t\t\t\t\t\tcid \x3d pidCidArr[1];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tpid \x3d pidAndCid;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\tvar pName \x3d currentObj.name,\n\t\t\t\t\t\tpUrl \x3d currentObj.product_url,\n\t\t\t\t\t\tpImg \x3d currentObj._embedded.base_image.images.mobile;\n\t\t\t\t\t$ul.append(\x27\x3cli tabindex\x3d\x220\x22 class\x3d\x22swiper-slide iscroll_item-container\x22\x3e\x3ca class\x3d\x22iscroll_item\x22 href\x3d\x22\x27+pUrl+\x27\x22\x3e\x3cimg src\x3d\x22\x27+pImg+\x27\x22 width\x3d\x22140\x22 height\x3d\x2287\x22 alt\x3d\x22\x22 /\x3e\x3cdiv\x3e\x27+pName+\x27\x3c/div\x3e\x3c/a\x3e\x3c/li\x3e\x27);\n\t\t\t\t},\n\n\t\t\t\tgetPhotoModalCarousel : function(olapicElmObj, $this, carouselElemId, index) {\n\t\t\t\t\tvar photoMediaId \x3d $this.find(\x27div[data-oindex\x3d\x22\x27+index+\x27\x22]\x27).attr(\x27data-oid\x27),\n\t\t\t\t\t\tphotoMedia \x3d olapicElmObj.mediaObj[photoMediaId],\n\t\t\t\t\t\t$html \x3d $(olapic.utils.getCarouselHtml(carouselElemId + \x27_modal\x27)),\n\t\t\t\t\t\thasVariants \x3d false,\n\t\t\t\t\t\tnumOfProducts \x3d 0,\n\t\t\t\t\t\t$ul \x3d $(\x27\x3cul class\x3d\x22swiper-wrapper\x22 aria-live\x3d\x22polite\x22\x3e\x3c/ul\x3e\x27),\n\t\t\t\t\t\toverlayPhotoData \x3d olapicElmObj.overlayPhotoData ? olapicElmObj.overlayPhotoData : olapicElmObj.overlayPhotoData \x3d [];\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x22getPhotoModalCarousel\x22,index,carouselElemId,photoMediaId,photoMedia);\n\t\t\t\t\t\n\t\t\t\t\tif(!overlayPhotoData[index]){\n\t\t\t\t\t\toverlayPhotoData[index] \x3d [];\n\t\t\t\t\t}\n\t\t\t\t\t// Put all valid product streams into public obj.\n\t\t\t\t\t$.each(photoMedia._embedded[\x27streams:all\x27]._embedded.stream, function(itrIndex){\n\t\t\t\t\t\tvar currentObj \x3d this;\n\t\t\t\n\t\t\t\t\t\t// skip if not a product\n\t\t\t\t\t\tif (olapic.utils.isValidProductStream(currentObj)){\n\t\t\t\t\t\n\t\t\t\t\t\t\tvar pidAndCid \x3d currentObj.tag_based_key,\n\t\t\t\t\t\t\t\tidArr \x3d [];\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// add to public data streams related to this photo (valid products with photos)\n\t\t\t\t\t\t\t// don\x27t push data if already exists\n\t\t\t\t\t\t\tif(overlayPhotoData[index].length){\n\t\t\t\t\t\t\t\t$.each(overlayPhotoData[index], function(){\n\t\t\t\t\t\t\t\t\tidArr.push(this.id.toString());\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(idArr.indexOf(currentObj.id.toString()) \x3c 0){\n\t\t\t\t\t\t\t\toverlayPhotoData[index].push(currentObj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\t\tif(/_/.test(pidAndCid)){\n\t\t\t\t\t\t\t\thasVariants \x3d true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t}); // each\n\t\t\t\n\t\t\t\t\t// if no product variants, use first master product, otherwise append only variant product(s)\n\t\t\t\t\tif(hasVariants){\n\t\t\t\t\t\t// append only variants\n\t\t\t\t\t\t$.each(overlayPhotoData[index], function(){\n\t\t\t\t\t\t\tif(/_/.test(this.tag_based_key)){\n\t\t\t\t\t\t\t\tolapic.photoModalOverlay.addProductToPhotoModalCarouselUl(this, $ul);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}else if(overlayPhotoData[index].length){\n\t\t\t\t\t\t// use first master\n\t\t\t\t\t\tvar currentObj \x3d overlayPhotoData[index][0];\n\t\t\t\t\t\tolapic.photoModalOverlay.addProductToPhotoModalCarouselUl(currentObj, $ul);\n\t\t\t\t\t}\n\n\t\t\t\t\t// add index, necessary for analytics\n\t\t\t\t\t$.each($ul.find(\x27.iscroll_item\x27),function(index){\n\t\t\t\t\t\tnumOfProducts \x3d numOfProducts + 1;\n\t\t\t\t\t\t$(this).attr(\x27data-index\x27, index);\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\tif(overlayPhotoData \x26\x26 overlayPhotoData[index] \x26\x26 overlayPhotoData[index].length){\n\t\t\t\t\t\t$html.find(\x27.sidePrev\x27).after($ul);\n\t\t\t\t\n\t\t\t\t\t\t// if only one or two products, no carousel needed\n\t\t\t\t\t\tif(numOfProducts \x3c 3){\n\t\t\t\t\t\t\tvar $ul \x3d $html.find(\x27ul\x27),\n\t\t\t\t\t\t\t\tclassName \x3d \x27two-products\x27;\n\t\t\t\t\t\t\tif(numOfProducts \x3d\x3d\x3d 1){\n\t\t\t\t\t\t\t\tclassName \x3d \x22one-product\x22;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn (\x27\x3cdiv class\x3d\x22overlay-shoppable\x22\x3e\x3cdiv class\x3d\x22overlay-shop-text\x22\x3e\x27+olapicMsgs.shopSimilarLooks+\x27\x3c/div\x3e\x3cdiv class\x3d\x22overlay-carousel-container \x27+ className +\x27\x22\x3e\x27 + $ul[0].outerHTML + \x27\x3c/div\x3e\x3c/div\x3e\x27);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\treturn (\x27\x3cdiv class\x3d\x22overlay-shoppable\x22\x3e\x3cdiv class\x3d\x22overlay-shop-text\x22\x3e\x27+olapicMsgs.shopSimilarLooks+\x27\x3c/div\x3e\x3cdiv class\x3d\x22overlay-carousel-container\x22\x3e\x27 + $html[1].outerHTML + \x27\x3c/div\x3e\x3c/div\x3e\x27);\n\t\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn \x27\x3cdiv class\x3d\x22overlay-shoppable\x22\x3e\x3c/div\x3e\x27;\n\t\t\t\t\t}\n\t\t\t\n\t\t\t\t}, // getPhotoModalCarousel\n\t\t\t\t\n\t\t\t\tswitchPhotoModal : function(olapicElmObj, $this, carouselElemId, num){\n\t\t\t\t\tvar currentPhotoModalIndex \x3d Number($(\x27.olapic-photo-modal .overlay-content\x27).attr(\x27data-index\x27)),\n\t\t\t\t\t\tcurrentPhotoDataLength \x3d $this.find(\x27.iscroll_item, .photowall-item\x27).length,\n\t\t\t\t\t\tnewIndex \x3d 0,\n\t\t\t\t\t\t$newPhotoData,\n\t\t\t\t\t\tnumber \x3d Number(num),\n\t\t\t\t\t\tphotoModalCarouselId \x3d carouselElemId + \x27_modal\x27;\n\t\t\t\t\n\t\t\t\t\tif( number \x3c 0 \x26\x26 currentPhotoModalIndex \x3d\x3d\x3d 0 ){ // clicked prev on first image\n\t\t\t\t\t\tnewIndex \x3d currentPhotoDataLength - 1;\n\t\t\t\t\t}else if ( number \x3e 0 \x26\x26 currentPhotoModalIndex + 1 \x3d\x3d\x3d currentPhotoDataLength){ // clicked next on last image\n\t\t\t\t\t\tnewIndex \x3d 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnewIndex \x3d ( Number(currentPhotoModalIndex) + number );\n\t\t\t\t\t}\n\n\t\t\t\t\t// TODO we need to pass which carousel? Seems unnecessary...\n\t\t\t\t\t$newPhotoData \x3d $(olapic.photoModalOverlay.getPhotoModalHtml(olapicElmObj, $this, carouselElemId, newIndex));\n\t\t\t\n\t\t\t\t\t// remove shop similar text if no products\t\n\t\t\t\t\tif(!$newPhotoData.find(\x27.iscroll_item\x27).length){\n\t\t\t\t\t\t$newPhotoData.find(\x27.overlay-shop-text\x27).remove();\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\x27.overlay-profile\x27).replaceWith($newPhotoData.find(\x27.overlay-profile\x27));\n\t\t\t\t\t$(\x27.pic-container\x27).replaceWith($newPhotoData.find(\x27.pic-container\x27));\n\t\t\t\t\t$(\x27.overlay-description\x27).replaceWith($newPhotoData.find(\x27.overlay-description\x27));\n\t\t\t\t\t$(\x27.overlay-social-icons\x27).replaceWith($newPhotoData.find(\x27.overlay-social-icons\x27));\n\t\t\t\t\t$(\x27.overlay-shoppable\x27).replaceWith($newPhotoData.find(\x27.overlay-shoppable\x27));\n\t\t\t\t\t$(\x27.olapic-photo-modal .overlay-content\x27).attr(\x27data-index\x27, newIndex);\n\t\t\t\t\t\n\t\t\t\t\tolapic.photoModalOverlay.initPhotoModalFlag(olapicElmObj, $this, carouselElemId, newIndex);\n\t\t\t\n\t\t\t\t\t// if photo modal product carousel, init events\n\t\t\t\t\tif($(\x27#\x27+ photoModalCarouselId).length){\n\t\t\t\t\t\t// remove existing (old) public reference\n\t\t\t\t\t\tdelete app.carousel.carousels[photoModalCarouselId];\n\t\t\t\t\n\t\t\t\t\t\t// init, create carousel\n\t\t\t\t\t\tvar thisModalSwiper \x3d app.carousel.carousels[photoModalCarouselId] \x3d new Swiper (\x27#\x27 + photoModalCarouselId, {\n\t\t\t\t\t\t\t\t\ta11y: true, // keep, built in ADA\n\t\t\t\t\t\t\t\t\tnextButton: \x27.sideNext\x27, // keep\n\t\t\t\t\t\t\t\t\tprevButton: \x27.sidePrev\x27, // keep\n\t\t\t\t\t\t\t\t\troundLengths: true, // keep\n\t\t\t\t\t\t            freeMode: true,\n\t\t\t\t\t\t            slidesPerView: \x27auto\x27, // li needs set width\n\t\t\t\t\t\t            spaceBetween: 10, // adjust as needed\n\t\t\t\t\t\t\t\t\twatchSlidesVisibility: true, // required for olapic logic\n\t\t\t\t\t\t\t\t\trunCallbacksOnInit: false, // required for olapic logic\n\t\t\t\t\t\t\t\t\tonSlideChangeEnd: function(){olapic.analytics.olapicScrollEventAnalytics(olapicElmObj, $this);}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t// init ADA\n\t\t\t\t\t\tapp.carousel.init( $(\x22#\x22 + photoModalCarouselId) );\n\t\t\t\t\t\t\n\t\t\t\t\t\tolapic.analytics.initPhotoModalCarouselAnalytics(olapicElmObj, $this, newIndex);\n\t\t\t\t\t}\n\t\t\t\t\tolapic.analytics.movePhotoModalAnalyticApi(olapicElmObj, currentPhotoModalIndex, newIndex);\n\t\t\t\t},\n\n\t\t\t\tinitPhotoModalFlag : function(olapicElmObj, $this, carouselElemId, index){\n\t\t\t\t\t$(\x27.pic-flag\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\tolapic.photoModalOverlay.initPhotoModalFlagForm(olapicElmObj, $this, carouselElemId, index);\t\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tinitPhotoModalFlagForm : function(olapicElmObj, $this, carouselElemId, index){\n\t\t\t\t\tvar mediaId \x3d olapicElmObj.mediaIdArr[index],\n\t\t\t\t\t\tcurrentObj \x3d olapicElmObj.mediaObj[mediaId]._forms.report,\n\t\t\t\t\t\tflagFormSubmitHtml \x3d \x27\x27,\n\t\t\t\t\t\tflagFormSentHtml \x3d \x27\x27,\n\t\t\t\t\t\tflagFormTitleText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormTitle ? olapicMsgs.flagPhotoFormTitle : \x27Report Photo\x27,\n\t\t\t\t\t\tflagFormMessageText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormMsg ? olapicMsgs.flagPhotoFormMsg : \x27Please state reason you would like this photo removed.\x27,\n\t\t\t\t\t\tflagFormEmailText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormEmail ? olapicMsgs.flagPhotoFormEmail : \x27email\x27,\n\t\t\t\t\t\tflagFormReasonText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormReason ? olapicMsgs.flagPhotoFormReason : \x27reason\x27,\n\t\t\t\t\t\tflagFormCancelText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormCancel ? olapicMsgs.flagPhotoFormCancel : \x27cancel\x27,\n\t\t\t\t\t\tflagFormSubmitText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormSubmit ? olapicMsgs.flagPhotoFormSubmit : \x27submit\x27,\n\t\t\t\t\t\tflagFormSentText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormSentMsg ? olapicMsgs.flagPhotoFormSentMsg : \x27Thank you, your submission has been sent.\x27,\n\t\t\t\t\t\tflagFormErrorText \x3d olapicMsgs \x26\x26 olapicMsgs.flagPhotoFormErrorMsg ? olapicMsgs.flagPhotoFormErrorMsg : \x27An error has occured, please try again soon.\x27,\n\t\t\t\t\t\tflagImageText \x3d olapicMsgs \x26\x26 olapicMsgs.flagImage ? olapicMsgs.flagImage : \x27flag image form\x27,\n\t\t\t\t\t\tcloseText \x3d olapicMsgs \x26\x26 olapicMsgs.close ? olapicMsgs.close : \x27close\x27;\n\t\t\t\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\x3cdiv role\x3d\x22dialog\x22 aria-label\x3d\x22\x27+flagImageText+\x27\x22 id\x3d\x22flag-photo-form\x22 class\x3d\x22flag-form-container cx-brand-font\x22\x3e\x27;\t//\x3c!-- aria --\x3e\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\x3cdiv tabindex\x3d\x220\x22 class\x3d\x22flag-form-close\x22\x3e\x3cspan aria-hidden\x3d\x22true\x22\x3e\x26#215;\x3c/span\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+closeText+\x27\x3c/span\x3e\x3c/div\x3e\x27; //\x3c!-- aria --\x3e\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\x3cdiv class\x3d\x22flag-form\x22\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3cdiv class\x3d\x22flag-form-title\x22\x3e\x27+flagFormTitleText+\x27\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3cdiv class\x3d\x22flag-form-message\x22\x3e\x27+flagFormMessageText+\x27\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3cdiv class\x3d\x22flag-form-email\x22\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\t\x3clabel for\x3d\x22flag-form-email-input\x22\x3e\x27+flagFormEmailText+\x27\x3c/label\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\t\x3cinput type\x3d\x22email\x22 id\x3d\x22flag-form-email-input\x22 name\x3d\x22\x27+currentObj.fields[0].name+\x27\x22 /\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3cdiv class\x3d\x22flag-form-reason\x22\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\t\x3clabel for\x3d\x22flag-form-reason-input\x22\x3e\x27+flagFormReasonText+\x27\x3c/label\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\t\x3ctextarea id\x3d\x22flag-form-reason-input\x22 name\x3d\x22\x27+currentObj.fields[1].name+\x27\x22 \x3e\x3c/textarea\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\t\x3cdiv class\x3d\x22flag-form-actions\x22\x3e\x3cbutton type\x3d\x22button\x22 class\x3d\x22flag-form-submit medButton\x22\x3e\x3cspan class\x3d\x22whiteText\x22\x3e\x27+flagFormSubmitText+\x27\x3c/span\x3e\x3c/button\x3e\x3cbutton type\x3d\x22button\x22 class\x3d\x22flag-form-cancel  medButton\x22\x3e\x3cspan class\x3d\x22whiteText\x22\x3e\x27+flagFormCancelText+\x27\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\t\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSubmitHtml \x3d flagFormSubmitHtml + \x27\x3c/div\x3e\x27;\n\t\t\n\t\t\t\t\tflagFormSentHtml \x3d flagFormSentHtml + \x27\x3cdiv role\x3d\x22dialog\x22 aria-label\x3d\x22\x27+flagFormSentText+\x27\x22 class\x3d\x22flag-form-sent\x22\x3e\x27;\n\t\t\t\t\tflagFormSentHtml \x3d flagFormSentHtml + \x27\t\x3cdiv class\x3d\x22flagFormSentText\x22\x3e\x27+flagFormSentText+\x27\x3c/div\x3e\x27;\n\t\t\t\t\tflagFormSentHtml \x3d flagFormSentHtml + \x27\x3c/div\x3e\x27;\n\t\t\n\t\t\t\t\t// add form to DOM\n\t\t\t\t\t$(\x27.pic-container\x27).html($(flagFormSubmitHtml));\n\t\t\t\t\t$(\x27#flag-form-email-input\x27).focus();\n\t\t\t\n\t\t\t\t\t// submit form\n\t\t\t\t\t$(\x27.flag-form-submit\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t$.ajax({  \n\t\t\t\t\t\t\t\ttype: currentObj.method,\n\t\t\t\t\t\t\t\turl: (currentObj.action.href + \x27?\x27+currentObj.fields[0].name+\x27\x3d\x27+encodeURIComponent($(\x27#flag-form-email-input\x27).val())+\x27\x26\x27+currentObj.fields[1].name+\x27\x3d\x27+encodeURIComponent($(\x27#flag-form-reason-input\x27).val())+\x27\x26\x27+currentObj.fields[2].name+\x27\x3d\x27+currentObj.fields[2].value)+\x27\x26auth_token\x3d\x27 + apiKey,\n\t\t\t\t\t\t\t\tsuccess: function (data) {\n\t\t\t\t\t\t\t\t\t$(\x27.flag-form\x27).remove();\n\t\t\t\t\t\t\t\t\t$(\x27.flag-form-container\x27).append($(flagFormSentHtml));\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\terror: function(error) {\n\t\t\t\t\t\t\t\t\tvar $errorHtml \x3d $(flagFormSubmitHtml);\n\t\t\t\t\t\t\t\t\t$errorHtml.find(\x27.flagFormSentText\x27).text(flagFormErrorText);\n\t\t\t\t\t\t\t\t\t$errorHtml.find(\x27.flagFormSentText\x27).parent().attr(\x27aria-label\x27,flagFormErrorText);\n\t\t\t\t\t\t\t\t\t$(\x27.flag-form\x27).remove();\n\t\t\t\t\t\t\t\t\t$(\x27.flag-form-container\x27).append($errorHtml);\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t });\t\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t// close form event\n\t\t\t\t\t$(\x27.flag-form-close, .flag-form-close *, .flag-form-cancel\x27).on(\x27click keyup\x27,function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\t$(\x27.flag-form-container\x27).remove();\t\n\t\t\t\t\t\t\t// put back flag\n\t\t\t\t\t\t\t$(\x27.pic-container\x27).append($(\x27\x3cbutton type\x3d\x22button\x22 class\x3d\x22pic-flag\x22 title\x3d\x22\x27+flagImageText+\x27\x22\x3e\x3c/button\x3e\x27));\n\t\t\t\t\t\t\t$(\x27.pic-flag\x27).focus();\n\t\t\t\t\t\t\tolapic.photoModalOverlay.initPhotoModalFlag(olapicElmObj, $this, carouselElemId, index);\n\t\t\t\t\t\t}\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tclosePhotoModal : function(olapicElmObj, $this){\n\t\t\t\t\tvar index \x3d $(\x27.olapic-photo-modal .overlay-content\x27).attr(\x27data-index\x27),\n\t\t\t\t\t\t$firstCarouselItem \x3d $this.find(\x22.iscroll_item[data-oindex\x3d\x27\x22 + index + \x22\x27]\x22);\n\t\t\t\t\t$firstCarouselItem.focus();\n\t\t\t\t\t$(\x27.olapic-photo-modal\x27).remove();\n\t\t\t\t\tolapic.analytics.closePhotoModalAnalyticApi(olapicElmObj, index);\n\t\t\t\t},\n\t\t\t\t\t\t\n\t\t\t}, // photoModalOverlay\n\t\t\t\n\t\t\t// olapic.analytics\n\t\t\tanalytics : {\n\t\t\t\n\t\t\t\tnotFoundAnalyticApi : function(){\n\t\t\t\t\t\t// USED ON AJAX ERROR ATTEMPT\n\t\t\t\t\t\t// EVENT: widget stream not found\n\t\t\t\t\t\t//\tAPI: Stream not found\n\t\t\t\t\t\t// track/widget/{instance_id}/stream/not_found/render{format}{?analytics_id,ab_testing,segments}\n\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/stream/not_found/render\x27 + analyticFormat + analyticParams + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: widget stream not found | Analytic API: Stream not found\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t},\n\t\t\t\n\t\t\t\tinitPhotoModalCarouselAnalytics : function(olapicElmObj, $this, index){\n\t\t\t\t\tvar id \x3d olapicElmObj.overlayPhotoData ? olapicElmObj.overlayPhotoData[index][$(this).attr(\x27data-index\x27)].id : app.config.olapic.modal.itemMedia.id;\n\t\t\t\t\tvar len \x3d olapicElmObj.overlayPhotoData ? olapicElmObj.overlayPhotoData[index].length : $(\x27.js-olapic-product\x27).length;\n\t\t\t\n\t\t\t\t\t$(\x27.olapic-photo-modal .iscroll_item, .js-olapic-pdp .js-product-add-to-cart button\x27).on(\x27click keyup\x27, function(e){\n\t\t\t\t\t\t// EVENT: shoppable modal photo clicked *\n\t\t\t\t\t\t// API: \x22Shop This Product\x22\n\t\t\t\t\t\t// /track/widget/{instance_id}/best/media/{media_id}/shop{format}{?analytics_id,pics,ab_testing,redirect_url,segments}\n\t\t\t\t\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + id + \x27/shop\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + len + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\t\t\tolapic.utils.log(\x27EVENT: shoppable modal photo clicked | Analytic API: \x22Shop This Product\x22\x27,url);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tolapic.utils.ajaxReq(url, null);\t\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tinitPhotoModalAnalytics : function(olapicElmObj, $this, index){\n\t\t\t\t\tvar mediaId \x3d olapicElmObj.mediaIdArr[index],\n\t\t\t\t\t\tcurrentPhotoData \x3d olapicElmObj.mediaObj[mediaId],\n\t\t\t\t\t\turl \x3d \x27\x27;\n\t\t\t\t\t//\tEVENT: widget photo clicked\n\t\t\t\t\t//\t\tAPI: Media Click\n\t\t\t\t\t//\tEVENT: modal opens\n\t\t\t\t\t//\t\tAPI: Media View\n\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + currentPhotoData.id + \x27/click\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d1\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: widget photo clicked | Analytic API: Media Click\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + currentPhotoData.id + \x27/view\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d1\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: modal opens | Analytic API: Media View\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\n\t\t\t\t\tolapic.analytics.initPhotoModalCarouselAnalytics(olapicElmObj, $this, index);\n\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tmovePhotoModalAnalyticApi : function(olapicElmObj, origIndex, newIndex){\n\t\t\t\t\tvar origMediaId \x3d olapicElmObj.mediaIdArr[origIndex],\n\t\t\t\t\t\tnewMediaId \x3d olapicElmObj.mediaIdArr[newIndex],\n\t\t\t\t\t\torigPhotoData \x3d olapicElmObj.mediaObj[origMediaId],\n\t\t\t\t\t\tnewPhotoData \x3d olapicElmObj.mediaObj[newMediaId],\n\t\t\t\t\t\turl;\n\n\t\t\t\t\t//\tEVENT: modal Next/Prev \x3c\x3c\x3e\x3e clicked\n\t\t\t\t\t//\t\tAPI: Media Move\n\t\t\t\t\t//\tEVENT: new modal content shows\n\t\t\t\t\t//\t\tAPI: Media View\n\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + origPhotoData.id + \x27/move\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d1\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: modal Next/Prev \x3c\x3c\x3e\x3e clicked | Analytic API: Media Move\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + newPhotoData.id + \x27/view\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d1\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\tolapic.utils.log(\x27EVENT: new modal content shows | Analytic API: Media View\x27,url);\n\t\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tclosePhotoModalAnalyticApi : function(olapicElmObj, index){\n\t\t\t\t\tvar mediaId \x3d olapicElmObj.mediaIdArr[index],\n\t\t\t\t\t\tcurrentPhotoData \x3d olapicElmObj.mediaObj[mediaId];\n\t\t\t\t\t//\tEVENT: modal closed\n\t\t\t\t\t//\t\tAPI: Media Close Event\n\t\t\t\t\t// TODO verify pics should equal 1, I can\x27t remember why but I believe that is correct\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + currentPhotoData.id + \x27/close\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d1\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: modal closed | Analytic API: Media Close Event\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tuploadAnalyticApi : function(olapicElmObj, $this) {\n\t\t\t\t\t\t// EVENT: upload clicked *\n\t\t\t\t\t\t//\tAPI: Widget upload_click\n\t\t\t\t\tvar url \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/upload_click\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + $this.find(\x27.iscroll_item\x27).length + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: upload clicked | Analytic API: Widget upload_click\x27,url);\n\t\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetCurrentItemIds : function($this){\n\t\t\t\t\t\tvar olapicMediaIds \x3d [],\n\t\t\t\t\t\t\titems \x3d $this.find(\x27.swiper-slide-visible .iscroll_item, .photowall-item\x27);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(items,function(index){\n\t\t\t\t\t\t\tolapicMediaIds.push( $(items[index]).attr(\x27data-oid\x27) );\n\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\treturn olapicMediaIds.join(\x27,\x27);\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetCurrentItemIndices : function($this){\n\t\t\t\t\t\tvar olapicItemIndices \x3d [],\n\t\t\t\t\t\t\titems \x3d $this.find(\x27.swiper-slide-visible .iscroll_item, .photowall-item\x27);\n\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(items,function(index){\n\t\t\t\t\t\t\tolapicItemIndices.push( $(items[index]).attr(\x27data-oindex\x27) );\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar lastIndex \x3d olapicItemIndices.length \x3e 1 ? \x27-\x27+olapicItemIndices[olapicItemIndices.length-1] : \x27\x27;\n\t\t\t\t\t\treturn olapicItemIndices[0]+lastIndex;\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tolapicScrollEventAnalytics : function(olapicElmObj, $this){\n\t\t\t\t\tvar url \x3d \x27\x27,\n\t\t\t\t\tcurrentItemIds \x3d olapic.analytics.getCurrentItemIds($this),\n\t\t\t\t\tcurrentItemIdsCount \x3d $this.find(\x27.iscroll_item, .photowall-item\x27).length;\n\n\t\t\t\t\t\t// EVENT: widget Next/Prev \x3c\x3c\x3e\x3e clicked\n\t\t\t\t\t\t// API: Widget Move\n\t\t\t\t\t\t// EVENT: New Widget Content Scrolls into view\n\t\t\t\t\t\t// API: Media Render\n\t\t\t\t\t\t// API: Widget View (optional)\n\n\t\t\t\t\t// On carousel arrow click \x22widget move\x22...\n\t\t\t\t\t// http://data.photorank.me/track/widget/41d0ca9a88638f4fdb06d532fdd0d980/best/move.gif?analytics_id\x3d1462812884780\x26pics\x3d20\x26auth_token\x3db96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x26trand\x3d1462850119879\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/move\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\tolapic.utils.log(\x27EVENT: widget Next/Prev \x3c\x3c\x3e\x3e clicked | Analytic API: Widget Move\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\n\t\t\t\t\t// followed by \x22 media render\x22 are triggered\n\t\t\t\t\t// http://data.photorank.me/track/widget/41d0ca9a88638f4fdb06d532fdd0d980/best/media/2376303298,2376303281,2376303260,2376303247/render.gif?analytics_id\x3d1462812884780\x26pics\x3d20\x26auth_token\x3db96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x26trand\x3d1462850126190\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + currentItemIds + \x27/render\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\tolapic.utils.log(\x27EVENT: New Widget Content Scrolls into view | Analytic API: Media Render\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\n\t\t\t\t\t// API: Widget View (optional)\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/view\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.log(\x27EVENT: New Widget Content Scrolls into view | Analytic API: Widget View (optional)\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tinitOlapicGalleryLinkAnalytics : function(olapicElmObj, $this){\n\t\t\t\t\t$this.find(\x27.olapic-gallery-link\x27).on(\x27click keyup\x27, function(e){\n\t\t\t\t\t\tif(e.type \x3d\x3d \x27click\x27 || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 13) || (e.type \x3d\x3d\x3d \x27keyup\x27 \x26\x26 e.keyCode \x3d\x3d\x3d 32)){\n\t\t\t\t\t\t\tvar url \x3d \x27\x27,\n\t\t\t\t\t\t\t\tcurrentItemIdsCount \x3d $this.find(\x27.iscroll_item, .photowall-item\x27).length,\n\t\t\t\t\t\t\t\tswiper \x3d app.carousel.carousels[$this.find(\x27.swiperCarousel\x27).attr(\x27id\x27)];\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Event\n\t\t\t\t\t\t\t$(window).trigger(\x27olapic-carousel-viewGallery\x27,{\n\t\t\t\t\t\t\t\twidgets : $this.attr(\x27data-widgets\x27),\n\t\t\t\t\t\t\t\tprogress : swiper.progress,\n\t\t\t\t\t\t\t\ttotalItems : swiper.slides.length,\n\t\t\t\t\t\t\t\tcurrentRange : olapic.analytics.getCurrentItemIndices($this)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// EVENT: widget gallery link clicked\n\t\t\t\t\t\t\t// API: Widget view_all\n\t\t\t\t\t\t\t// example:\n\t\t\t\t\t\t\t// http://data.photorank.me/track/widget/41d0ca9a88638f4fdb06d532fdd0d980/best/render.gif?analytics_id\x3d1462812884780\x26pics\x3d20\x26auth_token\x3db96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x26trand\x3d1462826292121\n\n\t\t\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/view_all\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\t\t\tolapic.utils.log(\x27EVENT: widget gallery link clicked | API: Widget view_all\x27,url);\n\t\t\t\t\n\t\t\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tinitOlapicWidgetAnalytics : function(olapicElmObj, $this){\n\t\t\t\t\tvar cookie \x3d olapic.utils.getOlapicCookie(),\n\t\t\t\t\t\turl \x3d \x27\x27,\n\t\t\t\t\t\tviewed \x3d false,\n\t\t\t\t\t\tcurrentItemIds \x3d olapic.analytics.getCurrentItemIds($this),\n\t\t\t\t\t\tcurrentItemIdsCount \x3d $this.find(\x27.iscroll_item, .photowall-item\x27).length;\n\t\t\t\t\tif(cookie){\n\t\t\t\t\t\tanalytics_id \x3d cookie;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tolapic.utils.setOlapicCookie();\n\t\t\t\t\t\tanalytics_id \x3d olapic.utils.getOlapicCookie();\n\t\t\t\t\t}\n\n\t\t\t\t\t\t// EVENT: widget added to DOM\n\t\t\t\t\t\t// API: Widget Render\n\t\t\t\t\t\t// example:\n\t\t\t\t\t\t// http://data.photorank.me/track/widget/41d0ca9a88638f4fdb06d532fdd0d980/best/render.gif?analytics_id\x3d1462812884780\x26pics\x3d20\x26auth_token\x3db96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x26trand\x3d1462826292121\n\n\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/render\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\tolapic.utils.log(\x27EVENT: widget added to DOM | Analytic API: Widget Render\x27,url);\n\t\t\t\t\t\n\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\n\t\t\t\t\t// when carousel scrolled into view, emit carousel widget viewed\n\t\t\t\t\t// http://data.photorank.me/track/widget/41d0ca9a88638f4fdb06d532fdd0d980/best/media/2376303399,2376303365,2376303340,2376303324/render.gif?analytics_id\x3d1462812884780\x26pics\x3d20\x26auth_token\x3db96462dac722ae422c07dbc7e9b3717e7cb066cf770f8feb7b5bc6c0a4445b0f\x26trand\x3d1462826363573\n\t\t\t\t\t$(window).on(\x27scroll\x27,function() {\n\t\t\t\t\t    var docViewTop \x3d $(window).scrollTop(),\n\t\t\t\t\t\t\tdocViewBottom \x3d docViewTop + $(window).height(),\n\t\t\t\t\t\t\t$carouselElem \x3d $this;\n\t\t\t\t\t\t\telemTop \x3d $carouselElem.offset().top,\n\t\t\t\t\t\t\telemBottom \x3d elemTop + $carouselElem.height();\n\t\t\t\t\t\tif(elemBottom \x3c\x3d docViewBottom \x26\x26 viewed \x3d\x3d\x3d false){\n\n\t\t\t\t\t\t\t\t// EVENT: widget scrolled into view\n\t\t\t\t\t\t\t\t// API: Media Render\n\t\t\t\t\t\t\t\t// API: Widget View (optional)\n\n\t\t\t\t\t\t\tviewed \x3d true;\n\t\t\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/media/\x27 + currentItemIds + \x27/render\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\t\t\tolapic.utils.log(\x27EVENT: widget scrolled into view | Analytic API: Media Render\x27,url);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t\t\n\t\t\t\t\t\t\turl \x3d analyticUri + olapic.utils.getAnalyticWidgetId() + \x27/\x27 + olapicElmObj.analyticWidgetType + \x27/view\x27 + analyticFormat + analyticParams + \x27\x26pics\x3d\x27 + currentItemIdsCount + \x27\x26analytic_id\x3d\x27 + analytics_id;\n\n\t\t\t\t\t\t\tolapic.utils.log(\x27EVENT: widget scrolled into view | Analytic API: Widget View (optional)\x27,url);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tolapic.utils.ajaxReq(url, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} // initOlapicWidgetAnalytics\n\t\t\t\t\n\t\t\t\t\n\t\t\t} // analytics\n\t\t\t\n\t\t} // END olapic {}\n\t\t\n\t\treturn {\n\t\t\tinit : olapic.init\n\t\t}\n\t\t\n\t}());// END olapic_v3()\n\n\n\n\t//if( /dev1/.test(window.location.host) ){\n\t\tolapic_v3.init();\n\t//}else{\n\t//}\n\n});\n\n\x3c/script\x3e',{tagId:4989306});
s.tag('\x3cscript\x3e\n// Live Agent Chat\n\n// You\x27ll need to update parts of the script below\n// with Salesforce deployment and chat button code\n// those lines are marked with: !!! CONFIGURATION\n\n// Note the conditions below, this allows storefront production to use Salesforce Service Cloud production\n// and storefront development instances to use a non-production Salesforce Service Cloud instance\n\n(function(window){\n\tvar document \x3d window.document,\n\t\t// !!! CONFIGURATION: Customer Service Chat button id\n\t\tliveAgentChatButtonId\x3d\x22'+s.data('global :: live agent :: chat id')+'\x22,\n\t\t// !!! CONFIGURATION: Internet Services Deployment URL\n\t\tdeploymentJs \x3d window.location.host.match(\x27demandware\x27) ? \x27https://c.la1-c1cs-iad.salesforceliveagent.com/content/g/js/41.0/deployment.js\x27 : \x27https://c.la2-c1-iad.salesforceliveagent.com/content/g/js/42.0/deployment.js\x27,\n\t\tliveAgentInt \x3d function(liveagent){\n\t\t\t// !!! CONFIGURATION: Internet Services Deployment info\n\t\t\tif(window.location.host.match(\x27demandware\x27)){\n\t\t\t\tliveagent.init(\x27https://d.la1-c1cs-iad.salesforceliveagent.com/chat\x27, \x2757260000000Gn8J\x27, \x2700DL0000002APGt\x27);\n\t\t\t}else{\n\t\t\t\tliveagent.init(\x27https://d.la2-c1-iad.salesforceliveagent.com/chat\x27, \x2757260000000Gn8J\x27, \x2700D60000000KGaJ\x27);\n\t\t\t}\t\t\t\n\t\t};\n\t\n\tready(init);\n\t\n\tfunction init(){\n\t\trequire(deploymentJs,initLiveAgent);\n\t}\n\t\t\n\tfunction ready(fn) {\n\t  if (document.attachEvent ? document.readyState \x3d\x3d\x3d \x22complete\x22 : document.readyState !\x3d\x3d \x22loading\x22){\n\t    fn();\n\t  } else {\n\t    document.addEventListener(\x27DOMContentLoaded\x27, fn);\n\t  }\n\t}\n\n\tfunction require(file,callback){\n\t    var head\x3ddocument.getElementsByTagName(\x22head\x22)[0];\n\t    var script\x3ddocument.createElement(\x27script\x27);\n\t    script.src\x3dfile;\n\t    script.type\x3d\x27text/javascript\x27;\n\t    //real browsers\n\t    script.onload\x3dcallback;\n\t    //Internet explorer\n\t    script.onreadystatechange \x3d function() {\n\t        if (this.readyState \x3d\x3d \x27complete\x27) {\n\t            callback();\n\t        }\n\t    }\n\t    head.appendChild(script);\n\t}\n\t\n\tfunction initLiveAgent(){\n\t\tvar liveagent \x3d window.liveagent,\n\t\t\tliveAgentChatButtons \x3d document.querySelectorAll(\x27.js-live-agent\x27);\n\t\t\t\n\t\t// Likely due to the javascript window.open() parameters\n\t\t// that Live Agent uses, the chat window has no scrollbars:\n\t\t// window.scrollbars.visible \x3d\x3d\x3d false\n\t\t// so we set the minimum size necessary to show all elements\n\t\t// on the largest page (with all it\x27s error, order messaging)\n\t\tliveagent.setChatWindowHeight(670);\n\t\tliveagent.setChatWindowWidth(500);\n\t\t//liveagent.enableLogging();\n\n\t\tif (!window._laq) { window._laq \x3d []; }\n\n\t\tfor(var i\x3d0, len \x3d liveAgentChatButtons.length;i\x3clen;i++){\n\t\t\tvar buttonElm \x3d liveAgentChatButtons[i],\n\t\t\t\tonlineElmId \x3d (\x27liveAgent_\x27+(new Date().getTime()))+(Math.random()*100).toFixed(0),\n\t\t\t\tofflineElmId \x3d (\x27liveAgent_\x27+(new Date().getTime()))+(Math.random()*100).toFixed(0),\n\t\t\t\tonlineElm \x3d buttonElm.querySelector(\x27.js-live-agent-online\x27),\n\t\t\t\tofflineElm \x3d buttonElm.querySelector(\x27.js-live-agent-offline\x27);\n\t\n\t\t\tonlineElm.setAttribute(\x27id\x27, onlineElmId);\n\t\t\tofflineElm.setAttribute(\x27id\x27, offlineElmId);\n\t\t\n\t\t\tonlineElm.addEventListener(\x27click\x27, function(){\n\t\t\t\tliveagent.startChat(liveAgentChatButtonId);\n\t\t\t});\n\n\t\t\tliveagent.showWhenOnline(liveAgentChatButtonId, window.document.querySelector(\x22#\x22+onlineElmId));\n\t\t\tliveagent.showWhenOffline(liveAgentChatButtonId, window.document.querySelector(\x22#\x22+offlineElmId));\n\t\t\t\n\t\t\tliveAgentInt(liveagent);\n\t\t}\n\t}\n}(window));\n\t\n\x3c/script\x3e',{tagId:5287338});
s.tag('\x3cscript\x3e\n$(function(){\n\tvar feedbackBtn \x3d \x27\x3ca class\x3d\x22x-nav--feedback text-white\x22 style\x3d\x22text-align: center;padding: 10px;margin: 15px;background-color: #2A7AB0;color: #FFF;display: block;\x22 target\x3d\x22_blank\x22 href\x3d\x22https://ips-invite.iperceptions.com/webValidator.aspx?sdfc\x3d355b766d-126736-c733c77b-141a-42d7-be9f-2e52b426622b\x26amp;lID\x3d1\x26amp;source\x3d102226\x22\x3eFeedback\x3c/a\x3e\x27;\n\t$(\x27.sidebar.m-pikabu-sidebar.m-pikabu-left.slideout-menu \x3e div\x27).append(feedbackBtn);\n});\n\x3c/script\x3e',{tagId:5614744});
s.tag('\x3cstyle\x3e\n    .certona .outsideNavigation .sideNext, .certona .outsideNavigation .sidePrev {\n        background: rgba(255,255,255,.7);   \n    }\n\x3c/style\x3e\n\n\x3cscript\x3e\n    (function(){\n        switch(pageData.pageType){\n            case \x22home\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22HOME\x22,\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                break;\n            case \x22content\x22:\n                switch(pageData.contentID){\n                    case \x22come-as-you-are\x22:\n                        window.certona \x3d {\n                            \x22pagetype\x22: \x22COMEASYOUARE\x22,\n                            \x22devicetype\x22: deviceType(),\n                            \x22countrycode\x22: countryCode(),\n                            \x22recommendations\x22: true\n                        }\n                        break;\n                    default:\n                        break;\n                }\n                break;\n            case \x22category\x22:\n                var saleSites \x3d [\x22DE\x22, \x22ES\x22, \x22FI\x22, \x22FR\x22, \x22GB\x22, \x22NL\x22];\n                if ((pageData.categoryID \x3d\x3d \x22sale\x22) \x26\x26 (saleSites.indexOf(countryCode()) \x3e\x3d 0)){\n                    window.certona \x3d {\n                        \x22pagetype\x22: \x22SALE\x22,\n                        \x22devicetype\x22: deviceType(),\n                        \x22countrycode\x22: countryCode(),\n                        \x22recommendations\x22: true\n                    }\n                } else {\n                    window.certona \x3d {\n                        \x22pagetype\x22: \x22CATEGORY\x22,\n                        \x22categoryid\x22: getCategory(),\n                        \x22gender\x22: getGender(),\n                        \x22subcategoryid\x22: getSubCategoryID(),\n                        \x22devicetype\x22: deviceType(),\n                        \x22countrycode\x22: countryCode(),\n                        \x22recommendations\x22: false\n                    }\n                }\n                break;\n            case \x22search\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: pageData.numResults \x3e 0 ? \x22SEARCH\x22 : \x22NOSEARCH\x22,\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                //temp fix for bug 13112\n                if(pageData.numResults \x3d\x3d 0){\n                    $(\x22.responsiveCategory\x22).removeClass(\x22responsiveCards\x22);\n                }\n                break;\n            case \x22finder\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22SHOPBY\x22,\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                break;\n            case \x22product\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22PRODUCT\x22,\n                    \x22itemid\x22: pageData.productID,\n                    \x22gender\x22: getGender(),\n                    \x22subcategoryid\x22: getSubCategoryID(),\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                break;\n            case \x22account\x22:\n                /*\n                switch(pageData.pageType){\n                    case \x22wishlist\x22:\n                        window.certona \x3d {\n                            \x22pagetype\x22: \x22WISHLIST\x22,\n                            \x22itemid\x22: \x22semicolon delimited list\x22,\n                            \x22devicetype\x22: deviceType(),\n                            \x22countrycode\x22: countryCode(),\n                            \x22recommendations\x22: false\n                        }\n                        break;\n                    default:\n                        break;\n                }\n                */\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22ACCOUNT\x22,\n                    \x22customerid\x22: getCustomerID(),\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                break;\n            case \x22cart\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: pageData.cartQty \x3e 0 ? \x22CART\x22 : \x22ECART\x22,\n                    \x22itemid\x22: getIDs(pageData.cartItems),\n                    \x22customerid\x22: getCustomerID(),\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: true\n                }\n                break;\n            case \x22checkout\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22CHECKOUT\x22,\n                    \x22itemid\x22: getIDs(pageData.cartItems),\n                    \x22customerid\x22: getCustomerID(),\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode(),\n                    \x22recommendations\x22: false\n                }\n                break;\n            case \x22confirm\x22:\n                window.certona \x3d {\n                    \x22pagetype\x22: \x22PURCHASE\x22,\n                    \x22itemid\x22: getIDs(pageData.orderItems),\n                    \x22qty\x22: getQtys(pageData.orderItems),\n                    \x22price\x22: getPrices(pageData.orderItems),\n                    \x22total\x22: String(pageData.orderValue),\n                    \x22transactionid\x22: pageData.orderID,\n                    \x22customerid\x22: getCustomerID(),\n                    \x22devicetype\x22: deviceType(),\n                    \x22countrycode\x22: countryCode()\n                }\n                break;\n            default:\n                break;\n        };\n        \n        function deviceType(){\n            return window.innerWidth \x3c 960 ? \x22MOBILE\x22 : \x22DESKTOP\x22;\n        }\n        \n        function countryCode(){\n            var locale \x3d (app.config.locale \x3d\x3d \x22default\x22 ? \x22en_US\x22 : app.config.locale);\n            return locale.split(\x22_\x22)[1];\n        }\n        \n        function getCategory(){\n        \tvar categoryID \x3d pageData.categoryID;\n        \tif(categoryID.match(\x22jibbitz\x22)){\n        \t\treturn \x22jibbitz\x22;\n        \t} else if(categoryID.match(\x22accessories\x22)){\n        \t\treturn \x22accessories\x22;\n        \t} else {\n        \t\treturn \x22footwear\x22;\n        \t}\n        }\n        \n        function getGender(){\n    \t\tvar men \x3d false;\n    \t\tvar women \x3d false;\n    \t\tvar boys \x3d false;\n    \t\tvar girls \x3d false;\n    \t\tvar categoryID \x3d pageData.categoryID;\n\n\t\t\tif(categoryID.match(\x22^jibbitz\x22)){\n\t\t\t\tmen \x3d women \x3d boys \x3d girls \x3d true;\n\t\t\t} else if(categoryID.match(\x22(men|women|boys|girls)\x22)){\n\t\t\t\tvar catsplit \x3d categoryID.split(\x22-\x22);\n\t\t\t\t\n\t\t\t\tswitch(catsplit[0]){\n\t\t\t\t\tcase \x22men\x22:\n\t\t\t\t\t\tmen \x3d true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \x22women\x22:\n\t\t\t\t\t\twomen \x3d true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \x22boys\x22:\n\t\t\t\t\t\tboys \x3d true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \x22girls\x22:\n\t\t\t\t\t\tgirls \x3d true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n    \t\tif(men || boys){\n    \t\t\treturn \x22male\x22;\n    \t\t} else if(women || girls){\n    \t\t\treturn \x22female\x22;\n    \t\t} else {\n    \t\t    return \x22unisex\x22;   \n    \t\t}\n        }\n        \n        function getSubCategoryID(){\n        \tvar categoryID \x3d pageData.categoryID;\n\t\t\tvar catsplit \x3d categoryID.split(\x22-\x22);\n\t\t\t\n\t\t\tif(catsplit.length \x3e 2){\n\t\t\t\treturn categoryID.substr(String(catsplit[0] + catsplit[1]).length + 2);\n\t\t\t} else {\n\t\t\t\treturn \x22\x22;\n\t\t\t}\n        }\n        \n        function getCustomerID(){\n        \treturn typeof app.config.customerNo !\x3d\x3d \x22undefined\x22 ? app.config.customerNo : \x22\x22;\n        }\n        \n        function getIDs(items){\n            var ids \x3d [];\n            for(i in items){\n            \tids.push(items[i].master);\n            }  \n            return ids.join(\x22;\x22);\n        }\n        \n        function getQtys(items){\n            var qtys \x3d [];\n            for(i in items){\n            \tqtys.push(items[i].qty);\n            }  \n            return qtys.join(\x22;\x22);\n        }\n        \n        function getPrices(items){\n            var prices \x3d [];\n            for(i in items){\n            \tprices.push(items[i].price);\n            }  \n            return prices.join(\x22;\x22);\n        }\n        \n        window.certonaRecommendations \x3d function(data){\n            for(var i \x3d 0; i \x3c data.resonance.schemes.length; i++){\n            \tvar scheme \x3d data.resonance.schemes[i];\n            \tif(scheme.display \x3d\x3d \x22yes\x22){            \t\t\n            \t\tvar title \x3d scheme.explanation;\n            \t\tif(app.config.locale \x3d\x3d \x22en_CA\x22){\n            \t\t\ttitle \x3d title.split(\x22|\x22)[0];\n            \t\t} else if(app.config.locale \x3d\x3d \x22fr_CA\x22){\n\t\t\t\t\t\ttitle \x3d title.split(\x22|\x22)[1];\n            \t\t}\n            \t\t\n            \t\tif(scheme.scheme \x3d\x3d \x22minicart_rr\x22){\n            \t\t\tapp.certona.createJustAdded(scheme.scheme, title, scheme.items);\n            \t\t} else {\n\t\t\t\t\t\tvar ids \x3d [];\n\t\t\t\t\t\tfor(var k \x3d 0; k \x3c scheme.items.length; k++){\n\t\t\t\t\t\t\tids.push(scheme.items[k].id);\n\t\t\t\t\t\t}\n            \t\t\n            \t\t\tapp.certona.createCarousel(scheme.scheme, title, ids);\n            \t\t}\n            \t}\n            }\n        }\n        \n        app.certona \x3d {\n        \tcreateCarousel: function(carouselID, carouselName, productIDs){\n\t\t\t\tvar html1 \x3d \x22\x22,\n\t\t\t\t\thtml2 \x3d \x22\x22,\n\t\t\t\t\thtml3 \x3d \x22\x22,\n\t\t\t\t\thtag \x3d (carouselID \x3d\x3d \x27home_rr\x27) ? \x27h2\x27 : \x27h3\x27,\n\t\t\t\t\tadaPreviousItemText \x3d app.config.msgs.carousel.previousitem || \x27previous\x27,\n\t\t\t\t\tadaNextItemText \x3d app.config.msgs.carousel.nextitem || \x27next\x27,\n\t\t\t\t\tcarousel \x3d $(\x22#\x22 + carouselID);\n\t\t\t\t\t\n\t\t\t\thtml1 \x3d \x27\x3cdiv class\x3d\x22cs_container-fluid certona\x22\x3e\x27;\n\t\t\t\t\t\n\t\t\t\tif(carouselID \x3d\x3d \x27product2_rr\x27 || carouselID \x3d\x3d \x27product3_rr\x27 || carouselID \x3d\x3d \x27product4_rr\x27){\n\t\t\t\t\thtml1 +\x3d \x27\x3ch3 class\x3d\x22text-center text-left-md cx-heading cx-brand-font cx-proxima bold\x22\x3e\x27 + carouselName + \x27\x3c/h3\x3e\x27;\n\t\t\t\t} else if(carouselID !\x3d \x27club_rr\x27){\n\t\t\t\t\thtml1 +\x3d \x27\x3cdiv class\x3d\x22dividerContGreen clear\x22\x3e\x3cdiv class\x3d\x22dividerTextContGreen\x22\x3e\x3cdiv class\x3d\x22dividerInlineBlockGreen\x22\x3e\x3cdiv class\x3d\x22dividerTextGreen\x22\x3e\x3c\x27 + htag + \x27 class\x3d\x22cx-heading smaller cx-brand-font cx-proxima bold text-capitalize\x22 style\x3d\x22margin: 0;\x22\x3e\x27 + carouselName + \x27\x3c/\x27 + htag + \x27\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x27;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\thtml1 +\x3d \x27\x3cdiv class\x3d\x22cs_row\x22\x3e\x27;\n\t\t\t\thtml1 +\x3d \x27\x3cdiv class\x3d\x22col-xs-12 padding-0\x22\x3e\x27;\n\t\t\t\thtml1 +\x3d \x27\x3cdiv class\x3d\x22swiperCarouselWrapper shop-carousel productCarousel productCards newProductCards\x22\x3e\x27;\t\t\n\t\t\t\thtml1 +\x3d \x27\x3cdiv id\x3d\x22\x27+ carouselID +\x27\x22 class\x3d\x22swiperCarousel adaCarousel outsideNavigation\x22\x3e\x27;\n\t\t\t\thtml1 +\x3d \t\x27\x3cdiv class\x3d\x22sidePrev\x22\x3e\x27;\n\t\t\t\thtml1 +\x3d \t\t\x27\x3cbutton type\x3d\x22button\x22 tabindex\x3d\x22-1\x22\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+adaPreviousItemText+\x27\x3c/span\x3e\x3cspan aria-hidden\x3d\u201dtrue\u201d\x3e\x26lsaquo;\x3c/span\x3e\x3c/button\x3e\x27;\n\t\t\t\thtml1 +\x3d \t\x27\x3c/div\x3e\x27;\n\t\t\t\thtml1 +\x3d \t\x27\x3cdiv class\x3d\x22swiper-wrapper\x22\x3e\x27;\n\t\t\t\thtml3 +\x3d\t\x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \t\x27\x3cdiv class\x3d\x22sideNext\x22\x3e\x27;\n\t\t\t\thtml3 +\x3d \t\t\x27\x3cbutton type\x3d\x22button\x22 tabindex\x3d\x22-1\x22\x3e\x3cspan class\x3d\x22sr-only\x22\x3e\x27+adaNextItemText+\x27\x3c/span\x3e\x3cspan aria-hidden\x3d\u201dtrue\u201d\x3e\x26rsaquo;\x3c/span\x3e\x3c/button\x3e\x27;\n\t\t\t\thtml3 +\x3d \t\x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3cdiv class\x3d\x22clear\x22\x3e\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n        \t\n        \t\tvar counter \x3d productIDs.length;\n        \t\t$.each(productIDs, function(index, productID){\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\ttype: \x22GET\x22,\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\x22pid\x22: productID\n\t\t\t\t\t\t},\n\t\t\t\t\t\turl: app.config.urls.home.replace(\x22Home-Show\x22, \x22Search-ProductCard\x22).replace(\x22http:\x22, window.location.protocol),\n\t\t\t\t\t\tdataType: \x27html\x27,\n\t\t\t\t\t\tsuccess: function(html){\n\t\t\t\t\t\t\thtml2 +\x3d \x27\x3cli class\x3d\x22swiper-slide\x22\x3e\x3ca class\x3d\x22carouselLink\x22 href\x3d\x22\x27 + app.config.urls.home.replace(\x22Home-Show\x22, \x22Product-Show?pid\x3d\x22 + productID).replace(\x22http:\x22, window.location.protocol) + \x27\x22\x3e\x3c/a\x3e\x27 + html + \x27\x3c/li\x3e\x27;\n\t\t\t\t\t\t\tcheckDone();\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function(){\n\t\t\t\t\t\t\tcheckDone();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n        \t\t});\n        \t\t\n        \t\tfunction checkDone(){\n\t\t\t\t\tcounter--;\n\t\t\t\t\tif(counter \x3d\x3d 0){\n\t\t\t\t\t\tcarousel.replaceWith(html1 + html2 + html3);\n\t\t\t\t\t\tcarousel \x3d $(\x22#\x22 + carouselID);\n\t\t\t\t\t\tapp.productCarousel.init(carousel, false, \x27certona\x27);\n\t\t\t\t\t\tapp.carousel.init(carousel);\n\t\t\t\t\t}\n        \t\t}\n        \t},\n        \t\n        \tcreateJustAdded: function(carouselID, carouselName, products){\n\t\t\t\tvar html1 \x3d \x22\x22,\n\t\t\t\t\thtml2 \x3d \x22\x22,\n\t\t\t\t\thtml3 \x3d \x22\x22,\n\t\t\t\t\tcarousel \x3d $(\x22#\x22 + carouselID),\n\t\t\t\t\tviewDetailsText \x3d {\n\t\t\t\t\t\t\x22default\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22en_CA\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22fr_CA\x22: \x22Voir les d\xe9tails\x22,\n\t\t\t\t\t\t\x22en_ES\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22en_GB\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22en_SG\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22en_AU\x22: \x22View Details\x22,\n\t\t\t\t\t\t\x22fr_FR\x22: \x22Voir Details\x22,\n\t\t\t\t\t\t\x22de_DE\x22: \x22Details anzeigen\x22,\n\t\t\t\t\t\t\x22ja_JP\x22: \x22\u8a73\u7d30\u3092\u898b\u308b\x22,\n\t\t\t\t\t\t\x22ko_KR\x22: \x22\uc790\uc138\ud788\ubcf4\uae30\x22,\n\t\t\t\t\t\t\x22fi_FI\x22: \x22Katso Lis\xe4tietoja\x22,\n\t\t\t\t\t\t\x22nl_NL\x22: \x22Bekijk details\x22,\n\t\t\t\t\t\t\x22zh_CN\x22: \x22\x22,\n\t\t\t\t\t};\n        \t\n\t\t\t\thtml1 +\x3d \x27\x3cdiv id\x3d\x22minicart_rr\x22 class\x3d\x22certona\x22 style\x3d\x22visibility: visible;\x22\x3e\x27;\n\t\t\t\thtml1 +\x3d \x27\t\t\x3ch2 class\x3d\x22cx-proxima bold cx-heading\x22\x3e\x27 + carouselName + \x27\x3c/h2\x3e\x27;\n\t\t\t\thtml1 +\x3d \x27\t\t\x3cul\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\t\t\x3c/ul\x3e\x27;\n\t\t\t\thtml3 +\x3d \x27\x3c/div\x3e\x27;\n\t\t\t\t\n\t\t\t\t$.each(products, function(index, product){\n\t\t\t\t\tvar rating \x3d typeof product.rating !\x3d\x3d \x27undefined\x27 ? product.rating : 0;\n\t\t\t\t\tvar ratingWidth \x3d rating * 16;\n\t\t\t\t\n\t\t\t\t\thtml2 +\x3d \x27\x3cli class\x3d\x22cs_row\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\x3cdiv class\x3d\x22col-xs-12 product-added-review\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3cdiv class\x3d\x22cs_row\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\x3cdiv class\x3d\x22col-xs-4\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\x3cdiv class\x3d\x22minirating\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\t\x3cdiv class\x3d\x22grayBackground\x22 itemscope\x3d\x22\x22 itemprop\x3d\x22aggregateRating\x22 itemtype\x3d\x22http://schema.org/AggregateRating\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\t\t\x3cdiv class\x3d\x22goldForeground\x22 style\x3d\x22width:\x27 + ratingWidth + \x27px;\x22\x3e\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\t\t\x3cdiv class\x3d\x22sr-only\x22\x3e\x3cspan\x3e\x27 + rating + \x27 out of 5 stars\x3c/span\x3e\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\x3cdiv class\x3d\x22col-xs-4\x22\x3e\x3cimg title\x3d\x22\x27 + product.name + \x27\x22 alt\x3d\x22\x27 + product.name + \x27\x22 src\x3d\x22\x27 + product.thumbnailUrl + \x27\x22\x3e\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\x3cdiv class\x3d\x22col-xs-8 cx-copy\x22\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3ch3 class\x3d\x22larger\x22\x3e\x3ca href\x3d\x22\x27 + product.detailUrl + \x27\x22\x3e\x27 + product.name + \x27\x3c/a\x3e\x3c/h3\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3cdiv class\x3d\x22product-added-price\x22\x3e\x27;\n\t\t\t\t\t\n\t\t\t\t\tif(product.listprice !\x3d product.saleprice){\n\t\t\t\t\t\thtml2 +\x3d \x27\t\t\x3cspan class\x3d\x22text-clearance\x22 itemprop\x3d\x22price\x22\x3e\x27 + product.saleprice + \x27\x3c/span\x3e\x26nbsp;\x3cs\x3e\x27 + product.listprice + \x27\x3c/s\x3e\x27;\n\t\t\t\t\t} else {\n\t\t\t\t\t\thtml2 +\x3d product.listprice;\n\t\t\t\t\t}\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\t\x3ca tabindex\x3d\x22-1\x22 href\x3d\x22\x27 + product.detailUrl + \x27\x22\x3e\x3cbutton class\x3d\x22cx-button cx-button-cta\x22\x3e\x27 + viewDetailsText[app.config.locale] + \x27\x3c/button\x3e\x3c/a\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\t\x3c/div\x3e\x27;\n\t\t\t\t\thtml2 +\x3d \x27\x3c/li\x3e\x27;\n\t\t\t\t});\n        \t\t\t\n\t\t\t\tcarousel.replaceWith(html1 + html2 + html3);\n\t\t\t\tcarousel \x3d $(\x22#\x22 + carouselID);\n        \t}\n        }\n    })();\n\x3c/script\x3e\n\n\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22//edge1.certona.net/cd/288311fd/crocs/scripts/resonance.js\x22\x3e\x3c/script\x3e',{tagId:5689876});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\nvar adCloudImage \x3d new Image();\nadCloudImage.src \x3d \x22https://rtd-tm.everesttech.net/upi/?sid\x3dfNp60jq7ll3eQ8cSGs1L\x26cs\x3d1\x22;\n\x3c/script\x3e',{tagId:5746464});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\n    !function(e){if(!window.pintrk){window.pintrk\x3dfunction(){window.pintrk.queue.push(Array.prototype.slice.call(arguments))};var n\x3dwindow.pintrk;n.queue\x3d[],n.version\x3d\x223.0\x22;var t\x3ddocument.createElement(\x22script\x22);t.async\x3d!0,t.src\x3de;var r\x3ddocument.getElementsByTagName(\x22script\x22)[0];r.parentNode.insertBefore(t,r)}}(\x22https://s.pinimg.com/ct/core.js\x22);\n    \n    (function(){\n        var email \x3d \x22\x22;\n        if(app.config.customerEmail !\x3d null \x26\x26 app.config.customerEmail !\x3d \x22\x22){\n            email \x3d app.config.customerEmail;\n        } else if(app.config.orderEmail !\x3d null \x26\x26 app.config.orderEmail !\x3d \x22\x22){\n            email \x3d app.config.orderEmail;\n        } else if(urlParam(\x22emailSHA256\x22) !\x3d null \x26\x26 urlParam(\x22emailSHA256\x22) !\x3d \x22\x22){\n            email \x3d urlParam(\x22emailSHA256\x22);   \n        }\n        \n        pintrk(\x27load\x27,\x272617926121790\x27, {\n            em: email\n        });\n        pintrk(\x27page\x27);\n        \n        function urlParam(name){\n            var results \x3d new RegExp(\x27[\\?\x26]\x27+name+\x27\x3d([^\x26#]*)\x27).exec(window.location.href);\n            if(results\x3d\x3dnull){\n               return null;\n            } else{\n               return results[1] || 0;\n            }\n        }\n        \n        switch(pageData.pageType){\n            case \x22product\x22:\n                sendProductView();\n                break;\n            case \x22search\x22:\n                sendSearchView();\n                break;\n            case \x22category\x22:\n                sendCategoryView();\n                break;\n            case \x22confirm\x22:\n            \tsendPurchase();\n            \tbreak;\n            default:\n                break;\n        };\n        \n        setUpCartActions();\n        \n        function sendProductView(){\n    \t\tpintrk(\x27track\x27, \x27pagevisit\x27);\n        }\n        \n        function sendSearchView(){\n        \tpintrk(\x27track\x27, \x27search\x27, {\n        \t\tsearch_query: pageData.query\n        \t});\n        }\n        \n        function sendCategoryView(){\n        \tpintrk(\x27track\x27, \x27viewcategory\x27);\n        }\n        \n        function sendAddToCart(productID){\n    \t\tpintrk(\x27track\x27, \x27addtocart\x27, {\n    \t\t\tline_items: [{\n    \t\t\t\tproduct_id: productID\n    \t\t\t}]\n    \t\t});\n        }\n        \n        function sendPurchase(){\n    \t\tpintrk(\x27track\x27, \x27checkout\x27, {\n    \t\t    order_id: pageData.orderID,\n    \t\t\tvalue: pageData.orderValue,\n    \t\t\torder_quantity: pageData.orderQty,\n    \t\t\tcurrency: \x27USD\x27,\n    \t\t\tline_items: getProductLineItems(pageData.orderItems)\n    \t\t});\n        }\n        \n        function setUpCartActions(){\n    \t\t$(window).on(\x27cart-update-success\x27, function(e, data){\n    \t\t\t/*\n    \t\t\tif(data.removedLineItem){\n    \t\t\t\tsendRemoveFromCart(data.removedLineItem.id);\n    \t\t\t}\n    \t\t\t*/\n    \t\t\tif(data.addedLineItem){\n    \t\t\t\tsendAddToCart(data.addedLineItem.id);\n    \t\t\t}\n    \t\t});\n        }\n        \n        function getProductLineItems(items){\n        \tvar lineItems \x3d [];\n    \t\tfor(var i in items){\n    \t\t\tvar o \x3d {};\n    \t\t\to.product_name \x3d items[i].name;\n    \t\t\to.product_id \x3d items[i].master; //or variant?\n    \t\t\to.product_price \x3d items[i].price;\n    \t\t\to.product_quantity \x3d items[i].qty;\n    \t\t\tlineItems.push(o);\n    \t\t}\n    \t\treturn lineItems;\n        }\n    })();\n\x3c/script\x3e',{tagId:5829138});
s.tag('\x3c!-- Google Code for Remarketing Tag --\x3e\n\x3c!--------------------------------------------------\nRemarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup\n---------------------------------------------------\x3e\n\x3cscript type\x3d\x22text/javascript\x22\x3e\n/* \x3c![CDATA[ */\n    if(pageData.pageType \x3d\x3d \x22confirm\x22){\n        var google_conversion_label \x3d \x2275wCCJ3EqG8QtaGAmQM\x22;\n        var google_conversion_value \x3d pageData.orderValue;\n        var google_conversion_currency \x3d \x22'+s.data('currency')+'\x22;\n        var google_remarketing_only \x3d false;   \n    } else {\n        var google_remarketing_only \x3d true;\n    }\n    var google_conversion_id \x3d 857739445;\n    var google_custom_params \x3d window.google_tag_params;\n/* ]]\x3e */\n\x3c/script\x3e\n\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22//www.googleadservices.com/pagead/conversion.js\x22\x3e\n\x3c/script\x3e',{tagId:6172171});
s.tag('\x3cscript\x3e\n// JSON+LD Schema :: Organization\n// home page, contactus, about-crocs (cid)\n$(function(){\n\t\n\tvar organizationObj \x3d {\n\t\t// \x22Organization\x22\n\t\t// TODO: Add here or in templates?  Would this be any different for different sites\n\t\t\t\x22@context\x22: \x22https://schema.org\x22,\n\t\t\t\x22@type\x22: \x22Organization\x22,\n\t\t\t\x22url\x22: window.location.origin,\n\t\t\t\x22name\x22: \x22Crocs\x22,\n\t\t\t\x22legalName\x22: \x22Crocs Retail, LLC\x22,\n\t\t\t\x22telephone\x22: \x22+1-866-306-3179\x22,\n\t\t\t\x22foundingDate\x22: \x222002\x22,\n\t\t\t\x22founders\x22: [\n\t\t\t\t{\n\t\t\t\t\t\x22@type\x22: \x22Person\x22,\n\t\t\t\t\t\x22name\x22: \x22Scott Seamans\x22\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\x22@type\x22: \x22Person\x22,\n\t\t\t\t\t\x22name\x22: \x22Lyndon Hanson\x22\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\x22@type\x22: \x22Person\x22,\n\t\t\t\t\t\x22name\x22: \x22George Boedecker\x22\n\t\t\t\t}\n\t\t\t],\n\t\t\t\x22address\x22: {\n\t\t\t\t\x22@type\x22: \x22PostalAddress\x22,\n\t\t\t\t\x22addressLocality\x22: \x22Niwot, Colorado\x22,\n\t\t\t\t\x22postalCode\x22: \x2280503\x22,\n\t\t\t\t\x22streetAddress\x22: \x227477 East Dry Creek Parkway\x22\n\t\t\t},\n\t\t\t\x22sameAs\x22: [\n\t\t\t\t\x22https://en.wikipedia.org/wiki/Crocs\x22,\n\t\t\t\t\x22https://www.facebook.com/Crocs/\x22,\n\t\t\t\t\x22https://twitter.com/Crocs\x22,\n\t\t\t\t\x22https://www.linkedin.com/company-beta/16726/\x22\n\t\t\t]\n\t\t};\n\n\tif($(\x27.logo-container .svgLogo\x27).length){organizationObj.logo \x3d window.location.origin + $(\x27.logo-container .svgLogo\x27).attr(\x27src\x27);}\n\taddInfoToDOM(organizationObj);\n\n\tfunction addInfoToDOM(schemaObj){\n\t\t// add schema via ld+json\n\t\t// per Google you can dynamically set this:\n\t\t// https://developers.google.com/search/docs/guides/intro-structured-data\n\t\tvar head \x3d document.getElementsByTagName(\x22head\x22)[0],\n\t\t\tsTag \x3d document.createElement(\x22script\x22);\n\t\tsTag.type \x3d \x22application/ld+json\x22;\n\t\tsTag.text \x3d JSON.stringify(schemaObj);\n\t\thead.appendChild(sTag);\t\t\n\t}\n\t\n});\n\x3c/script\x3e',{tagId:6244743});
s.tag('\x3cscript type\x3d\x22text/javascript\x22\x3e\n    (function(a,b,c,d,e,f,g){e[\x27ire_o\x27]\x3dc;e[c]\x3d e[c]||function(){(e[c].a\x3de[c].a||[]).push(arguments)};f\x3dd.createElement(b);g\x3dd.getElementsByTagName(b)[0];f.async\x3d1;f.src\x3da;g.parentNode.insertBefore(f,g);})(\x27//d.impactradius-event.com/'+s.data('impact radius :: jsfilename')+'.js\x27,\x27script\x27,\x27ire\x27,document,window);\n    ire(\x27identify\x27, {customerId: \x27'+s.data('customer no')+'\x27, customerEmail: \x27'+s.data('global :: email :: sha256 hashed email')+'\x27});\n    \n    (function(){\n        if(pageData.pageType \x3d\x3d \x22confirm\x22){\n            ire(\x27trackConversion\x27, \x22'+s.data('impact radius :: confirmation actiontrackerid')+'\x22, {\n                orderId: pageData.orderID,\n                customerId: \x22'+s.data('customer no')+'\x22,\n                customerEmail: \x22'+s.data('global :: email :: sha256 hashed email')+'\x22,\n                items: getProducts(pageData.orderItems),\n                customerStatus: ('+s.data('isnewcustomer')+' \x3d\x3d 1 ? \x22existing\x22 : \x22new\x22),\n                orderPromoCode: (pageData.orderPromos.length \x3e 0 ? pageData.orderPromos[0].promoID : \x22\x22)\n            },{verifySiteDefinitionMatch:true});\n        }\n        \n        function getProducts(items){\n        \tvar products \x3d [];\n    \t\tfor(var i in items){\n    \t\t\tvar o \x3d {};\n    \t\t\to.sku \x3d items[i].id;\n    \t\t\to.subTotal \x3d items[i].price;\n    \t\t\to.category \x3d items[i].categoryID;\n    \t\t\to.quantity \x3d items[i].qty;\n    \t\t\tproducts.push(o);\n    \t\t}\n    \t\treturn products;\n        }\n    })();\n\x3c/script\x3e',{tagId:6308086});
s.secondary(function(c){
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(3551331);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(3787433);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(3551323).appendData('global :: utils :: identity').appendData('global :: email :: sha256 hashed email').appendData('locale');
c.when('bt_data(\x27page type\x27) \x3d\x3d \x22confirm\x22 \x26\x26 !!bt_data(\x27userid\x27)').fire(1094).appendData('userid').appendData('signal universal id').appendData('input').appendData('order id').appendData('campaign').appendData('locale').appendData('global :: utils :: identity').appendData('global :: order item quantity').appendData('order item total').appendData('timestamp');
c.when('!!bt_data(\x27userid\x27)').fire(1220).appendData('userid').appendData('referring url').appendData('signal universal id').appendData('input').appendData('product id').appendData('page type').appendData('campaign').appendData('global :: adobe :: amo click key').appendData('locale').appendData('global :: utils :: identity').appendData('timestamp');
c.when('bt_data(\x27page type\x27) \x3d\x3d \x22confirm\x22').fire(8673).appendData('userid').appendData('signal universal id').appendData('input').appendData('order id').appendData('campaign').appendData('global :: utils :: identity').appendData('global :: order item quantity').appendData('order item total').appendData('timestamp');
c.when('bt_data(\x27referring url domain\x27) \x3d\x3d \x27shopping.com\x27').fire(44324);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22boys\x22').fire(93741);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22girls\x22').fire(93957);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22men\x22').fire(93966);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22women\x22').fire(93975);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22outlet\x22').fire(94002);
c.when('bt_data(\x27omnassetid\x27).indexOf(\x22product_detail\x22) \x3e -1').fire(94020);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22collections\x22').fire(147417);
c.when('bt_data(\x27category\x27) \x3d\x3d \x22accessories\x22').fire(147498);
c.when('bt_data(\x27order confirmation number\x27) \x3d\x3d \x22\x22 \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(155679);
c.when('((bt_data(\x27page url\x27).indexOf(\x22@\x22) \x3c 0 \x26\x26 bt_data(\x27page url\x27).indexOf(\x22%40\x22) \x3c 0) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(531924);
c.when('(bt_data(\x27global :: mobile/desktop\x27) \x3d\x3d \x22d\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22cart\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22checkout\x22 \x26\x26 bt_data(\x27crocsautotester\x27) \x3d\x3d \x22false\x22)').fire(2035244);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(2283149);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(2762867);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(3028078);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(3567217);
c.when('app.config.locale \x3d\x3d \x22default\x22 \x26\x26 pageData.pageType !\x3d \x22confirm\x22').fire(4881272);
c.when('(bt_data(\x27page type\x27) !\x3d \x22confirm\x22 \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(4978792);
c.when('(!!bt_data(\x27global :: amobee :: page type\x27) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(4978899);
c.when('(!!bt_data(\x27global :: mediaiq :: smart pixel seg\x27) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(4985960);
c.when('(!!bt_data(\x27global :: collective :: tag id\x27) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(5040511);
c.when('(!!bt_data(\x27global :: dstillery :: nc param\x27) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0 \x26\x26 (bt_data(\x27page type\x27) !\x3d \x22confirm\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22cart\x22))').fire(5040527);
c.when('!!bt_data(\x27global :: maxpoint :: page id\x27)').fire(5040706);
c.when('!bt_data(\x27userid\x27)').fire(5228972).appendData('global :: utils :: identity').appendData('timestamp').appendData('ip address').appendData('campaign').appendData('global :: adobe :: amo click key').appendData('page type').appendData('product id').appendData('signal universal id').appendData('order id').appendData('global :: order item quantity').appendData('order item total').appendData('referring url').appendData('user agent').appendData('locale');
c.when('(bt_data(\x27crocsautotester\x27) !\x3d true \x26\x26 bt_data(\x27page type\x27) !\x3d \x22cart\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22login\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22checkout\x22 \x26\x26 bt_data(\x27page type\x27) !\x3d \x22crocsclubreg\x22)').fire(5398395);
c.when('((bt_data(\x27locale\x27) \x3d\x3d \x22en_CA\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22ja_JP\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22en_GB\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22en_AU\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22fr_FR\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22de_DE\x22 || bt_data(\x27locale\x27) \x3d\x3d \x22default\x22) \x26\x26 bt_data(\x27donottrack\x27) \x3d\x3d 0)').fire(6153466);
c.when('bt_data(\x27page type\x27) \x3d\x3d \x22home\x22').fire(6244775);
c.when('bt_data(\x27page type\x27) \x3d\x3d \x22product\x22').fire(6244785);
c.when('(bt_data(\x27page type\x27) \x3d\x3d \x22category\x22 || bt_data(\x27page type\x27) \x3d\x3d \x22search\x22)').fire(6244845);
c.when('!!bt_data(\x27mckinney :: floodlights :: type\x27)').fire(6308016);
c.when('bt_data(\x27donottrack\x27) \x3d\x3d 0').fire(6326954);
c.when('(bt_data(\x27donottrack\x27) \x3d\x3d 0 \x26\x26 !!bt_data(\x27global :: adobe :: dco v2 :: page sid\x27) \x26\x26 !!bt_data(\x27global :: adobe :: dco v2 :: pagename\x27))').fire(6576181);
c.appendData('bt:entityid').appendData('bt:uidkey').appendData('bt:uidvalue');
});
});
});
});
