(function(){var c=!1,a=/var xyz/.test(function(){})?/\b_super\b/:/[\D|\d]*/;this.__tmClass=function(){};window.__tmClass=this.__tmClass;__tmClass.extend=function(e){function f(){!c&&this.init&&this.init.apply(this,arguments)}var h=this.prototype;c=!0;var m=new this;c=!1;for(var t in e)m[t]="function"==typeof e[t]&&"function"==typeof h[t]&&a.test(e[t])?function(c,a){return function(){var e=this._super;this._super=h[c];var f=a.apply(this,arguments);this._super=e;return f}}(t,e[t]):e[t];f.prototype=
m;f.prototype.constructor=f;f.extend=arguments.callee;return window.__tmClass=f}})();window.triggermail={config:{eventSource:"custom_integration",encodeCookie:!1}};window.console?"undefined"==typeof window.console.debug&&(console.debug=function(){}):console={debug:function(){},error:function(){},log:function(){}};window.TM_API_HOST="triggeredmail.appspot.com/api";window.triggermail.lytics=[];triggermail.lytics.__SV=1.2;
(function(c){function a(){a.done||(J=a.done=!0,z=!1,d.each(E,function(b){b._dom_loaded()}))}var e=Array.prototype,f=Object.prototype,h=e.slice,m=f.toString,t=f.hasOwnProperty,n=window.console,w=window.navigator,r=window.document,p=w.userAgent,B=["__mps","__mpa","__mpap","$people_distinct_id","__alias"],u=!1;try{u=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(s){}var D="https:"==r.location.protocol?"https://":"http://",f=c&&c.__SV||0,A=u,z=!A&&-1==p.indexOf("MSIE"),d={},y=!1,
L={api_host:D+TM_API_HOST,cross_subdomain_cookie:!0,cookie_name:window.triggermail.custom_cookie_name||"",loaded:function(){},store_google:!1,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,live_demo:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,ip:!0},J=!1;(function(){var b=e.forEach,g=e.indexOf,l=Array.isArray,c={},a=d.each=function(g,l,d){if(null!=g)if(b&&g.forEach===b)g.forEach(l,d);else if(g.length===+g.length)for(var a=0,M=g.length;a<M&&
!(a in g&&l.call(d,g[a],a,g)===c);a++);else for(a in g)if(t.call(g,a)&&l.call(d,g[a],a,g)===c)break};d.addEvent=function(b,g,l,d){if(window.jQuery)if(jQuery(b).on)if(d)jQuery(b).on(g,d,l);else jQuery(b)[g](l);else jQuery(b)[g](l);else{Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector);var c=function(b,g){return b?b.matches(g)?b:c(b.parentElement,g):null},a;b.attachEvent?(a=b.attachEvent,g="on"+g):a=b.addEventListener;b="string"==typeof b?r.querySelectorAll(b):
[b];for(var C=0;C<b.length;C++)d?a.apply(b[C],[g,function(b){var g=b||window.event;(g=c(g.target||g.srcElement,d))&&l.call(g,b)}]):a.apply(b[C],[g,l.bind(b[C])])}};d.getJSON=function(b,g){var l=new XMLHttpRequest;l.open("GET",b,!0);l.onload=function(){if(200<=l.status&&400>l.status){var b=JSON.parse(l.responseText);g(b)}};l.send()};d.removeEvent=function(b,g,l){b.detachEvent?b.detachEvent("on"+g,l):b.removeEventListener(g,l)};d.extend=function(b){a(h.call(arguments,1),function(g){for(var l in g)void 0!==
g[l]&&(b[l]=g[l])});return b};d.isArray=l||function(b){return"[object Array]"===m.call(b)};d.isFunction=function(b){try{return/^\s*\bfunction\b/.test(b)}catch(g){return!1}};d.isArguments=function(b){return!(!b||!t.call(b,"callee"))};d.toArray=function(b){return!b?[]:b.toArray?b.toArray():d.isArray(b)||d.isArguments(b)?h.call(b):d.values(b)};d.values=function(b){var g=[];if(null==b)return g;a(b,function(b){g[g.length]=b});return g};d.identity=function(b){return b};d.include=function(b,l){var d=!1;
if(null==b)return d;if(g&&b.indexOf===g)return-1!=b.indexOf(l);a(b,function(b){if(d||(d=b===l))return c});return d};d.includes=function(b,g){return-1!==b.indexOf(g)}})();var N=function(b,g,l){if(void 0===g)return b;switch(null==l?3:l){case 1:return function(l){return b.call(g,l)};case 2:return function(l,d){return b.call(g,l,d)};case 3:return function(l,d,c){return b.call(g,l,d,c)};case 4:return function(l,d,c,a){return b.call(g,l,d,c,a)}}return function(){return b.apply(g,arguments)}},O=Math.pow(2,
53)-1,P=function(b){return function(g){return null==g?void 0:g[b]}}("length");d.map=d.collect=function(b,g,l){g=null==g?d.identity:d.isFunction(g)?N(g,l,void 0):d.isObject(g)?d.matcher(g):d.property(g);l=P(b);l=!("number"==typeof l&&0<=l&&l<=O)&&d.keys(b);for(var c=(l||b).length,a=Array(c),G=0;G<c;G++){var e=l?l[G]:G;a[G]=g(b[e],e,b)}return a};d.inherit=function(b,g){b.prototype=new g;b.prototype.constructor=b;b.superclass=g.prototype;return b};d.isObject=function(b){return b===Object(b)&&!d.isArray(b)};
d.isEmptyObject=function(b){if(d.isObject(b)){for(var g in b)if(t.call(b,g))return!1;return!0}return!1};d.isUndefined=function(b){return void 0===b};d.isString=function(b){return"[object String]"==m.call(b)};d.isDate=function(b){return"[object Date]"==m.call(b)};d.isNumber=function(b){return"[object Number]"==m.call(b)};d.encodeDates=function(b){d.each(b,function(g,l){d.isDate(g)?b[l]=d.formatDate(g):d.isObject(g)&&(b[l]=d.encodeDates(g))});return b};d.formatDate=function(b){function g(b){return 10>
b?"0"+b:b}return b.getUTCFullYear()+"-"+g(b.getUTCMonth()+1)+"-"+g(b.getUTCDate())+"T"+g(b.getUTCHours())+":"+g(b.getUTCMinutes())+":"+g(b.getUTCSeconds())};d.strip_empty_properties=function(b){var g={};d.each(b,function(b,c){d.isString(b)&&0<b.length&&(g[c]=b)});return g};d.truncate=function(b,g){var l;"string"===typeof b?l=b.slice(0,g):d.isArray(b)?(l=[],d.each(b,function(b){l.push(d.truncate(b,g))})):d.isObject(b)?(l={},d.each(b,function(b,c){l[c]=d.truncate(b,g)})):l=b;return l};d.trim=function(b){return String.prototype.trim?
String(b).trim():this.replace(/^\s+|\s+$/g,"")};d.JSONEncode=function(){return function(b){var g=function(b){var g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};g.lastIndex=0;return g.test(b)?'"'+b.replace(g,function(b){var g=l[b];return"string"===typeof g?g:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'},l=function(b,
d){var c="",a=0,e=a="",e=0,h=c,f=[],k=d[b];switch(typeof k){case "string":return g(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";c+="    ";f=[];if("[object Array]"===m.apply(k)){e=k.length;for(a=0;a<e;a+=1)f[a]=l(a,k)||"null";return e=0===f.length?"[]":c?"[\n"+c+f.join(",\n"+c)+"\n"+h+"]":"["+f.join(",")+"]"}for(a in k)t.call(k,a)&&(e=l(a,k))&&f.push(g(a)+(c?": ":":")+e);return e=0===f.length?"{}":c?"{"+f.join(",")+
""+h+"}":"{"+f.join(",")+"}"}};return l("",{"":b})}}();d.JSONDecode=function(){var b,g,l={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},d,c=function(g){throw{name:"SyntaxError",message:g,at:b,text:d};},a=function(l){l&&l!==g&&c("Expected '"+l+"' instead of '"+g+"'");g=d.charAt(b);b+=1;return g},e=function(){var b;b="";"-"===g&&(b="-",a("-"));for(;"0"<=g&&"9">=g;)b+=g,a();if("."===g)for(b+=".";a()&&"0"<=g&&"9">=g;)b+=g;if("e"===g||"E"===g){b+=g;a();if("-"===g||"+"===g)b+=g,a();for(;"0"<=
g&&"9">=g;)b+=g,a()}b=+b;if(isFinite(b))return b;c("Bad number")},f=function(){var b,d,C="",e;if('"'===g)for(;a();){if('"'===g)return a(),C;if("\\"===g)if(a(),"u"===g){for(d=e=0;4>d;d+=1){b=parseInt(a(),16);if(!isFinite(b))break;e=16*e+b}C+=String.fromCharCode(e)}else if("string"===typeof l[g])C+=l[g];else break;else C+=g}c("Bad string")},h=function(){for(;g&&" ">=g;)a()},k=function(){switch(g){case "t":return a("t"),a("r"),a("u"),a("e"),!0;case "f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case "n":return a("n"),
a("u"),a("l"),a("l"),null}c("Unexpected '"+g+"'")},m;m=function(){h();switch(g){case "{":var b;a:{var l={};if("{"===g){a("{");h();if("}"===g){a("}");b=l;break a}for(;g;){b=f();h();a(":");Object.hasOwnProperty.call(l,b)&&c('Duplicate key "'+b+'"');l[b]=m();h();if("}"===g){a("}");b=l;break a}a(",");h()}}c("Bad object");b=void 0}return b;case "[":a:{b=[];if("["===g){a("[");h();if("]"===g){a("]");break a}for(;g;){b.push(m());h();if("]"===g){a("]");break a}a(",");h()}}c("Bad array");b=void 0}return b;
case '"':return f();case "-":return e();default:return"0"<=g&&"9">=g?e():k()}};return function(l){d=l;b=0;g=" ";l=m();h();g&&c("Syntax error");return l}}();d.base64Encode=function(b){var g,l,a,c,e=0,h=0,f="",f=[];if(!b)return b;b=d.utf8Encode(b);do g=b.charCodeAt(e++),l=b.charCodeAt(e++),a=b.charCodeAt(e++),c=g<<16|l<<8|a,g=c>>18&63,l=c>>12&63,a=c>>6&63,c&=63,f[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);while(e<b.length);f=f.join("");switch(b.length%3){case 1:f=f.slice(0,-2)+"==";break;case 2:f=f.slice(0,-1)+"="}return f};d.utf8Encode=function(b){b=(b+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var g="",l,d,a=0,c;l=d=0;a=b.length;for(c=0;c<a;c++){var e=b.charCodeAt(c),f=null;128>e?d++:f=127<e&&2048>e?String.fromCharCode(e>>6|192,e&63|128):String.fromCharCode(e>>
12|224,e>>6&63|128,e&63|128);null!==f&&(d>l&&(g+=b.substring(l,d)),g+=f,l=d=c+1)}d>l&&(g+=b.substring(l,b.length));return g};d.UUID=function(){var b=function(){for(var b=1*new Date,g=0;b==1*new Date;)g++;return b.toString(16)+g.toString(16)},g=function(b){function g(b,l){var d,c=0;for(d=0;d<l.length;d++)c|=a[d]<<8*d;return b^c}var d,a=[],c=0;for(b=0;b<p.length;b++)d=p.charCodeAt(b),a.unshift(d&255),4<=a.length&&(c=g(c,a),a=[]);0<a.length&&(c=g(c,a));return c.toString(16)};return function(){var l=
(screen.height*screen.width).toString(16);return b()+"-"+Math.random().toString(16).replace(".","")+"-"+g()+"-"+l+"-"+b()}}();d.isBlockedUA=function(){return/(google web preview|baiduspider|yandexbot)/i.test(p)?!0:!1};d.HTTPBuildQuery=function(b,g){var l,a,c=[];"undefined"===typeof g&&(g="&");d.each(b,function(b,g){l=encodeURIComponent(b.toString());a=encodeURIComponent(g);c[c.length]=a+"="+l});return c.join(g)};d.getQueryParam=function(b,g){g=g.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var l=RegExp("[\\?&]"+
g+"=([^&#]*)").exec(b);return null===l||l&&"string"!==typeof l[1]&&l[1].length?"":decodeURIComponent(l[1]).replace(/\+/g," ")};d.cookie={get:function(b){b+="=";for(var g=r.cookie.split(";"),l=0;l<g.length;l++){for(var a=g[l];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(b))return b=a.substring(b.length,a.length),triggermail.config.encodeCookie?d.cookie.decode(b):decodeURIComponent(b)}return null},parse:function(b){var g;try{g=d.JSONDecode(d.cookie.get(b))||{}}catch(a){}return g},set:function(b,
g,a,c){var e="",f="";c&&(e=(e=(e=r.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?e[0]:"")?"; domain=."+e:"");a&&(f=new Date,f.setTime(f.getTime()+864E5*a),f="; expires="+f.toGMTString());g=triggermail.config.encodeCookie?d.cookie.encode(g):encodeURIComponent(g);r.cookie=b+"="+g+f+"; path=/"+e},remove:function(b,g){d.cookie.set(b,"",-1,g)},encode:function(b){b=d.cookie._encoder.encode(b);b=b.replace(/=/g,"");b=encodeURIComponent(b);return b.replace(/%/g,"-")},decode:function(b){if(/^%7B%22.*%22%7D$/.test(b))return decodeURIComponent(b);
b=b.replace(/-/g,"%");b=decodeURIComponent(b);return b=d.cookie._encoder.decode(b)},_encoder:function(){var b=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return{encode:function(b){var a,
d,c,e,f,h;c=b.length;d=0;for(a="";d<c;){e=b.charCodeAt(d++)&255;if(d==c){a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4);a+="==";break}f=b.charCodeAt(d++);if(d==c){a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&
15)<<2);a+="=";break}h=b.charCodeAt(d++);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&15)<<2|(h&192)>>6);a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h&63)}return a},decode:function(g){var a,d,c,e,f;e=g.length;c=0;for(f="";c<e;){do a=b[g.charCodeAt(c++)&
255];while(c<e&&-1==a);if(-1==a)break;do d=b[g.charCodeAt(c++)&255];while(c<e&&-1==d);if(-1==d)break;f+=String.fromCharCode(a<<2|(d&48)>>4);do{a=g.charCodeAt(c++)&255;if(61==a)return f;a=b[a]}while(c<e&&-1==a);if(-1==a)break;f+=String.fromCharCode((d&15)<<4|(a&60)>>2);do{d=g.charCodeAt(c++)&255;if(61==d)return f;d=b[d]}while(c<e&&-1==d);if(-1==d)break;f+=String.fromCharCode((a&3)<<6|d)}return f}}}()};d.register_event=function(){function b(b,a,c){return function(e){var f=e;e=e||g(window.event);var h,
k;"undefined"!==typeof e&&(k=a.call(b,e));d.isFunction(c)&&(h=c(f));e=!0;if(!1===h||!1===k)e=!1;return e}}function g(b){b&&(b.preventDefault=g.preventDefault,b.stopPropagation=g.stopPropagation);return b}g.preventDefault=function(){this.returnValue=!1};g.stopPropagation=function(){this.cancelBubble=!0};return function(g,a,d,c){g?g.addEventListener&&!c?g.addEventListener(a,d,!1):(a="on"+a,g[a]=b(g,d,g[a])):v.error("No valid element provided to register_event")}}();d.dom_query=function(){function b(b,
a){return 0<=(" "+b.className+" ").replace(g," ").indexOf(" "+a+" ")}var g=/[\t\r\n]/g;return function(g){if(!r.getElementsByTagName)return[];g=g.split(" ");for(var a,c=Array(r),e=0;e<g.length;e++)if(a=g[e].replace(/^\s+/,"").replace(/\s+$/,""),-1<a.indexOf("#")){a=a.split("#");var f=a[0],c=r.getElementById(a[1]);if(!c||f&&c.nodeName.toLowerCase()!=f)return[];c=Array(c)}else if(-1<a.indexOf(".")){a=a.split(".");var f=a[0],h=a[1];f||(f="*");a=[];for(var k=0,m=0;m<c.length;m++){var n;n="*"==f?c[m].all?
c[m].all:c[m].getElementsByTagName("*"):c[m].getElementsByTagName(f);for(var y=0;y<n.length;y++)a[k++]=n[y]}c=[];for(k=f=0;k<a.length;k++)a[k].className&&(d.isString(a[k].className)&&b(a[k],h))&&(c[f++]=a[k])}else if(a.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var f=RegExp.$1,p=RegExp.$2,h=RegExp.$3,q=RegExp.$4;f||(f="*");a=[];for(m=k=0;m<c.length;m++){n="*"==f?c[m].all?c[m].all:c[m].getElementsByTagName("*"):c[m].getElementsByTagName(f);for(y=0;y<n.length;y++)a[k++]=n[y]}c=[];f=0;
switch(h){case "=":h=function(b){return b.getAttribute(p)==q};break;case "~":h=function(b){return b.getAttribute(p).match(RegExp("\\b"+q+"\\b"))};break;case "|":h=function(b){return b.getAttribute(p).match(RegExp("^"+q+"-?"))};break;case "^":h=function(b){return 0==b.getAttribute(p).indexOf(q)};break;case "$":h=function(b){return b.getAttribute(p).lastIndexOf(q)==b.getAttribute(p).length-q.length};break;case "*":h=function(b){return-1<b.getAttribute(p).indexOf(q)};break;default:h=function(b){return b.getAttribute(p)}}c=
[];for(k=f=0;k<a.length;k++)h(a[k])&&(c[f++]=a[k])}else{f=a;a=[];for(m=k=0;m<c.length;m++){n=c[m].getElementsByTagName(f);for(y=0;y<n.length;y++)a[k++]=n[y]}c=a}return c}}();d.info={campaignParams:function(){var b="",a={};d.each(["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],function(c){b=d.getQueryParam(r.URL,c);b.length&&(a[c]=b)});return a},searchEngine:function(b){return 0===b.search("https?://(.*)google.([^/?]*)")?"google":0===b.search("https?://(.*)bing.com")?"bing":0===
b.search("https?://(.*)yahoo.com")?"yahoo":0===b.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(b){var a=d.info.searchEngine(b),c={};null!==a&&(c.g_search_engine=a,b=d.getQueryParam(b,"yahoo"!=a?"q":"p"),b.length&&(c.mp_keyword=b));return c},browser:function(){var b=w.vendor||"";return window.opera?d.includes(p,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":d.includes(p,"Chrome")?"Chrome":d.includes(b,"Apple")?d.includes(p,"Mobile")?"Mobile Safari":
"Safari":d.includes(p,"Android")?"Android Mobile":d.includes(p,"Konqueror")?"Konqueror":d.includes(p,"Firefox")?"Firefox":d.includes(p,"MSIE")?"Internet Explorer":d.includes(p,"Gecko")?"Mozilla":""},os:function(){return/Windows/i.test(p)?/Phone/.test(p)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(p)?"iOS":/Android/.test(p)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Mac/i.test(p)?"Mac OS X":/Linux/.test(p)?"Linux":""},device:function(){return/iPhone/.test(p)?"iPhone":/iPad/.test(p)?
"iPad":/iPod/.test(p)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Windows Phone/i.test(p)?"Windows Phone":/Android/.test(p)?"Android":""},referringDomain:function(b){b=b.split("/");return 3<=b.length?b[2]:""},properties:function(){return d.strip_empty_properties({os:d.info.os(),browser:d.info.browser(),device:d.info.device(),mp_lib:"web"})},people_properties:function(){return d.strip_empty_properties({$os:d.info.os(),$browser:d.info.browser()})},pageviewInfo:function(b){return d.strip_empty_properties({mp_page:b,
mp_referrer:r.referrer,mp_browser:d.info.browser(),mp_platform:d.info.os()})}};var v={log:function(){if((y||triggermail.util.cookie.get("_bc_platform_debug"))&&!d.isUndefined(n)&&n)try{n.log.apply(n,arguments)}catch(b){d.each(arguments,function(b){n.log(b)})}},error:function(){if((y||triggermail.util.cookie.get("_bc_platform_debug"))&&!d.isUndefined(n)&&n){var b=["Bluecore error:"].concat(d.toArray(arguments));try{n.error.apply(n,b)}catch(a){d.each(b,function(b){n.error(b)})}}},critical:function(){if(!d.isUndefined(n)&&
n){var b=["Bluecore error:"].concat(d.toArray(arguments));try{n.error.apply(n,b)}catch(a){d.each(b,function(b){n.error(b)})}}}},u=function(){};u.prototype.create_properties=function(){};u.prototype.event_handler=function(){};u.prototype.after_track_handler=function(){};u.prototype.init=function(b){this.mp=b;return this};u.prototype.track=function(b,a,c,e){var f=this,h=d.dom_query(b);if(0==h.length)v.error("The DOM query ("+b+") returned 0 elements");else return d.each(h,function(b){d.register_event(b,
this.override_event,function(b){var d={},h=f.create_properties(c,this),k=f.mp.get_config("track_links_timeout");f.event_handler(b,this,d);window.setTimeout(f.track_callback(e,h,d,!0),k);f.mp.track(a,h,f.track_callback(e,h,d))})},this),!0};u.prototype.track_callback=function(b,a,c,d){d=d||!1;var e=this;return function(){c.callback_fired||(c.callback_fired=!0,b&&!1===b(d,a)||e.after_track_handler(a,c,d))}};u.prototype.create_properties=function(b,a){return"function"===typeof b?b(a):d.extend({},b)};
var F=function(){this.override_event="click"};d.inherit(F,u);F.prototype.create_properties=function(b,a){var c=F.superclass.create_properties.apply(this,arguments);a.href&&(c.url=a.href);return c};F.prototype.event_handler=function(b,a,c){c.new_tab=2===b.which||b.metaKey||"_blank"===a.target;c.href=a.href;c.new_tab||b.preventDefault()};F.prototype.after_track_handler=function(b,a,c){a.new_tab||setTimeout(function(){window.location=a.href},0)};var H=function(){this.override_event="submit"};d.inherit(H,
u);H.prototype.event_handler=function(b,a,c){c.element=a;b.preventDefault()};H.prototype.after_track_handler=function(b,a,c){setTimeout(function(){a.element.submit()},0)};var q=function(b){this.props={};this.campaign_params_saved=!1;this.name=b.cookie_name?"mp_"+b.cookie_name:"mp_"+b.token+"_mixpanel";this.load();this.update_config(b);this.upgrade(b);this.save()};q.prototype.properties=function(){var b={};d.each(this.props,function(a,c){d.include(B,c)||(b[c]=a)});return b};q.prototype.load=function(){if(!this.disabled){var b=
d.cookie.parse(this.name);b&&(this.props=d.extend({},b))}};q.prototype.upgrade=function(b){var a=b.upgrade,c;a&&(c="mp_super_properties","string"===typeof a&&(c=a),a=d.cookie.parse(c),d.cookie.remove(c),d.cookie.remove(c,!0),a&&(this.props=d.extend(this.props,a.all,a.events)));if(!b.cookie_name&&"mixpanel"!==b.name&&(c="mp_"+b.token+"_"+b.name,a=d.cookie.parse(c)))d.cookie.remove(c),d.cookie.remove(c,!0),this.register_once(a)};q.prototype.save=function(){this.disabled||d.cookie.set(this.name,d.JSONEncode(this.props),
this.expire_days,this.cross_subdomain)};q.prototype.remove=function(){d.cookie.remove(this.name,!1);d.cookie.remove(this.name,!0)};q.prototype.clear=function(){this.remove();this.props={}};q.prototype.register_once=function(b,a,c){return d.isObject(b)?("undefined"===typeof a&&(a="None"),this.expire_days="undefined"===typeof c?this.default_expiry:c,d.each(b,function(b,c){if(!this.props[c]||this.props[c]===a)this.props[c]=b},this),this.save(),!0):!1};q.prototype.register=function(b,a){return d.isObject(b)?
(this.expire_days="undefined"===typeof a?this.default_expiry:a,d.extend(this.props,b),this.save(),!0):!1};q.prototype.unregister=function(b){b in this.props&&(delete this.props[b],this.save())};q.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(d.info.campaignParams()),this.campaign_params_saved=!0)};q.prototype.update_search_keyword=function(b){this.register(d.info.searchInfo(b))};q.prototype.update_referrer_info=function(b){this.register_once({$initial_referrer:b||
"$direct",$initial_referring_domain:d.info.referringDomain(b)||"$direct"},"")};q.prototype.get_referrer_info=function(){return d.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})};q.prototype.safe_merge=function(b){d.each(this.props,function(a,c){c in b||(b[c]=a)});return b};q.prototype.update_config=function(b){this.default_expiry=this.expire_days=b.cookie_expiration;this.set_disabled(b.disable_cookie);this.set_cross_subdomain(b.cross_subdomain_cookie)};
q.prototype.set_disabled=function(b){(this.disabled=b)&&this.remove()};q.prototype.set_cross_subdomain=function(b){b!==this.cross_subdomain&&(this.cross_subdomain=b,this.remove(),this.save())};q.prototype.get_cross_subdomain=function(){return this.cross_subdomain};q.prototype._add_to_people_queue=function(b,a){var c=this._get_queue_key(b),e=a[b],f=this._get_or_create_queue("$set"),h=this._get_or_create_queue("$add"),k=this._get_or_create_queue("$append",[]);"__mps"===c?(d.extend(f,e),this._pop_from_people_queue("$add",
e)):"__mpa"===c?d.each(e,function(b,a){a in f?f[a]+=b:(a in h||(h[a]=0),h[a]+=b)},this):"__mpap"===c&&k.push(e);v.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):");v.log(a);this.save()};q.prototype._pop_from_people_queue=function(b,a){var c=this._get_queue(b);d.isUndefined(c)||(d.each(a,function(b,a){delete c[a]},this),this.save())};q.prototype._get_queue_key=function(b){if("$set"===b)return"__mps";if("$add"===b)return"__mpa";if("$append"===b)return"__mpap";v.error("Invalid queue:",b)};q.prototype._get_queue=
function(b){return this.props[this._get_queue_key(b)]};q.prototype._get_or_create_queue=function(b,a){var c=this._get_queue_key(b);a=d.isUndefined(a)?{}:a;return this.props[c]||(this.props[c]=a)};var I=function(b,a,e){var f,h="triggermail.lytics"===e?c:c[e];if(h&&!d.isArray(h))v.error("You have already initialized "+e);else return f=new k,f._init(b,a,e),f.people=new x,f.people._init(f),y=y||f.get_config("debug"),d.isUndefined(h)||(f._execute_array.call(f.people,h.people),f._execute_array(h)),f},k=
function(){};k.prototype.init=function(b,a,d){if("undefined"===typeof d)v.error("You must name your new library: init(token, config, name)");else if("triggermail.lytics"===d)v.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");else return b=I(b,a,d),c[d]=b,b._loaded(),b};k.prototype._init=function(b,a,c){this.__loaded=!0;this.config={};this.set_config(d.extend({},L,a,{name:c,token:b,callback_fn:("triggermail.lytics"===c?c:"triggermail.lytics."+c)+
"._jsc"}));this._jsc=function(){};this.__dom_loaded_queue=[];this.__request_queue=[];this.__disabled_events=[];this._flags={disable_all_events:!1,identify_called:!1};this.cookie=new q(this.config);this.register_once({distinct_id:d.UUID()},"")};k.prototype._loaded=function(){this.get_config("loaded")(this);this.get_config("track_pageview")&&this.track_pageview()};k.prototype._dom_loaded=function(){d.each(this.__dom_loaded_queue,function(b){this._track_dom.apply(this,b)},this);d.each(this.__request_queue,
function(b){this._send_request.apply(this,b)},this);delete this.__dom_loaded_queue;delete this.__request_queue};k.prototype._track_dom=function(b,a){if(this.get_config("img"))return v.error("You can't use DOM tracking functions with img = true."),!1;if(!J)return this.__dom_loaded_queue.push([b,a]),!1;var c=(new b).init(this);return c.track.apply(c,a)};k.prototype._prepare_callback=function(b,a){if(d.isUndefined(b))return null;if(A)return function(c){b(c,a)};var c=this._jsc,e=""+Math.floor(1E8*Math.random()),
f=this.get_config("callback_fn")+'["'+e+'"]';c[e]=function(d){delete c[e];b(d,a)};return f};k.prototype._send_request=function(b,a,c){if(z)this.__request_queue.push(arguments);else{var e=this.get_config("verbose");this.get_config("test")&&(a.test=1);e&&(a.verbose=1);this.get_config("img")&&(a.img=1);c&&!A&&(a.callback=c);a.ip=this.get_config("ip")?1:0;a._=(new Date).getTime().toString();if("img"in a){var f=r.createElement("img");f.src=b;r.body.appendChild(f)}else if(A){var h=new XMLHttpRequest;h.open("POST",
b,!0);h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");h.withCredentials=!0;h.onreadystatechange=function(b){4===h.readyState&&(200===h.status||202===h.status?c&&(e?c(d.JSONDecode(h.responseText)):c(Number(h.responseText))):(b="Bad HTTP status: "+h.status+" "+h.statusText,v.error(b),c&&(e?c({status:0,error:b}):c(0))))};h.send(d.HTTPBuildQuery(a))}else{b+="?"+d.HTTPBuildQuery(a);f=r.createElement("script");f.type="text/javascript";f.async=!0;f.defer=!0;f.src=b;var k=r.getElementsByTagName("script")[0];
k.parentNode.insertBefore(f,k)}}};k.prototype._execute_array=function(b){var a,c=[],e=[],f=[];d.each(b,function(b){b&&(a=b[0],"function"===typeof b?b.call(this):d.isArray(b)&&"alias"===a?c.push(b):d.isArray(b)&&-1!=a.indexOf("track")&&"function"===typeof this[a]?f.push(b):e.push(b))},this);b=function(b,a){d.each(b,function(b){this[b[0]].apply(this,b.slice(1))},a)};b(c,this);b(e,this);b(f,this)};k.prototype.push=function(b){this._execute_array([b])};k.prototype.disable=function(b){"undefined"===typeof b?
this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(b)};k.prototype.track=function(b,a,c){if("undefined"===typeof b)v.error("No event name provided to mixpanel.track");else{a=a||{};a.token=a.token||this.get_config("token");triggermail.config.eventSource&&(a.event_source=triggermail.config.eventSource);this.cookie.update_search_keyword(r.referrer);this.get_config("store_google")&&this.cookie.update_campaign_params();this.get_config("save_referrer")&&this.cookie.update_referrer_info(r.referrer);
a=d.extend({},d.info.properties(),this.cookie.properties(),a);delete a.ch;(triggermail.util.strip_props_before_send||function(b){return b})(a);a={event:b,properties:a};y&&(a.validate=1);a=d.truncate(a,1023);var e=d.JSONEncode(a),e=d.base64Encode(e);v.log("BLUECORE REQUEST:");v.log(a);payload={data:e};-1!=this.get_distinct_id().indexOf("live_demo")?(payload.live_demo=!0,track_path=this.get_config("api_host")+"/templates/demo_track/"+b):-1!=this.get_distinct_id().indexOf("event_stream")?(payload.event_stream=
!0,track_path=this.get_config("api_host")+"/templates/event_stream_track/"+b):track_path=this.get_config("api_host")+"/track/"+b;this._send_request(track_path,payload,this._prepare_callback(c,a));return a}};k.prototype.track_pageview=function(b){"undefined"===typeof b&&(b=r.location.href);this.track("mp_page_view",d.info.pageviewInfo(b))};k.prototype.track_links=function(){return this._track_dom.call(this,F,arguments)};k.prototype.track_forms=function(){return this._track_dom.call(this,H,arguments)};
k.prototype.register=function(b,a){this.cookie.register(b,a)};k.prototype.register_once=function(b,a,c){this.cookie.register_once(b,a,c)};k.prototype.unregister=function(b){this.cookie.unregister(b)};k.prototype._register_single=function(b,a){var c={};c[b]=a;this.register(c)};k.prototype.identify=function(b,a,c,d){b!=this.get_distinct_id()&&b!=this.get_property("__alias")&&(this.unregister("__alias"),this._register_single("distinct_id",b));this._flags.identify_called=!0;this.people._flush(a,c,d)};
k.prototype.get_distinct_id=function(){return this.get_property("distinct_id")};k.prototype.alias=function(b,a){if(b===this.get_property("$people_distinct_id"))return v.critical("Attempting to create alias for existing People user - aborting."),-2;var c=this;d.isUndefined(a)&&(a=this.get_distinct_id());if(b!==a)return this._register_single("__alias",b),this.track("$create_alias",{alias:b,distinct_id:a},function(a){c.identify(b)});v.error("alias matches current distinct_id - skipping api call.");this.identify(b);
return-1};k.prototype.name_tag=function(b){this._register_single("mp_name_tag",b)};k.prototype.set_config=function(b){d.isObject(b)&&(d.extend(this.config,b),this.cookie&&this.cookie.update_config(this.config),y=y||this.get_config("debug"))};k.prototype.get_config=function(b){return this.config[b]};k.prototype.get_property=function(b){return this.cookie.props[b]};k.prototype.toString=function(){var b=this.get_config("name");"triggermail.lytics"!==b&&(b="triggermail.lytics."+b);return b};var x=function(){};
x.prototype._init=function(b){this._mixpanel=b};x.prototype.set=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,function(b,a){"$distinct_id"==a||"$token"==a||(f[a]=b)}),c=a):f[b]=a;this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(r.referrer);f=d.extend({},d.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),f);e.$set=f;return this._send_request(e,c)};x.prototype.increment=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,function(b,a){"$distinct_id"==
a||"$token"==a||(isNaN(parseFloat(b))?v.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):f[a]=b)}),c=a):(d.isUndefined(a)&&(a=1),f[b]=a);e.$add=f;return this._send_request(e,c)};x.prototype.append=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,function(b,a){"$distinct_id"==a||"$token"==a||(f[a]=b)}),c=a):f[b]=a;e.$append=f;return this._send_request(e,c)};x.prototype.track_charge=function(b,a,c){if(!d.isNumber(b)&&(b=parseFloat(b),isNaN(b))){v.error("Invalid value passed to mixpanel.people.track_charge - must be a number");
return}return this.append("$transactions",d.extend({$amount:b},a),c)};x.prototype.clear_charges=function(b){return this.set("$transactions",[],b)};x.prototype.delete_user=function(){if(this._identify_called()){var b={$delete:this._mixpanel.get_distinct_id()};return this._send_request(b)}v.error("mixpanel.people.delete_user() requires you to call identify() first")};x.prototype.toString=function(){return this._mixpanel.toString()+".people"};x.prototype._send_request=function(b,a){b.$token=this._get_config("token");
b.$distinct_id=this._mixpanel.get_distinct_id();var c=d.encodeDates(b),e=d.truncate(c,255),c=d.JSONEncode(c),c=d.base64Encode(c);if(!this._identify_called())return this._enqueue(b),d.isUndefined(a)||(this._get_config("verbose")?a({status:-1,error:null}):a(-1)),e;v.log("BLUECORE PEOPLE REQUEST:");v.log(e);this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:c},this._mixpanel._prepare_callback(a,e));return e};x.prototype._get_config=function(b){return this._mixpanel.get_config(b)};
x.prototype._identify_called=function(){return!0===this._mixpanel._flags.identify_called};x.prototype._enqueue=function(b){"$set"in b?this._mixpanel.cookie._add_to_people_queue("$set",b):"$add"in b?this._mixpanel.cookie._add_to_people_queue("$add",b):"$append"in b?this._mixpanel.cookie._add_to_people_queue("$append",b):v.error("Invalid call to _enqueue():",b)};x.prototype._flush=function(b,a,c){var e=this,f=d.extend({},this._mixpanel.cookie._get_queue("$set")),h=d.extend({},this._mixpanel.cookie._get_queue("$add")),
k=this._mixpanel.cookie._get_queue("$append");!d.isUndefined(f)&&(d.isObject(f)&&!d.isEmptyObject(f))&&(e._mixpanel.cookie._pop_from_people_queue("$set",f),this.set(f,function(a,c){0==a&&e._mixpanel.cookie._add_to_people_queue("$set",f);d.isUndefined(b)||b(a,c)}));!d.isUndefined(h)&&(d.isObject(h)&&!d.isEmptyObject(h))&&(e._mixpanel.cookie._pop_from_people_queue("$add",h),this.increment(h,function(b,c){0==b&&e._mixpanel.cookie._add_to_people_queue("$add",h);d.isUndefined(a)||a(b,c)}));if(!d.isUndefined(k)&&
d.isArray(k)&&k.length)for(var m=k.length-1;0<=m;m--){var n=k.pop();e.append(n,function(b,a){0==b&&e._mixpanel.cookie._add_to_people_queue("$append",n);d.isUndefined(c)||c(b,a)})}};d.toArray=d.toArray;d.isObject=d.isObject;d.JSONEncode=d.JSONEncode;d.JSONDecode=d.JSONDecode;d.isEmptyObject=d.isEmptyObject;k.prototype.init=k.prototype.init;k.prototype.disable=k.prototype.disable;k.prototype.track=k.prototype.track;k.prototype.track_links=k.prototype.track_links;k.prototype.track_forms=k.prototype.track_forms;
k.prototype.track_pageview=k.prototype.track_pageview;k.prototype.register=k.prototype.register;k.prototype.register_once=k.prototype.register_once;k.prototype.unregister=k.prototype.unregister;k.prototype.identify=k.prototype.identify;k.prototype.alias=k.prototype.alias;k.prototype.name_tag=k.prototype.name_tag;k.prototype.set_config=k.prototype.set_config;k.prototype.get_config=k.prototype.get_config;k.prototype.get_property=k.prototype.get_property;k.prototype.get_distinct_id=k.prototype.get_distinct_id;
k.prototype.toString=k.prototype.toString;q.prototype.properties=q.prototype.properties;q.prototype.update_search_keyword=q.prototype.update_search_keyword;q.prototype.update_referrer_info=q.prototype.update_referrer_info;q.prototype.get_cross_subdomain=q.prototype.get_cross_subdomain;q.prototype.clear=q.prototype.clear;x.prototype.set=x.prototype.set;x.prototype.increment=x.prototype.increment;x.prototype.append=x.prototype.append;x.prototype.track_charge=x.prototype.track_charge;x.prototype.clear_charges=
x.prototype.clear_charges;x.prototype.delete_user=x.prototype.delete_user;x.prototype.toString=x.prototype.toString;if(d.isUndefined(c))v.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");else if(c.__loaded||c.config&&c.cookie)v.error("Mixpanel library has already been downloaded at least once.");else if(1.1>f)v.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");
else{var E={};d.each(c._i,function(b){var a;b&&d.isArray(b)&&(a=b[b.length-1],b=I.apply(this,b),E[a]=b)});var Q=function(){d.each(E,function(b,a){"triggermail.lytics"!==a&&(c[a]=b)});c._=d};c.init=function(b,a,d){d?c[d]||(c[d]=E[d]=I(b,a,d),c[d]._loaded()):(d=c,E["triggermail.lytics"]?d=E["triggermail.lytics"]:b&&(d=I(b,a,"triggermail.lytics")),window["triggermail.lytics"]=c=d,Q())};c.init();d.each(E,function(b){b._loaded()});if(r.addEventListener)"complete"==r.readyState?a():r.addEventListener("DOMContentLoaded",
a,!1);else if(r.attachEvent){r.attachEvent("onreadystatechange",a);f=!1;try{f=null==window.frameElement}catch(R){}if(r.documentElement.doScroll&&f){var K=function(){try{r.documentElement.doScroll("left")}catch(b){setTimeout(K,1);return}a()};K()}}d.register_event(window,"load",a,!0)}})(window.triggermail.lytics);
(function(){(function(c,a){for(var e in a)a.hasOwnProperty(e)&&(c[e]=a[e]);return c})(triggermail,function(){var c=function(a,c){var f=a.obem;"undefined"!=typeof f&&""!=f&&"undefined"==typeof triggermail.lytics.get_property("obem")&&(triggermail.lytics.register({OBFUSCATED_EMAIL_PROPERTY:f},365),triggermail.track("identify",{customer:a}));f=a.email;if(!(void 0==f||""==f)){if(!0!==c&&(f=triggermail.core.sanitizer.sanitize("email",f),!f))return;var h=triggermail.lytics.get_property("email");if(!(triggermail.util.isValidEmail(h)&&
h!=f))return f!=triggermail.lytics.get_property("email")&&(triggermail.lytics.register({email:f},365),triggermail.track("identify",{customer:a})),a}};return{track:function(a,c){var f=triggermail.lytics._.extend({},c);triggermail.lytics._.extend(c,triggermail.lytics.cookie.props);try{c.url=window.location.href.slice(0,899),-1<c.url.indexOf("s.thebrighttag")&&delete c.url}catch(h){}"undefined"!=typeof c.url&&-1<c.url.indexOf("/eton/")&&(c.distinct_id=ETON_DISTINCT_ID);if(("unsubscribe"==a||"optin"==
a)&&f.email)c.email=f.email;"page_view"!=a&&triggermail.lytics.track(a,c);triggermail.lytics.get_distinct_id()&&(c.distinct_id=triggermail.lytics.get_distinct_id());try{!0===triggermail.integ.debug&&console.debug(a,c)}catch(m){}},add_to_cart:function(a){return this.track("add_to_cart",{products:[a]})},remove_from_cart:function(a){return this.track("remove_from_cart",{products:[a]})},wishlist:function(a){return this.track("wishlist",{products:[a]})},view_cart:function(a){return this.track("viewed_cart",
a)},stop:function(a){return this.track("stop",a)},page:function(a){return this.track("page_view",a)},purchase:function(a){return this.track("purchase",a)},checkout_start:function(a){return this.track("checkout_start",a)},view:function(a,c){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",""));var f=triggermail.lytics._.extend(c||{},{products:[a]});return this.track("viewed_product",f)},view_content:function(a,c){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",
""));var f=triggermail.lytics._.extend(c||{},{contents:[a]});return this.track("viewed_content",f)},search:function(a){return this.track("search",a)},browse_category:function(a){return this.track("browse_category",{browse_properties:a})},identify:function(a,e){return c(a,e)},subscribe:function(a){a.source="newsletter";return c(a)},unsubscribe:function(a){return this.track("unsubscribe",a)},optin:function(a){return this.track("optin",a)},customer_patch:function(a){return this.track("customer_patch",
{customer:a})},patch:function(a){return this.track("patch",a)},merge:function(a){return this.track("merge",a)},eton_show:function(a){return this.track("eton_show",a)},custom:function(a,c){return this.track(a,c)},init:function(a){},exception:function(a){var c={};triggermail.lytics._.extend(c,triggermail.lytics._.info.properties());try{c.url=window.location.href,-1<c.url.indexOf("s.thebrighttag")&&delete c.url,c.message=a.message}catch(f){}c.error=a;this.track("exception",c)},EMAIL_ADDRESS_PROPERTY:"email_address",
PAGE_VIEW:"page_view",MAX_PROPERTY_LENGTH:1024}}());triggermail.identifySource={ACCOUNT_REGISTER:"account register",ACCOUNT_LOGIN:"account login",EMAIL_CAPTURE_POPUP:"email capture popup",EMAIL_SIGNUP:"email signup",SITE_VARIABLE:"site variable",CHECKOUT_FLOW:"checkout flow",CUSTOM:"custom",ESP_EMAIL_APPEND:"esp email append",OBEM_EMAIL_APPEND:"obem email append",JUSTUNO:"justuno",BLUECORE_PURCHASE_PIXEL:"bluecore purchase pixel"};triggermail.util=function(){return{price:function(c){return parseFloat((c+
"").replace(/[^0-9\.]/g,""))},unique:function(c){for(var a={},e=0;e<c.length;e++)a[c[e]]=!0;return triggermail.lytics._.map(a,function(a,c){return c})},slugify:function(c){return c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},serializeForm:function(c){var a={};c=c.serializeArray();$.each(c,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""});return a},getUrlParam:function(c){c=c.replace(/[\[]/,
"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+c+"=([^&#]*)").exec(window.location.search);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))},isMobile:function(){var c=!1,a="iphone;ipad;android;blackberry;nokia;opera mini;windows mobile;windows phone;iemobile".split(";"),e;for(e in a)0<navigator.userAgent.toLowerCase().indexOf(a[e].toLowerCase())&&(c=!0);return c},getParamFromQueryString:function(c,a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(c)||[,null])[1])},trimString:function(c,
a){return triggermail.lytics._.trim(c).substring(0,a)},htmlToText:function(c){var a=document.createElement("p");a.innerHTML=c;return a.textContent||a.innerText||""},isAnonymousUser:function(){var c=triggermail.lytics.get_property(triggermail.core.EMAIL_ADDRESS_PROPERTY);return!this.isValidEmail(c)},emRegex:/\S+@\S+\.\S+/,isValidEmail:function(c){return triggermail.util.emRegex.test(c)},validateAndIdentify:function(c,a,e){this.isValidEmail(c)&&triggermail.identify({email:c,source:a,source_detail:e})},
findEmail:function(c,a){try{return"undefined"==typeof a&&(a=triggermail.util.emRegex),a.exec(c).pop()}catch(e){}},hashCode:function(c){var a=0,e,f;if(0==c.length)return a;for(e=0;e<c.length;e++)f=c.charCodeAt(e),a=(a<<5)-a+f,a&=a;return a},productHash:function(c){c=this.sanitizeProductName(c[TriggerMail.PRODUCT_NAME_PROPERTY]);return this.hashCode(c)},_getbyte64:function(c,a){_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var e=_ALPHA.indexOf(c.charAt(a));if(-1===e)throw"Cannot decode base64";
return e},b64decode:function(c){var a=0,e,f,h=c.length,m=[];c=String(c);if(0===h)return c;if(0!==h%4)throw"Cannot decode base64";"="===c.charAt(h-1)&&(a=1,"="===c.charAt(h-2)&&(a=2),h-=4);for(e=0;e<h;e+=4)f=this._getbyte64(c,e)<<18|this._getbyte64(c,e+1)<<12|this._getbyte64(c,e+2)<<6|this._getbyte64(c,e+3),m.push(String.fromCharCode(f>>16,f>>8&255,f&255));switch(a){case 1:f=this._getbyte64(c,e)<<18|this._getbyte64(c,e+1)<<12|this._getbyte64(c,e+2)<<6;m.push(String.fromCharCode(f>>16,f>>8&255));break;
case 2:f=this._getbyte64(c,e)<<18|this._getbyte64(c,e+1)<<12,m.push(String.fromCharCode(f>>16))}return m.join("")},wrapEvent:function(c){var a=Array.prototype.slice.call(arguments,1);return function(){try{return c.apply(this,a.concat(Array.prototype.slice.call(arguments,0)))}catch(e){triggermail.exception(e)}}},removeURLParam:function(c,a){return triggermail.util.updateURLParams(c,a,!1)},keepURLParam:function(c,a){return triggermail.util.updateURLParams(c,a,!0)},updateURLParams:function(c,a,e){var f=
c.split("?")[0],h=[],h=-1!==c.indexOf("?")?c.split("?")[1]:"";if(""!==h){for(var h=h.split("&"),m=h.length-1;0<=m;m-=1)c=h[m].split("=")[0],e?triggermail.lytics._.isArray(a)?-1==a.indexOf(c)&&h.splice(m,1):c!=a&&h.splice(m,1):triggermail.lytics._.isArray(a)?-1<a.indexOf(c)&&h.splice(m,1):c==a&&h.splice(m,1);f+=0<h.length?"?"+h.join("&"):""}return f},getArrayElementFromQueryString:function(c,a){var e=[];c||(c=location.href);a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var f=RegExp(a+"=([^&#]+)",
"ig");;){var h=f.exec(c);if(h&&h[1])e.push(h[1]);else break}return e.length?1==e.length?e[0]:e:null},executeOnLoad:function(c,a,e,f,h,m){var t=e||3,n=f||500,w=h||!1;e=m||function(){};var r=function(a,c){try{var e=c.shift();if("undefined"!==typeof a[e]&&a[e])return 0<c.length?r(a[e],c):a[e]}catch(f){}return null};if(w&&0<triggermail.lytics._.dom_query(c).length||r(window,c.split(".")))try{a()}catch(p){}else if(0<t)try{t-=1,setTimeout(function(){triggermail.util.wrapEvent(function(){triggermail.util.executeOnLoad(c,
a,t,f,w)},c,a,t,n,w)()},n)}catch(B){}else try{e()}catch(u){}},sanitizeSearchTerm:function(c){return c.replace(/[^a-z\d\s:]+/ig,"")},registerAndMergeOpaqueId:function(c){"undefined"!==typeof c&&c&&!triggermail.lytics.cookie.props.tm_merged&&(triggermail.track("merge",{merge:{source:triggermail.lytics.cookie.props.distinct_id,destination:c}}),triggermail.lytics.cookie.props.tm_merged=!0,triggermail.lytics.cookie.props.distinct_id=c,triggermail.lytics.cookie.save())}}}();triggermail.util.cookie=triggermail.lytics._.cookie;
triggermail.util.encode=triggermail.lytics._.JSONEncode;triggermail.util.decode=triggermail.lytics._.JSONDecode;triggermail.demo=function(){var c=triggermail.lytics.get_distinct_id();-1==c.indexOf("live_demo")&&(triggermail.lytics._register_single("distinct_id","live_demo_"+c),c=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({live_demo:!0,cookie_expiration:1});window.open("http://www.bluecore.com/api/templates/live_demo/"+triggermail.Partner.keys.lytics.p+"/"+c)};triggermail.event_stream=
function(){var c=triggermail.lytics.get_distinct_id();-1==c.indexOf("event_stream")&&(triggermail.lytics._register_single("distinct_id","event_stream_"+c),c=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({event_stream:!0,cookie_expiration:1});window.open("http://www.bluecore.com/api/templates/event_stream/"+triggermail.Partner.keys.lytics.p+"/"+c)};triggermail.util.walk=function(c,a){a(c);for(c=c.firstChild;c;)walk(c,a),c=c.nextSibling};triggermail.util.walkUntil=function(c,
a,e){ret=a(c);if(!0===e(ret))return ret;for(c=c.firstChild;c;)walk(c,a),c=c.nextSibling};triggermail.insanetiego=function(){return{inject_div:function(){$("body").append('<div id="insanetiego" style="position:fixed;bottom:0;width:100%;background:#D8E7ED;height:300px;overflow:scroll;z-index:2000;border-top-style:solid;border-top-width:5px;"></div>')},remove_div:function(){$("#insanetiego").remove()},debug:function(){triggermail.util.cookie.set("tm_debug",!0);triggermail.integ.debug=!0;this.inject_div()},
undebug:function(){triggermail.util.cookie.set("tm_debug",!1);triggermail.integ.debug=!1}}}();triggermail.core={};triggermail.core.sanitizer=function(){return{sanitize:function(c,a){if("email"==c){var e;e=/\S+@\S+\.\S+/.test(a)?a:null;return e}return a?a:""}}}()})();
triggermail.integ=function(){return{init:function(){if(!triggermail.util.getUrlParam("bluecore_do_not_track")){"undefined"!=typeof triggermail.Partner.init?triggermail.Partner.init():triggermail.integ.partnerInit();try{triggermail.integ.checkLoop()}catch(c){}}},partnerInit:function(c){var a=triggermail.Partner;if(!("undefined"==typeof c&&(triggermail.lytics._.dom_query(".translated-rtl, .translated-rtl, #goog-gt-tt").length||triggermail.lytics._.dom_query('meta[http-equiv="X-Translated-By"]').length))){try{a.trackProductView()}catch(e){e.location=
"trackProductView",triggermail.exception(e)}try{a.trackAddToCart()}catch(f){f.location="trackAddToCart",triggermail.exception(f)}try{a.trackCheckout()}catch(h){h.location="trackCheckout",triggermail.exception(h)}try{a.watchEmail()}catch(m){m.location="watchEmail",triggermail.exception(m)}if(a.hasOwnProperty("trackRemoveFromCart"))try{a.trackRemoveFromCart()}catch(t){t.location="trackRemoveFromCart",triggermail.exception(t)}if(a.hasOwnProperty("trackCheckoutStart"))try{a.trackCheckoutStart()}catch(n){n.location=
"trackCheckoutStart",triggermail.exception(n)}if(a.hasOwnProperty("trackUnsubscribe"))try{a.trackUnsubscribe()}catch(w){w.location="trackUnsubscribe",triggermail.exception(w)}if(a.hasOwnProperty("trackSubscribe"))try{a.trackSubscribe()}catch(r){r.location="trackSubscribe",triggermail.exception(r)}if(a.hasOwnProperty("trackSearch"))try{a.trackSearch()}catch(p){p.location="trackSearch",triggermail.exception(p)}if(a.hasOwnProperty("trackBrowseCategory"))try{a.trackBrowseCategory()}catch(B){B.location=
"trackBrowseCategory",triggermail.exception(B)}if(a.hasOwnProperty("trackWishlist"))try{a.trackWishlist()}catch(u){u.location="trackWishlist",triggermail.exception(u)}if(a.hasOwnProperty("trackContentView"))try{a.trackContentView()}catch(s){s.location="trackContentView",triggermail.exception(s)}if(a.hasOwnProperty("trackStop"))try{a.trackStop()}catch(D){D.location="trackStop",triggermail.exception(D)}if(triggermail.Partner.hasOwnProperty("trackCustom"))try{triggermail.Partner.trackCustom()}catch(A){triggermail.exception(A)}}},
checkLoop:function(){if("undefined"==typeof triggermail.Partner.disableEmailAppendPickup||!1==triggermail.Partner.disableEmailAppendPickup){for(var c=window.location.search.split("&"),a=0;a<c.length;a++){try{var e=triggermail.util.b64decode(decodeURIComponent(c[a].split("=").slice(1).join("=")))}catch(f){}if(e&&/^(([^<>{}()\[\]\.,;:\s@\"]+(\.[^<>{}()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>{}()[\]\.,;:\s@\"]+\.)+[^<>{}()[\]\.,;:\s@\"]{2,})/.test(e)&&triggermail.util.isValidEmail(e)){triggermail.identify({email:e,
source:triggermail.identifySource.ESP_EMAIL_EVENT,source_detail:"encoded"});return}}c=triggermail.util.getUrlParam("tme");if(0<c.length){triggermail.identify({email:c,source:triggermail.identifySource.ESP_EMAIL_APPEND,source_detail:"tme"},!0);return}if((c=decodeURIComponent(location.search).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)||decodeURIComponent(location.hash).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi))&&triggermail.util.isValidEmail(c[0])){triggermail.identify({email:c[0],
source:triggermail.identifySource.ESP_EMAIL_APPEND,source_detail:"plain text"});return}}c=triggermail.util.getUrlParam("obem");"undefined"!=typeof c&&""!=c&&triggermail.identify({obem:c,source:triggermail.identifySource.OBEM_EMAIL_APPEND});0<triggermail.lytics._.dom_query("#bluecore_purchase_pixel").length&&"undefined"!=typeof triggermail.lytics._.dom_query("#bluecore_purchase_pixel")[0]&&(c=triggermail.lytics._.dom_query("#bluecore_purchase_pixel")[0].src,c=triggermail.util.getParamFromQueryString(c,
"email"),triggermail.identify({email:c,source:triggermail.identifySource.BLUECORE_PURCHASE_PIXEL}));triggermail.lytics._.addEvent(document,"bc:identify",triggermail.util.wrapEvent(function(a,c){triggermail.util.isValidEmail(c.email)&&triggermail.identify({email:c.email,source:triggermail.identifySource.CUSTOM,source_detail:"dom event"})}))}}}();
triggermail.integ.ProductFetcher=__tmClass.extend({name:function(){return this._name},readOg:function(c){},category:function(){return this._category},color:function(){return this._color},size:function(){return this._size},price:function(){return this._price},brand:function(){return this._brand},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},out_of_stock:function(){return!1},tags:function(){return this._tags},to_dict:function(){try{var c={name:triggermail.core.sanitizer.sanitize("name",
this.name()),category:triggermail.core.sanitizer.sanitize("category",this.category()),size:triggermail.core.sanitizer.sanitize("size",this.size()),price:triggermail.core.sanitizer.sanitize("price",this.price()),brand:triggermail.core.sanitizer.sanitize("brand",this.brand()),id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),url:triggermail.core.sanitizer.sanitize("url",this.url()),out_of_stock:this.out_of_stock(),tags:this.tags(),
color:triggermail.core.sanitizer.sanitize("color",this.color())},a;for(a in c)(""===c[a]||!1==c[a])&&"out_of_stock"!=a&&delete c[a];triggermail.lytics._.extend(c,this.extra_props());return c}catch(e){e.location="product_fetcher",triggermail.exception(e)}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}});
triggermail.integ.ContentFetcher=__tmClass.extend({name:function(){return this._name},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},title:function(){return this._title},to_dict:function(){try{var c={id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),name:triggermail.core.sanitizer.sanitize("name",this.name()),title:triggermail.core.sanitizer.sanitize("title",this.title()),url:triggermail.core.sanitizer.sanitize("url",
this.url())},a;for(a in c)(""===c[a]||!1==c[a])&&delete c[a];triggermail.lytics._.extend(c,this.extra_props());return c}catch(e){e.location="content_fetcher",triggermail.exception(e)}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}});triggermail.integ.initServices=function(){triggermail.lytics.init(triggermail.integ.keys.lytics);triggermail.lytics=window["triggermail.lytics"];triggermail.lytics.set_config({save_referrer:!1,store_google:!1,debug:triggermail.integ.debug})};
(function(){function c(a,c){null==a[c]?null!=a[c+"_amount"]&&(a[c]=triggermail.util.price(a[c+"_amount"])):a[c]=triggermail.util.price(a[c]);null==a[c+"_amount"]?null!=a[c]&&(a[c+"_amount"]=triggermail.util.price(a[c])):a[c+"_amount"]=triggermail.util.price(a[c+"_amount"]);null!=a[c]&&null==a[c+"_currency"]&&(a[c+"_currency"]="USD");return a}var a={},a=function(){for(var a=document.getElementsByTagName("META"),c={},e=0;e<a.length;e++){var f=a[e],w=f.getAttribute("property");if(w&&(w=w.match(/^product:(.*)$/i)))w=
w[1],w=w.replace(":","_"),c[w]=f.getAttribute("content")}return c}(),e=function(a,e){var f=e||{},n;for(n in a){var w=f,r=n,p;a:{p=a[n];for(var B=0;B<p.length;B++){var u;u=p[B][0];for(var s=p[B][1],D=document.getElementsByTagName("META"),A=[],z=0;z<D.length;z++){var d=D[z],y=d.getAttribute(u);y&&y.toLowerCase()==s.toLowerCase()&&A.push(d.getAttribute("content"))}u=A;if(0<u.length){p=u[0];break a}}p=null}w[r]=p}c(f,"price");c(f,"sale_price");c(f,"original_price");null!=f.availability&&(f.out_of_stock=
"oos"==f.availability||"pending"==f.availability?!0:!1);return f}({type:[["property","og:type"]],name:[["property","og:title"],["property","product:title"]],url:[["property","og:url"],["property","product:url"],["property","product:product_link"]],image:[["property","og:image"],["property","product:image"]],id:[["property","product:id"],["property","product:sku"],["property","product:upc"],["property","product:isbn"],["property","product:ean"]],price:[["property","og:price"],["property","product:price"]],
price_amount:[["property","og:price:amount"],["property","product:price:amount"]],price_currency:[["property","og:price:currency"],["property","product:price:currency"]],description:[["property","og:description"],["name","description"]]}),f;for(f in e)a[f]=e[f];window.triggermail._meta_tags=window.triggermail._meta_tags||{};window.triggermail._meta_tags.page=a})();triggermail.config.eventSource="semantic";
(function(){function c(){r===w&&(window.console&&window.console.debug)&&window.console.debug.apply(window.console,arguments)}function a(){r===w&&(window.console&&window.console.warn)&&window.console.warn.apply(window.console,arguments)}function e(){r===w&&(window.console&&window.console.error)&&window.console.error.apply(window.console,arguments)}function f(a){var c=[];for(key in z[a])"_"!==key[0]&&c.push(key);return 0<c.length?a+" event can contain properties: "+c.join(", "):""}function h(a,c,e){var f=
[],n;for(n in c){var m=c[n];if(m.constructor===Array)for(var p=0;p<m.length;p++)if(m[p].constructor===Array)for(var r=m[p][0],s,t=0;t<a[n].length;t++){s=h(a[n][t],r,e+"."+n+"["+t+"]");void 0!==s.cleaned&&(a[n][t]=s.cleaned);for(var q=0;q<s.errors.length;q++)f.push(s.errors[q])}else try{s=m[p](a[n]),void 0!==s&&(a[n]=s)}catch(u){f.push(e+"."+n+": "+u);break}else if(m.constructor===Function)try{m(a)}catch(k){f.push(k)}}return{cleaned:a,errors:f}}function m(d){for(var e,m,p,r=0;r<d.length;r++)try{var s=
d[r],t=s[0],v=s[1];try{if(!t)throw"missing event";if(!v)throw"missing params";switch(t){case n.VIEW_PRODUCT:case n.ADD_TO_CART:case n.REMOVE_FROM_CART:v=v||window.bluecore.product;break;case n.PURCHASE:case n.SEARCH:case n.VIEW_CATEGORY:case n.CUSTOM:case n.IDENTIFY:case n.VIEW_CONTENT:break;default:throw"unknown event <"+t+">";}var u=h(v,z[t],t+" event -> payload");e=t;m=u.cleaned;p=u.errors}catch(w){if(t)throw"Error: "+String(t)+" -> "+w;throw"Error: "+w;}B.push({ev:e,params:m});if(0<p.length){a("Invalid event");
for(var q=0;q<p.length;q++)a(p[q]);a(f(e))}}catch(A){B.push({ev:d[r][0],params:d[r][1]}),a("Invalid event"),a(A),a(f(d[r][0]))}d=B;B=[];for(e=0;e<d.length;e++)switch(m=d[e],c("Sending event: "+m.ev+", data: "+JSON.stringify(m.params)),m.ev){case n.VIEW_PRODUCT:triggermail.view(m.params);break;case n.ADD_TO_CART:triggermail.add_to_cart(m.params);break;case n.REMOVE_FROM_CART:triggermail.remove_from_cart(m.params);break;case n.PURCHASE:triggermail.purchase(m.params);break;case n.VIEW_CATEGORY:p=m.params.category;
'"'!==p[0]&&'"'!==p[p.length-1]&&(m.params.category=p);triggermail.search({search:m.params});break;case n.SEARCH:p=m.params.search_term;'"'!==p[0]&&'"'!==p[p.length-1]&&(m.params.search_term=p);triggermail.search({search:m.params});break;case n.IDENTIFY:a("Note: re-identifies will be ignored.");triggermail.identify(m.params);null!==m.params.opt_in&&(m.params.opt_in?triggermail.optin(m.params):triggermail.unsubscribe(m.params));break;case n.CUSTOM:"undefined"===typeof m.params.event_type?a("All custom events must include an event_type parameter"):
triggermail.custom(m.params.event_type,m.params.event_data);break;case n.VIEW_CONTENT:triggermail.view_content(m.params)}}function t(){var a=Array.prototype.slice.call(window.bluecore||[],0);window.bluecore={load:function(a){p=a},track:function(){m([Array.prototype.slice.call(arguments,0)])},product:window.triggermail._meta_tags.page||{},env:function(){return{namespace:p,env:r}},event_stream:window.triggermail.event_stream};window.debug_inject&&(c("DEBUG INJECT"),window.debug_inject());m(a);"undefined"!==
typeof window.triggermail._meta_tags&&"product"===window.triggermail._meta_tags.page.type&&window.bluecore.track("view_product",window.bluecore.product)}var n={VIEW_PRODUCT:"view_product",ADD_TO_CART:"add_to_cart",REMOVE_FROM_CART:"remove_from_cart",PURCHASE:"purchase",VIEW_CATEGORY:"view_category",SEARCH:"search",IDENTIFY:"identify",CUSTOM:"custom",VIEW_CONTENT:"view_content"},w="dev",r,p,B=[],u=!1,s={Required:function(a){return function(c){if(null===c)throw"missing "+(a||"required value");return c}},
Email:function(a){return function(c){if(null!==c){newVal=c.trim().toLowerCase();if(!newVal.match(/.+@.+\..+/))throw a+' is not valid: "'+newVal+'"';return newVal}}},Price:function(a){return function(a){if(null!==a&&(newVal=triggermail.util.price(a),isNaN(newVal)))throw"<"+newVal+"> is not valid price";return newVal}},NonEmptyString:function(a){return function(c){newVal=""+c;if(!newVal||!newVal.trim())throw a+" is empty";return newVal}},Availability:function(){return function(a){"instock"===a&&(u=
!0);return u}},OutOfStock:function(){return function(){return!u}},NotEmptyArray:function(a){return function(c){if(null===c)throw"missing "+a;if(c.constructor!==Array)throw a+" is not array";if(0>=c.length)throw a+" is empty";return c}},Bool:function(a){return function(c){var e;if(null!==c){if(c.constructor===Boolean)e=c;else if(c.constructor===String){var f=c.trim().toLowerCase();if(NaN===f||"1"===f||"t"===f)e=!0;else if("false"===f||"0"===f||"f"===f)e=!1}else c.constructor===Number&&(1===c?e=!0:
0===c&&(e=!1));if(!0!==e&&!1!==e)throw a+" should be a boolean, but got <"+c+"> of type <"+typeof c+">";}return e}}},D={id:[s.Required("product id"),s.NonEmptyString("product id")],name:[s.Required("name"),s.NonEmptyString("name")],url:[s.Required("url"),s.NonEmptyString("url")],image:[s.Required("image"),s.NonEmptyString("image")],price:[s.Required("price"),s.Price("price")],price_currency:[],sale_price:[s.Price("sale_price")],sale_price_currency:[],original_price:[s.Price("original_price")],original_price_currency:[],
category:[],brand:[],description:[],availability:[s.Availability()],out_of_stock:[s.OutOfStock()],__customValidation:function(a){if(a.sale_price&&null===a.original_price)throw'since you\'ve defined "sale_price", you must also define the "original_price"';}},A={id:[s.Required("product id")]},z={};z[n.VIEW_PRODUCT]=D;z[n.ADD_TO_CART]=A;z[n.REMOVE_FROM_CART]=A;z[n.VIEWCONTENT]=A;z[n.PURCHASE]={email:[s.Required("customer email"),s.Email("customer email")],total:[s.Required("total price of the purchase"),
s.Price("total price of the purchase")],products:[s.NotEmptyArray("products array"),[A]],order_id:[]};z[n.VIEW_CATEGORY]={category:[s.Required("category"),s.NonEmptyString("category")]};z[n.SEARCH]={search_term:[s.Required("search_term"),s.NonEmptyString("search_term")]};z[n.IDENTIFY]={email:[s.Required("email"),s.Email("email")],name:[],source:[],opt_in:[s.Bool("opt_in")]};z[n.CUSTOM]={event_type:[s.Required("event_type")],event_data:[]};(function(){function a(){0<_maxCheck&&(_maxCheck-=1,window.triggermail&&
window.triggermail.__tm_initialized?t():setTimeout(a,100))}if(!window.bluecore)throw'object "window.bluecore" not found. Did you forget to include the snippet?';r=window.bluecore.env;p=window.bluecore.namespace;p.trim()?(c("  ____  _                               "),c(" |  _ \\| |                              "),c(" | |_) | |_   _  ___  ___ ___  _ __ ___ "),c(" |  _ <| | | | |/ _ \\/ __/ _ \\| '__/ _ \\"),c(" | |_) | | |_| |  __/ (_| (_) | | |  __/"),c(" |____/|_|\\__,_|\\___|\\___\\___/|_|  \\___|"),
c("                                        "),c("Bluecore Integration env=dev namespace="+p),c("View docs at http://bluecore.com/docs/bluecore_semantic_integration"),c("Open bluecore.event_stream() to view your events"),window.triggermail=window.triggermail||{},window.triggermail.Partner={init:function(){},env:function(){return"prod"===r?"p":"d"},keys:{lytics:{d:p,p:p}}},_maxCheck=200,a()):e("Bluecore Integration is missing <namespace>")})()})();
var syncUserAudiences=function(){var c=function(){var a=new XMLHttpRequest,c;c="//bluecore.com/api/audiences/get_audience_info?namespace="+encodeURIComponent(triggermail.integ.keys.lytics);c+="&customer_alias="+encodeURIComponent(triggermail.lytics.get_distinct_id());c+="&_"+(new Date).getTime();a.open("GET",c);a.onreadystatechange=function(a){a=a.target;if(a.readyState===XMLHttpRequest.DONE){var c=[],e=!!a.responseText,f={};try{f=e?JSON.parse(a.responseText):{}}catch(w){}e&&triggermail.lytics._.each(f,
function(a,e){c.push(e);triggermail.util.cookie.get(e)||triggermail.util.cookie.set(e,"true",void 0,triggermail.lytics.cookie.get_cross_subdomain())});a=(a=triggermail.util.cookie.get("__bc_audience_sync"))?JSON.parse(a):{};triggermail.lytics._.each(a.audiences||[],function(a){-1===c.indexOf(a)&&triggermail.util.cookie.get(a)&&triggermail.util.cookie.remove(a,triggermail.lytics.cookie.get_cross_subdomain())});a={lastSyncTime:+new Date,audiences:c};triggermail.util.cookie.set("__bc_audience_sync",
JSON.stringify(a),void 0,triggermail.lytics.cookie.get_cross_subdomain())}};a.send()},a=triggermail.util.cookie.get("__bc_audience_sync"),a=a?JSON.parse(a):{};36E5<+new Date-+(a.lastSyncTime||0)&&c()};
triggermail.initialize=function(){triggermail.integ.keys={};var c=triggermail.Partner.env();triggermail.integ.keys.lytics=triggermail.Partner.keys.lytics[c];triggermail.integ.debug=!1;triggermail.integ.initServices();triggermail.init();-1<["124_rivington","reebok","lucy","design_within_reach"].indexOf(triggermail.integ.keys.lytics)&&syncUserAudiences();c=triggermail.util.getUrlParam("__distinct_id_override__");""!=c&&(triggermail.lytics.cookie.props.distinct_id=c,triggermail.lytics.cookie.save());
c=triggermail.util.getUrlParam("eton_distinct_id");""!=c&&(triggermail.lytics.cookie.props.distinct_id=c,triggermail.lytics.cookie.save());var c=triggermail.util.getUrlParam("mc_eid"),a=triggermail.lytics.cookie.props.distinct_id;c&&a!==c&&(c="mceid_"+c,a!==c&&(triggermail.merge({merge:{source:a,destination:c},customer:{distinct_id:c}}),triggermail.lytics.cookie.props.distinct_id=c,triggermail.lytics.cookie.save(),triggermail.lytics.register({mc_eid:c})));triggermail.integ.init();c=triggermail.util.getUrlParam("__auto_demo__");
""!=c&&(triggermail.demo(),triggermail.identify({email:c}));try{var e=JSON.parse(triggermail.util.cookie.get(triggermail.lytics.cookie.name));(-1<window.location.pathname.indexOf("/eton/")||"undefined"==typeof e.email)&&triggermail.eton.init()}catch(f){}};triggermail.__tm_initialized||(triggermail.initialize(),triggermail.__tm_initialized=!0);var host_path="storage.googleapis.com/bluecore_addons/",partner=triggermail.lytics.config?triggermail.lytics.config.token:null;
if(partner){var script=document.createElement("script");script.type="text/javascript";script.setAttribute("data-cfasync","false");script.src=("https:"===document.location.protocol?"https://":"http://")+host_path+partner+".ju.js";var firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode.insertBefore(script,firstScript)};
